(function () {
    window.MP_Tools = function () {
        if (document.getElementById('mp-tools-panel')) {
            document.getElementById('mp-tools-panel').remove();
            return;
        }
        createPanel();
    };
    function createPanel() {
        const p = document.createElement('div');
        p.id = 'mp-tools-panel';
        p.style.cssText = `
            position:fixed;right:12px;top:12px;width:420px;z-index:2147483647;
            background:#0f1724;color:#e6eef8;padding:12px;border-radius:10px;
            box-shadow:0 8px 32px rgba(2,6,23,.7);font-family:Arial,Helvetica,sans-serif;
            font-size:13px;box-sizing:border-box;user-select:none;
        `;
        const h = document.createElement('div');
        h.style.cssText = `
            font-weight:700;margin-bottom:8px;display:flex;
            justify-content:space-between;align-items:center;cursor:grab;
        `;
        h.textContent = 'MP Tools';
        const x = document.createElement('button');
        x.textContent = 'X';
        x.title = 'Close';
        x.style.cssText = `
            background:transparent;border:0;color:inherit;
            cursor:pointer;font-size:14px;padding:4px 8px;
        `;
        x.onclick = () => p.remove();
        h.appendChild(x);
        p.appendChild(h);
        const i = document.createElement('div');
        i.textContent = 'Choose a tool:';
        i.style.marginBottom = '8px';
        p.appendChild(i);
        const cols = document.createElement('div');
        cols.style.cssText = 'display:flex;gap:10px;';
        const c1 = column();
        const c2 = column();
        const startBtn = btn('Start Speedrunner', '#16a34a', '#fff');
        const stopBtn = btn('Stop Speedrunner', '#ef4444', '#fff');
        stopBtn.style.marginBottom = '12px';
        c1.appendChild(startBtn);
        c1.appendChild(stopBtn);
        const enableBtn = btn('Enable Right Click', '#16a34a', '#fff');
        const disableBtn = btn('Disable Right Click', '#ef4444', '#fff');
        c2.appendChild(enableBtn);
        c2.appendChild(disableBtn);
        const calcBtn = btn('Open Calculator', '#0ea5a4', '#fff');
        c1.appendChild(calcBtn);
        // NEW: Open AI button (same color/style as calculator)
        const openAiBtn = btn('Open AI', '#0ea5a4', '#fff');
        c1.appendChild(openAiBtn);
        cols.appendChild(c1);
        cols.appendChild(c2);
        p.appendChild(cols);
        document.body.appendChild(p);
        speedrunner(startBtn, stopBtn);
        rightClick(enableBtn, disableBtn);
        draggable(p, h);
        calcBtn.onclick = () => openCalculator();
        openAiBtn.onclick = () => openOpenAI(); // hook up new button
    }
    function column() {
        const d = document.createElement('div');
        d.style.cssText = 'flex:1;display:flex;flex-direction:column;gap:8px;';
        return d;
    }
    function btn(text, bg, fg) {
        const b = document.createElement('button');
        b.textContent = text;
        b.style.cssText = `
            width:100%;padding:10px;border-radius:8px;border:0;
            cursor:pointer;box-sizing:border-box;font-weight:700;
            font-size:12px;background:${bg};color:${fg};
        `;
        return b;
    }
    function speedrunner(start, stop) {
        start.onclick = async function () {
            if (window.__autoClickerRunning) return console.log('Speedrunner already running');
            window.__autoClickerStopRequested = false;
            window.__autoClickerRunning = true;
            const wait = (sel, txt, to = 10000) => new Promise((res, rej) => {
                const s = Date.now();
                const iv = setInterval(() => {
                    const els = [...document.querySelectorAll(sel)];
                    for (const el of els) if (el.textContent.trim() === txt) { clearInterval(iv); res(el); return; }
                    if (Date.now() - s > to) { clearInterval(iv); rej(new Error('Timeout: ' + txt)); }
                }, 200);
            });
            const sleep = ms => new Promise(r => setTimeout(r, ms));
            try {
                while (!window.__autoClickerStopRequested) {
                    try {
                        (await wait('div.bottom-button.card-button.check-button.flex.items-center.relative.right-button.round-button',
                                    'Check my answer')).click();
                        (await wait('div.next-button.ph3.pv2.card-button.round-button.bottom-button.left-button.flex.items-center.mr2',
                                    'Complete question')).click();
                        await sleep(3000);
                    } catch { await sleep(1000); }
                }
            } finally {
                window.__autoClickerRunning = false;
                console.log('Speedrunner stopped');
            }
        };
        stop.onclick = () => {
            window.__autoClickerStopRequested = true;
            window.__autoClickerRunning = false;
            console.log('Stop requested');
        };
    }
    function rightClick(enable, disable) {
        enable.onclick = function () {
            if (window.__allowRClickInterval) return console.log('Already running');
            const handler = e => { try { e.stopImmediatePropagation(); } catch (_) {} };
            const purge = () => {
                document.oncontextmenu = document.onmousedown = document.onmouseup = null;
                document.querySelectorAll('*').forEach(el => {
                    el.oncontextmenu = el.onmousedown = el.onmouseup = null;
                });
                ['contextmenu','mousedown','mouseup'].forEach(ev => {
                    window.addEventListener(ev, handler, true);
                    document.addEventListener(ev, handler, true);
                });
                window.__allowRClick_installed = true;
                window.__allowRClick_handler = handler;
            };
            window.__allowRClickInterval = setInterval(purge, 50);
            console.log('Right-click unblocker ON');
        };
        disable.onclick = function () {
            if (window.__allowRClickInterval) clearInterval(window.__allowRClickInterval);
            if (window.__allowRClick_installed && window.__allowRClick_handler) {
                ['contextmenu','mousedown','mouseup'].forEach(ev => {
                    try { window.removeEventListener(ev, window.__allowRClick_handler, true); } catch (_) {}
                    try { document.removeEventListener(ev, window.__allowRClick_handler, true); } catch (_) {}
                });
            }
            window.__allowRClick_installed = false;
            window.__allowRClick_handler = null;
            window.__allowRClickInterval = null;
            console.log('Right-click unblocker OFF');
        };
    }
    function openCalculator() {
        const existingPanel = document.getElementById('mp-desmos-panel');
        if (existingPanel) {
            existingPanel.style.display = existingPanel.style.display === 'none' ? '' : existingPanel.style.display;
            existingPanel.style.zIndex = 2147483648;
            return;
        }
        const panel = document.createElement('div');
        panel.id = 'mp-desmos-panel';
        panel.style.cssText = `
            position:fixed;left:12px;top:12px;width:420px;height:500px;z-index:2147483648;
            background:#fff;color:#111;border-radius:8px;border:1px solid #bbb;
            box-shadow:0 8px 30px rgba(0,0,0,.4);font-family:Arial,Helvetica,sans-serif;
            box-sizing:border-box;user-select:none;padding:0;overflow:hidden;
        `;
        const header = document.createElement('div');
        header.style.cssText = `
            display:flex;align-items:center;justify-content:space-between;
            background:#2b2f33;color:#fff;padding:8px 10px;cursor:grab;
            font-weight:700;font-size:13px;
        `;
        header.innerHTML = `<span style="pointer-events:none;">Calculator</span>`;
        const headerBtns = document.createElement('div');
        headerBtns.style.cssText = 'display:flex;gap:6px;align-items:center;';
        const closeBtn = document.createElement('button');
        closeBtn.title = 'Close';
        closeBtn.textContent = '✕';
        closeBtn.style.cssText = `
            background:transparent;border:0;color:inherit;cursor:pointer;padding:2px 6px;
            font-size:14px;
        `;
        headerBtns.appendChild(closeBtn);
        header.appendChild(headerBtns);
        panel.appendChild(header);
        const body = document.createElement('div');
        body.id = 'mp-desmos-body';
        body.style.cssText = `
            width:100%;height:calc(100% - 42px);padding:8px;box-sizing:border-box;
            background:transparent;
        `;
        const desmosContainer = document.createElement('div');
        desmosContainer.id = 'scientificCalc';
        desmosContainer.style.cssText = 'width:100%;height:100%;border-radius:6px;overflow:hidden;';
        body.appendChild(desmosContainer);
        panel.appendChild(body);
        document.body.appendChild(panel);
        if (typeof draggable === 'function') {
            draggable(panel, header);
        } else {
            (function simpleDrag() {
                let dragging = false, ox = 0, oy = 0;
                const move = e => {
                    const x = (e.clientX !== undefined) ? e.clientX : (e.touches && e.touches[0] && e.touches[0].clientX);
                    const y = (e.clientY !== undefined) ? e.clientY : (e.touches && e.touches[0] && e.touches[0].clientY);
                    if (!dragging || x == null) return;
                    panel.style.left = (x - ox) + 'px';
                    panel.style.top = (y - oy) + 'px';
                    panel.style.right = '';
                };
                const up = () => {
                    dragging = false;
                    document.removeEventListener('mousemove', move);
                    document.removeEventListener('mouseup', up);
                    document.removeEventListener('touchmove', move);
                    document.removeEventListener('touchend', up);
                    header.style.cursor = 'grab';
                };
                header.addEventListener('mousedown', e => {
                    dragging = true;
                    const r = panel.getBoundingClientRect();
                    ox = e.clientX - r.left;
                    oy = e.clientY - r.top;
                    document.addEventListener('mousemove', move);
                    document.addEventListener('mouseup', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
                header.addEventListener('touchstart', e => {
                    dragging = true;
                    const t = e.touches[0];
                    const r = panel.getBoundingClientRect();
                    ox = t.clientX - r.left;
                    oy = t.clientY - r.top;
                    document.addEventListener('touchmove', move);
                    document.addEventListener('touchend', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
            })();
        }
        closeBtn.onclick = () => {
            try {
                if (window.__mp_desmos_instance && typeof window.__mp_desmos_instance.destroy === 'function') {
                    window.__mp_desmos_instance.destroy();
                }
            } catch (err) {}
            window.__mp_desmos_instance = null;
            panel.remove();
        };
        function ensureDesmos() {
            if (window.Desmos) return Promise.resolve();
            if (window.__mp_desmos_loading_promise) return window.__mp_desmos_loading_promise;
            window.__mp_desmos_loading_promise = new Promise((resolve, reject) => {
                const s = document.createElement('script');
                s.src = 'https://www.desmos.com/api/v1.11/calculator.js?apiKey=78043328c170484d8c2b47e1013a0d12';
                s.async = true;
                s.onload = () => resolve();
                s.onerror = (e) => reject(new Error('Failed to load Desmos script'));
                document.head.appendChild(s);
            });
            return window.__mp_desmos_loading_promise;
        }
        function initDesmos() {
            try {
                if (!document.getElementById('scientificCalc')) {
                    console.error('Desmos container missing');
                    return;
                }
                if (window.__mp_desmos_instance) {
                    try { if (typeof window.__mp_desmos_instance.update === 'function') window.__mp_desmos_instance.update(); } catch(_) {}
                    return;
                }
                window.__mp_desmos_instance = Desmos && Desmos.ScientificCalculator
                    ? Desmos.ScientificCalculator(document.getElementById('scientificCalc'), { keypad: true })
                    : null;
                if (!window.__mp_desmos_instance) console.error('Desmos object not available or API changed');
            } catch (err) {
                console.error('Error initialising Desmos', err);
            }
        }
        ensureDesmos().then(initDesmos).catch(err => {
            console.error('Failed to load Desmos calculator:', err);
            const errNotice = document.createElement('div');
            errNotice.style.cssText = 'padding:10px;color:#900;font-weight:700;';
            errNotice.textContent = 'Desmos failed to load.';
            body.appendChild(errNotice);
        });
        panel.addEventListener('mousedown', () => {
            panel.style.zIndex = 2147483648;
        });
    }
    // NEW: Open AI panel that embeds the given URL in an iframe, same header & size as calculator
    function openOpenAI() {
        const existingPanel = document.getElementById('mp-openai-panel');
        if (existingPanel) {
            existingPanel.style.display = existingPanel.style.display === 'none' ? '' : existingPanel.style.display;
            existingPanel.style.zIndex = 2147483648;
            return;
        }
        const panel = document.createElement('div');
        panel.id = 'mp-openai-panel';
        panel.style.cssText = `
            position:fixed;left:12px;top:12px;width:420px;height:500px;z-index:2147483648;
            background:#fff;color:#111;border-radius:8px;border:1px solid #bbb;
            box-shadow:0 8px 30px rgba(0,0,0,.4);font-family:Arial,Helvetica,sans-serif;
            box-sizing:border-box;user-select:none;padding:0;overflow:hidden;
        `;
        const header = document.createElement('div');
        header.style.cssText = `
            display:flex;align-items:center;justify-content:space-between;
            background:#2b2f33;color:#fff;padding:8px 10px;cursor:grab;
            font-weight:700;font-size:13px;
        `;
        header.innerHTML = `<span style="pointer-events:none;">Open AI</span>`;
        const headerBtns = document.createElement('div');
        headerBtns.style.cssText = 'display:flex;gap:6px;align-items:center;';
        const closeBtn = document.createElement('button');
        closeBtn.title = 'Close';
        closeBtn.textContent = '✕';
        closeBtn.style.cssText = `
            background:transparent;border:0;color:inherit;cursor:pointer;padding:2px 6px;
            font-size:14px;
        `;
        headerBtns.appendChild(closeBtn);
        header.appendChild(headerBtns);
        panel.appendChild(header);
        const body = document.createElement('div');
        body.id = 'mp-openai-body';
        body.style.cssText = `
            width:100%;height:calc(100% - 42px);padding:0;box-sizing:border-box;
            background:transparent;display:flex;flex-direction:column;
        `;
        const contentContainer = document.createElement('div');
        contentContainer.style.cssText = 'width:100%;height:100%;overflow:auto;';

        // Base64 encoded HTML
        const base64HTML = 'PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQoNCjxoZWFkPg0KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4NCiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+DQogICAgPHRpdGxlPkFJIENoYXQ8L3RpdGxlPg0KICAgIDwhLS0gQm9vdHN0cmFwIENTUyAtLT4NCiAgICA8bGluayBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2Jvb3RzdHJhcEA1LjMuMC1hbHBoYTEvZGlzdC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiIHJlbD0ic3R5bGVzaGVldCI+DQogICAgPCEtLSBBT1MgQW5pbWF0aW9uIExpYnJhcnkgLS0+DQogICAgPGxpbmsgaHJlZj0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9hb3NAMi4zLjQvZGlzdC9hb3MuY3NzIiByZWw9InN0eWxlc2hlZXQiPg0KICAgIDwhLS0gRm9udCBBd2Vzb21lIGZvciBJY29ucyAtLT4NCiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2ZvbnQtYXdlc29tZS82LjQuMC9jc3MvYWxsLm1pbi5jc3MiPg0KICAgIDwhLS0gSGlnaGxpZ2h0LmpzIGZvciBDb2RlIFN5bnRheCBIaWdobGlnaHRpbmcgLS0+DQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9oaWdobGlnaHQuanMvMTEuNy4wL3N0eWxlcy9naXRodWIubWluLmNzcyI+DQogICAgPCEtLSBNYXJrZWQgZm9yIE1hcmtkb3duIC0tPg0KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL21hcmtlZEA0LjIuMTIvbWFya2VkLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgPCEtLSBDdXN0b20gQ1NTIC0tPg0KICAgIDxzdHlsZT4NCiAgICAgICAgLyogTWFpbiBDb250ZW50IEFyZWEgKi8NCi5tYWluLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA1NnB4KTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KDQovKiBDaGF0IE1lc3NhZ2VzIEFyZWEgKi8NCi5jaGF0LW1lc3NhZ2VzIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodC1iZyk7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMjBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQp9DQoNCi8qIE1ha2Ugc3VyZSB0aGUgbWFpbiBjb250ZW50IHRha2VzIHVwIHRoZSBmdWxsIGhlaWdodCAqLw0KI21haW5Db250ZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNTZweCk7DQp9DQoNCi8qIENoYXQgbWVzc2FnZXMgY29udGFpbmVyIHNob3VsZCB0YWtlIGFsbCBhdmFpbGFibGUgc3BhY2UgKi8NCi5jaGF0LW1lc3NhZ2VzLWNvbnRhaW5lciB7DQogICAgZmxleDogMTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLyogQ2hhdCBJbnB1dCBBcmVhICovDQouY2hhdC1pbnB1dC1hcmVhIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIHotaW5kZXg6IDEwOw0KfQ0KDQo6cm9vdCB7DQogICAgLS1wcmltYXJ5LWNvbG9yOiAjMjU2M2ViOw0KICAgIC0tc2Vjb25kYXJ5LWNvbG9yOiAjNGI1NTYzOw0KICAgIC0tbGlnaHQtYmc6ICNmOWZhZmI7DQogICAgLS1kYXJrLWJnOiAjMWYyOTM3Ow0KICAgIC0tdXNlci1idWJibGUtYmc6ICNlOWYyZmY7DQogICAgLS1hc3Npc3RhbnQtYnViYmxlLWJnOiAjZjNmNGY2Ow0KICAgIC0tYm9yZGVyLWNvbG9yOiAjZTVlN2ViOw0KICAgIC0tdHJhbnNpdGlvbi1zcGVlZDogMC4zczsNCn0NCg0KYm9keSB7DQogICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBPeHlnZW4sIFVidW50dSwgQ2FudGFyZWxsLCAnT3BlbiBTYW5zJywgJ0hlbHZldGljYSBOZXVlJywgc2Fucy1zZXJpZjsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0LWJnKTsNCn0NCg0KLyogU2lkZWJhciBTdHlsZXMgKi8NCi5zaWRlYmFyIHsNCiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gdmFyKC0tdHJhbnNpdGlvbi1zcGVlZCkgZWFzZTsNCiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA1NnB4KTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHotaW5kZXg6IDEwMDA7DQp9DQoNCi5zaWRlYmFyLmNvbGxhcHNlZCB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0xMDAlKTsNCn0NCg0KLyogTWFpbiBjb250ZW50IHdpdGggc2lkZWJhciBleHBhbmRlZC9jb2xsYXBzZWQgc3RhdGVzICovDQoubWFpbi1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNTZweCk7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICB0cmFuc2l0aW9uOiB3aWR0aCB2YXIoLS10cmFuc2l0aW9uLXNwZWVkKSBlYXNlOw0KfQ0KDQovKiBXaGVuIHNpZGViYXIgaXMgY29sbGFwc2VkLCBleHBhbmQgbWFpbiBjb250ZW50ICovDQoubWFpbi1jb250ZW50LWV4cGFuZGVkIHsNCiAgICBtYXJnaW4tbGVmdDogMDsNCiAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50Ow0KfQ0KDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuc2lkZWJhciB7DQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgd2lkdGg6IDI1MHB4Ow0KICAgICAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA1NnB4KTsNCiAgICB9DQoNCiAgICAubWFpbi1jb250ZW50IHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgfQ0KfQ0KDQovKiBDaGF0IEhpc3RvcnkgSXRlbXMgKi8NCi5jaGF0LWhpc3RvcnktaXRlbSB7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTsNCiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQp9DQoNCi5jaGF0LWhpc3RvcnktaXRlbTpob3ZlciB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCn0NCg0KLmNoYXQtaGlzdG9yeS1pdGVtLmFjdGl2ZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzNywgOTksIDIzNSwgMC4xKTsNCiAgICBib3JkZXItbGVmdDogM3B4IHNvbGlkIHZhcigtLXByaW1hcnktY29sb3IpOw0KfQ0KDQovKiBDaGF0IE1lc3NhZ2VzIEFyZWEgKi8NCi5jaGF0LW1lc3NhZ2VzIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodC1iZyk7DQogICAgc2Nyb2xsLWJlaGF2aW9yOiBzbW9vdGg7DQp9DQoNCi8qIENoYXQgQnViYmxlcyAqLw0KLmNoYXQtYnViYmxlIHsNCiAgICBtYXgtd2lkdGg6IDg1JTsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgb3BhY2l0eTogMDsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMjBweCk7DQogICAgYW5pbWF0aW9uOiBidWJibGVBcHBlYXIgMC4zcyBmb3J3YXJkczsNCn0NCg0KQGtleWZyYW1lcyBidWJibGVBcHBlYXIgew0KICAgIHRvIHsNCiAgICAgICAgb3BhY2l0eTogMTsNCiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOw0KICAgIH0NCn0NCg0KLnVzZXItYnViYmxlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS11c2VyLWJ1YmJsZS1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2QxZTNmZjsNCiAgICBtYXJnaW4tbGVmdDogYXV0bzsNCn0NCg0KLmFzc2lzdGFudC1idWJibGUgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWFzc2lzdGFudC1idWJibGUtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkICNlNWU3ZWI7DQogICAgbWFyZ2luLXJpZ2h0OiBhdXRvOw0KfQ0KDQouYnViYmxlLWFjdGlvbnMgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB0b3A6IDEwcHg7DQogICAgcmlnaHQ6IDE1cHg7DQogICAgb3BhY2l0eTogMDsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZTsNCn0NCg0KLmNoYXQtYnViYmxlOmhvdmVyIC5idWJibGUtYWN0aW9ucyB7DQogICAgb3BhY2l0eTogMTsNCn0NCg0KLmJ1YmJsZS1tZXRhZGF0YSB7DQogICAgZm9udC1zaXplOiAwLjc1cmVtOw0KICAgIGNvbG9yOiB2YXIoLS1zZWNvbmRhcnktY29sb3IpOw0KICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICB0ZXh0LWFsaWduOiByaWdodDsNCn0NCg0KLyogV2FpdGluZyBBbmltYXRpb24gKi8NCi53YWl0aW5nLWluZGljYXRvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYXNzaXN0YW50LWJ1YmJsZS1iZyk7DQogICAgYm9yZGVyLXJhZGl1czogMTVweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZTVlN2ViOw0KICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQogICAgbWF4LXdpZHRoOiA4NSU7DQp9DQoNCi50eXBpbmctaW5kaWNhdG9yIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi50eXBpbmctZG90IHsNCiAgICB3aWR0aDogOHB4Ow0KICAgIGhlaWdodDogOHB4Ow0KICAgIG1hcmdpbjogMCAycHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIGFuaW1hdGlvbjogdHlwaW5nRG90IDEuNHMgaW5maW5pdGUgZWFzZS1pbi1vdXQgYm90aDsNCn0NCg0KLnR5cGluZy1kb3Q6bnRoLWNoaWxkKDEpIHsNCiAgICBhbmltYXRpb24tZGVsYXk6IDBzOw0KfQ0KDQoudHlwaW5nLWRvdDpudGgtY2hpbGQoMikgew0KICAgIGFuaW1hdGlvbi1kZWxheTogMC4yczsNCn0NCg0KLnR5cGluZy1kb3Q6bnRoLWNoaWxkKDMpIHsNCiAgICBhbmltYXRpb24tZGVsYXk6IDAuNHM7DQp9DQoNCkBrZXlmcmFtZXMgdHlwaW5nRG90IHsNCg0KICAgIDAlLA0KICAgIDgwJSwNCiAgICAxMDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwLjUpOw0KICAgICAgICBvcGFjaXR5OiAwLjU7DQogICAgfQ0KDQogICAgNDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsNCiAgICAgICAgb3BhY2l0eTogMTsNCiAgICB9DQp9DQoNCi8qIFJpY2ggVGV4dCBFZGl0b3IgKi8NCi5wcm9tcHRFZGl0b3Igew0KICAgIG1pbi1oZWlnaHQ6IDUwcHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIC8qIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbnMgKi8NCiAgICAtd2Via2l0LW92ZXJmbG93LXNjcm9sbGluZzogdG91Y2g7DQogICAgLyogRm9yIHNtb290aGVyIHNjcm9sbGluZyBvbiBpT1MgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLyogUmVkdWNlcyBwYWludCBkdXJpbmcgc2Nyb2xsaW5nICovDQogICAgcGVyc3BlY3RpdmU6IDEwMDBweDsNCiAgICAvKiBIZWxwcyB3aXRoIDNEIGFjY2VsZXJhdGlvbiAqLw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoMCwgMCwgMCk7DQogICAgLyogRm9yY2UgR1BVIGFjY2VsZXJhdGlvbiAqLw0KfQ0KDQoucHJvbXB0RWRpdG9yOmVtcHR5OmJlZm9yZSB7DQogICAgY29udGVudDogYXR0cihwbGFjZWhvbGRlcik7DQogICAgY29sb3I6ICNhYWE7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQp9DQoNCi5wcm9tcHRFZGl0b3IgcHJlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjFmM2Y1Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgZm9udC1mYW1pbHk6ICdDb3VyaWVyIE5ldycsIENvdXJpZXIsIG1vbm9zcGFjZTsNCiAgICBtYXJnaW46IDhweCAwOw0KfQ0KDQoucHJvbXB0RWRpdG9yIGNvZGUgew0KICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YxZjNmNTsNCiAgICBwYWRkaW5nOiAycHggNHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCn0NCg0KLyogT3B0aW1pemUgc2Nyb2xsYmFyIGFwcGVhcmFuY2UgZm9yIGJldHRlciBwZXJmb3JtYW5jZSAqLw0KLnByb21wdEVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXIgew0KICAgIHdpZHRoOiA4cHg7DQp9DQoNCi5wcm9tcHRFZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQoucHJvbXB0RWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCn0NCg0KLyogRmlsZSBBdHRhY2htZW50cyAqLw0KLmZpbGUtYXR0YWNobWVudHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC13cmFwOiB3cmFwOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQouZmlsZS1hdHRhY2htZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjRmNjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZDFkNWRiOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGZvbnQtc2l6ZTogMC44NXJlbTsNCn0NCg0KLmZpbGUtYXR0YWNobWVudCAuZmlsZS1uYW1lIHsNCiAgICBtYXJnaW46IDAgOHB4Ow0KICAgIG1heC13aWR0aDogMTUwcHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsNCiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KfQ0KDQouZmlsZS1hdHRhY2htZW50IC5yZW1vdmUtZmlsZSB7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGNvbG9yOiAjZWY0NDQ0Ow0KfQ0KDQovKiBNYXJrZG93biBDb250ZW50IFN0eWxpbmcgKi8NCi5tYXJrZG93bi1jb250ZW50IHsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KfQ0KDQoubWFya2Rvd24tY29udGVudCBoMSwNCi5tYXJrZG93bi1jb250ZW50IGgyLA0KLm1hcmtkb3duLWNvbnRlbnQgaDMsDQoubWFya2Rvd24tY29udGVudCBoNCwNCi5tYXJrZG93bi1jb250ZW50IGg1LA0KLm1hcmtkb3duLWNvbnRlbnQgaDYgew0KICAgIG1hcmdpbi10b3A6IDFlbTsNCiAgICBtYXJnaW4tYm90dG9tOiAwLjVlbTsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgcCB7DQogICAgbWFyZ2luLWJvdHRvbTogMWVtOw0KfQ0KDQoubWFya2Rvd24tY29udGVudCB1bCwNCi5tYXJrZG93bi1jb250ZW50IG9sIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxZW07DQogICAgcGFkZGluZy1sZWZ0OiAyZW07DQp9DQoNCi5tYXJrZG93bi1jb250ZW50IGNvZGUgew0KICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQogICAgcGFkZGluZzogMnB4IDRweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YxZjNmNTsNCiAgICBmb250LXNpemU6IDAuOWVtOw0KfQ0KDQoubWFya2Rvd24tY29udGVudCBwcmUgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmMWYzZjU7DQogICAgcGFkZGluZzogMWVtOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBvdmVyZmxvdy14OiBhdXRvOw0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgcHJlIGNvZGUgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50Ow0KICAgIHBhZGRpbmc6IDA7DQogICAgYm9yZGVyLXJhZGl1czogMDsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgYmxvY2txdW90ZSB7DQogICAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCAjZTVlN2ViOw0KICAgIHBhZGRpbmctbGVmdDogMWVtOw0KICAgIG1hcmdpbi1sZWZ0OiAwOw0KICAgIGNvbG9yOiAjNGI1NTYzOw0KfQ0KDQoubWFya2Rvd24tY29udGVudCBpbWcgew0KICAgIG1heC13aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IGF1dG87DQp9DQoNCi5tYXJrZG93bi1jb250ZW50IHRhYmxlIHsNCiAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOw0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgdGFibGUgdGgsDQoubWFya2Rvd24tY29udGVudCB0YWJsZSB0ZCB7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2QxZDVkYjsNCiAgICBwYWRkaW5nOiA4cHg7DQp9DQoNCi5tYXJrZG93bi1jb250ZW50IHRhYmxlIHRoIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjlmYWZiOw0KfQ0KDQovKiBFcnJvciBNZXNzYWdlICovDQouZXJyb3ItbWVzc2FnZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZlZTJlMjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWY0NDQ0Ow0KICAgIGNvbG9yOiAjYjkxYzFjOw0KICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgIG1heC13aWR0aDogODUlOw0KfQ0KDQovKiBFZGl0IE1vZGUgKi8NCi5lZGl0LW1vZGUgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmZiZWI7DQogICAgYm9yZGVyOiAxcHggZGFzaGVkICNkOTc3MDY7DQp9DQoNCi5lZGl0LWFjdGlvbnMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIGdhcDogOHB4Ow0KfQ0KDQovKiBDb3B5IEFuaW1hdGlvbiAqLw0KQGtleWZyYW1lcyBjb3B5RmVlZGJhY2sgew0KICAgIDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsNCiAgICB9DQoNCiAgICA1MCUgew0KICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMik7DQogICAgfQ0KDQogICAgMTAwJSB7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7DQogICAgfQ0KfQ0KDQouY29weS1mZWVkYmFjayB7DQogICAgYW5pbWF0aW9uOiBjb3B5RmVlZGJhY2sgMC4zcyBlYXNlOw0KfQ0KDQovKiBNYWluIENvbnRlbnQgQXJlYSB3aGVuIFNpZGViYXIgaXMgQ29sbGFwc2VkICovDQoubWFpbi1jb250ZW50LWV4cGFuZGVkIHsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLyogVG9rZW4gQ291bnRlciAqLw0KI3Rva2VuQ291bnRlciB7DQogICAgZm9udC1zaXplOiAwLjhyZW07DQogICAgY29sb3I6IHZhcigtLXNlY29uZGFyeS1jb2xvcik7DQp9DQoNCi8qIFJlc3BvbnNlIHN0cmVhbWluZyBlZmZlY3QgKi8NCi5zdHJlYW1pbmctY2hhciB7DQogICAgb3BhY2l0eTogMDsNCiAgICBhbmltYXRpb246IGZhZGVJbiAwLjFzIGZvcndhcmRzOw0KfQ0KDQpAa2V5ZnJhbWVzIGZhZGVJbiB7DQogICAgdG8gew0KICAgICAgICBvcGFjaXR5OiAxOw0KICAgIH0NCn0NCg0KLyogU3lzdGVtIG1lc3NhZ2UgKi8NCi5zeXN0ZW0tbWVzc2FnZSB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgbWFyZ2luOiAxMHB4IDA7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YwZjlmZjsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2JhZTZmZDsNCiAgICBjb2xvcjogIzAzNjlhMTsNCiAgICBmb250LXNpemU6IDAuOXJlbTsNCn0NCg0KLyogTW9kYWwgY3VzdG9taXphdGlvbnMgKi8NCi5tb2RhbC1oZWFkZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0NCg0KLyogVG9vbHRpcCBjdXN0b21pemF0aW9ucyAqLw0KLnRvb2x0aXAgew0KICAgIGZvbnQtc2l6ZTogMC44cmVtOw0KfQ0KDQovKiBEaXNhYmxlIHRleHQgc2VsZWN0aW9uIGluIGNlcnRhaW4gZWxlbWVudHMgKi8NCi5idWJibGUtYWN0aW9ucyBidXR0b24sDQouZmlsZS1hdHRhY2htZW50IC5yZW1vdmUtZmlsZSB7DQogICAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQoNCi8qIE1vYmlsZSByZXNwb25zaXZlbmVzcyAqLw0KQG1lZGlhIChtYXgtd2lkdGg6IDU3NnB4KSB7DQogICAgLmNoYXQtYnViYmxlIHsNCiAgICAgICAgbWF4LXdpZHRoOiA5NSU7DQogICAgfQ0KDQogICAgLmJ1YmJsZS1hY3Rpb25zIHsNCiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICB0b3A6IGF1dG87DQogICAgICAgIHJpZ2h0OiBhdXRvOw0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOw0KICAgICAgICBtYXJnaW4tdG9wOiA4cHg7DQogICAgICAgIG9wYWNpdHk6IDE7DQogICAgfQ0KDQogICAgLmhlYWRlciBoMSB7DQogICAgICAgIGZvbnQtc2l6ZTogMS4ycmVtOw0KICAgIH0NCg0KICAgIC5idG4tZ3JvdXAgLmJ0biB7DQogICAgICAgIHBhZGRpbmc6IDAuMjVyZW0gMC41cmVtOw0KICAgIH0NCg0KICAgIC5kcm9wZG93bi1tZW51IHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgfQ0KfQ0KDQouZmlsZS1sb2FkaW5nLWluZGljYXRvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjRmNjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZDFkNWRiOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KfQ0KDQovKiBFcnJvciBNZXNzYWdlIHdpdGggUmV0cnkgQnV0dG9uICovDQouZXJyb3ItbWVzc2FnZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZlZTJlMjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWY0NDQ0Ow0KICAgIGNvbG9yOiAjYjkxYzFjOw0KICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgIG1heC13aWR0aDogODUlOw0KfQ0KDQouZXJyb3ItbWVzc2FnZSAucmV0cnktYnRuIHsNCiAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgcGFkZGluZzogMC4yNXJlbSAwLjVyZW07DQp9DQoNCi5lcnJvci1tZXNzYWdlIC5yZXRyeS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNkYzI2MjY7DQogICAgYm9yZGVyLWNvbG9yOiAjYjkxYzFjOw0KfQ0KICAgIDwvc3R5bGU+DQo8L2hlYWQ+DQoNCjxib2R5Pg0KICAgIDwhLS0gQVBJIEtleSBNb2RhbCAtLT4NCiAgICA8ZGl2IGNsYXNzPSJtb2RhbCBmYWRlIiBpZD0iYXBpS2V5TW9kYWwiIGRhdGEtYnMtYmFja2Ryb3A9InN0YXRpYyIgZGF0YS1icy1rZXlib2FyZD0iZmFsc2UiIHRhYmluZGV4PSItMSINCiAgICAgICAgYXJpYS1sYWJlbGxlZGJ5PSJhcGlLZXlNb2RhbExhYmVsIiBhcmlhLWhpZGRlbj0idHJ1ZSI+DQogICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWRpYWxvZyBtb2RhbC1kaWFsb2ctY2VudGVyZWQiPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtaGVhZGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGg1IGNsYXNzPSJtb2RhbC10aXRsZSIgaWQ9ImFwaUtleU1vZGFsTGFiZWwiPkVudGVyIFlvdXIgQVBJIEtleTwvaDU+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtYm9keSI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iYXBpS2V5SW5wdXQiIGNsYXNzPSJmb3JtLWxhYmVsIj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InBhc3N3b3JkIiBjbGFzcz0iZm9ybS1jb250cm9sIiBpZD0iYXBpS2V5SW5wdXQiIHBsYWNlaG9sZGVyPSJFbnRlciB5b3VyIEFQSSBrZXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS10ZXh0IHRleHQtd2FybmluZyBtdC0yIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIj48L2k+IFdhcm5pbmc6IFlvdXIgQVBJIGtleSB3aWxsIGJlIHN0b3JlZCBpbiBzZXNzaW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZSBmb3IgdGhpcyBzZXNzaW9uIG9ubHkuDQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtZm9vdGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIGlkPSJhcGlLZXlTdWJtaXQiPlN1Ym1pdDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KDQogICAgPCEtLSBMZWF2ZSBQYWdlIFdhcm5pbmcgTW9kYWwgLS0+DQogICAgPGRpdiBjbGFzcz0ibW9kYWwgZmFkZSIgaWQ9ImxlYXZlUGFnZU1vZGFsIiB0YWJpbmRleD0iLTEiIGFyaWEtbGFiZWxsZWRieT0ibGVhdmVQYWdlTW9kYWxMYWJlbCIgYXJpYS1oaWRkZW49InRydWUiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1kaWFsb2cgbW9kYWwtZGlhbG9nLWNlbnRlcmVkIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWhlYWRlciI+DQogICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzcz0ibW9kYWwtdGl0bGUiIGlkPSJsZWF2ZVBhZ2VNb2RhbExhYmVsIj5XYXJuaW5nPC9oNT4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4tY2xvc2UiIGRhdGEtYnMtZGlzbWlzcz0ibW9kYWwiIGFyaWEtbGFiZWw9IkNsb3NlIj48L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1ib2R5Ij4NCiAgICAgICAgICAgICAgICAgICAgPHA+QXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGxlYXZlPyBZb3UgbWF5IGxvc2UgeW91ciBjaGF0IGhpc3RvcnkgdW5sZXNzIHlvdSBleHBvcnQgaXQgZmlyc3QuPC9wPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWZvb3RlciI+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiIGRhdGEtYnMtZGlzbWlzcz0ibW9kYWwiPlN0YXk8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLWRhbmdlciIgaWQ9ImNvbmZpcm1MZWF2ZVBhZ2UiPkxlYXZlPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQoNCiAgICA8IS0tIE1vZGVsIFNldHRpbmdzIE1vZGFsIC0tPg0KICAgIDxkaXYgY2xhc3M9Im1vZGFsIGZhZGUiIGlkPSJtb2RlbFNldHRpbmdzTW9kYWwiIHRhYmluZGV4PSItMSIgYXJpYS1sYWJlbGxlZGJ5PSJtb2RlbFNldHRpbmdzTW9kYWxMYWJlbCINCiAgICAgICAgYXJpYS1oaWRkZW49InRydWUiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1kaWFsb2cgbW9kYWwtZGlhbG9nLWNlbnRlcmVkIG1vZGFsLWxnIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWhlYWRlciI+DQogICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzcz0ibW9kYWwtdGl0bGUiIGlkPSJtb2RlbFNldHRpbmdzTW9kYWxMYWJlbCI+TW9kZWwgU2V0dGluZ3M8L2g1Pg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0bi1jbG9zZSIgZGF0YS1icy1kaXNtaXNzPSJtb2RhbCIgYXJpYS1sYWJlbD0iQ2xvc2UiPjwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWJvZHkiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0idGVtcGVyYXR1cmVTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5UZW1wZXJhdHVyZSA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJDb250cm9scyByYW5kb21uZXNzLiBMb3dlciB2YWx1ZXMgbWFrZSBvdXRwdXQgbW9yZSBmb2N1c2VkIGFuZCBkZXRlcm1pbmlzdGljLiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49IjAiIG1heD0iMiIgc3RlcD0iMC4xIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InRlbXBlcmF0dXJlU2xpZGVyIiB2YWx1ZT0iMSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtcy0yIiBpZD0idGVtcGVyYXR1cmVWYWx1ZSI+MS4wPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ0b3BQU2xpZGVyIiBjbGFzcz0iZm9ybS1sYWJlbCI+VG9wIFAgPHNwYW4gY2xhc3M9InRleHQtc2Vjb25kYXJ5Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1icy10b2dnbGU9InRvb2x0aXAiIGRhdGEtYnMtcGxhY2VtZW50PSJ0b3AiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iQ29udHJvbHMgZGl2ZXJzaXR5IHZpYSBudWNsZXVzIHNhbXBsaW5nLiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49IjAiIG1heD0iMSIgc3RlcD0iMC4wMSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJ0b3BQU2xpZGVyIiB2YWx1ZT0iMSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtcy0yIiBpZD0idG9wUFZhbHVlIj4xLjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ0b3BLU2xpZGVyIiBjbGFzcz0iZm9ybS1sYWJlbCI+VG9wIEsgPHNwYW4gY2xhc3M9InRleHQtc2Vjb25kYXJ5Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1icy10b2dnbGU9InRvb2x0aXAiIGRhdGEtYnMtcGxhY2VtZW50PSJ0b3AiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iTGltaXRzIGNob2ljZSB0byBLIHRvcCB0b2tlbnMuIDAgZGlzYWJsZXMgZmlsdGVyaW5nLiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49IjAiIG1heD0iMTAwIiBzdGVwPSIxIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InRvcEtTbGlkZXIiIHZhbHVlPSIwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im1zLTIiIGlkPSJ0b3BLVmFsdWUiPjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9ImZyZXF1ZW5jeVBlbmFsdHlTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5GcmVxdWVuY3kgUGVuYWx0eSA8c3Bhbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9InRleHQtc2Vjb25kYXJ5IiBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJSZWR1Y2VzIHJlcGV0aXRpb24gYmFzZWQgb24gZnJlcXVlbmN5IGluIGlucHV0LiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49Ii0yIiBtYXg9IjIiIHN0ZXA9IjAuMSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJmcmVxdWVuY3lQZW5hbHR5U2xpZGVyIiB2YWx1ZT0iMCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtcy0yIiBpZD0iZnJlcXVlbmN5UGVuYWx0eVZhbHVlIj4wLjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJwcmVzZW5jZVBlbmFsdHlTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5QcmVzZW5jZSBQZW5hbHR5IDxzcGFuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0idGV4dC1zZWNvbmRhcnkiIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9IlJlZHVjZXMgcmVwZXRpdGlvbiBvZiB0b2tlbnMgcmVnYXJkbGVzcyBvZiBmcmVxdWVuY3kuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgY2xhc3M9ImZvcm0tcmFuZ2UgZmxleC1ncm93LTEiIG1pbj0iLTIiIG1heD0iMiIgc3RlcD0iMC4xIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InByZXNlbmNlUGVuYWx0eVNsaWRlciIgdmFsdWU9IjAiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXMtMiIgaWQ9InByZXNlbmNlUGVuYWx0eVZhbHVlIj4wLjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InJlcGV0aXRpb25QZW5hbHR5U2xpZGVyIiBjbGFzcz0iZm9ybS1sYWJlbCI+UmVwZXRpdGlvbiBQZW5hbHR5IDxzcGFuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0idGV4dC1zZWNvbmRhcnkiIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9IlJlZHVjZXMgcmVwZXRpdGlvbiBiYXNlZCBvbiB0b2tlbiBwcm9iYWJpbGl0eS4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1pbmZvLWNpcmNsZSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBjbGFzcz0iZm9ybS1yYW5nZSBmbGV4LWdyb3ctMSIgbWluPSIwIiBtYXg9IjIiIHN0ZXA9IjAuMSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJyZXBldGl0aW9uUGVuYWx0eVNsaWRlciIgdmFsdWU9IjEiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXMtMiIgaWQ9InJlcGV0aXRpb25QZW5hbHR5VmFsdWUiPjEuMDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9Im1pblBTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5NaW4gUCA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJNaW4gcHJvYmFiaWxpdHkgcmVsYXRpdmUgdG8gbW9zdCBsaWtlbHkgdG9rZW4uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgY2xhc3M9ImZvcm0tcmFuZ2UgZmxleC1ncm93LTEiIG1pbj0iMCIgbWF4PSIxIiBzdGVwPSIwLjAxIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9Im1pblBTbGlkZXIiIHZhbHVlPSIwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im1zLTIiIGlkPSJtaW5QVmFsdWUiPjAuMDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0idG9wQVNsaWRlciIgY2xhc3M9ImZvcm0tbGFiZWwiPlRvcCBBIDxzcGFuIGNsYXNzPSJ0ZXh0LXNlY29uZGFyeSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9IkR5bmFtaWMgVG9wLVAgYmFzZWQgb24gaGlnaGVzdCBwcm9iYWJpbGl0eSB0b2tlbi4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1pbmZvLWNpcmNsZSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBjbGFzcz0iZm9ybS1yYW5nZSBmbGV4LWdyb3ctMSIgbWluPSIwIiBtYXg9IjEiIHN0ZXA9IjAuMDEiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0idG9wQVNsaWRlciIgdmFsdWU9IjAiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXMtMiIgaWQ9InRvcEFWYWx1ZSI+MC4wPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0ic2VlZElucHV0IiBjbGFzcz0iZm9ybS1sYWJlbCI+U2VlZCA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJGb3IgZGV0ZXJtaW5pc3RpYyByZXNwb25zZXMuIFNhbWUgc2VlZCArIHNhbWUgcGFyYW1ldGVycyA9IHNhbWUgb3V0cHV0LiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJudW1iZXIiIGNsYXNzPSJmb3JtLWNvbnRyb2wiIGlkPSJzZWVkSW5wdXQiIHBsYWNlaG9sZGVyPSJPcHRpb25hbCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9Im1heFRva2Vuc0lucHV0IiBjbGFzcz0iZm9ybS1sYWJlbCI+TWF4IFRva2VucyA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJNYXhpbXVtIG51bWJlciBvZiB0b2tlbnMgdG8gZ2VuZXJhdGUuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9Im1heFRva2Vuc0lucHV0IiBwbGFjZWhvbGRlcj0iT3B0aW9uYWwiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbj0iMSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWNoZWNrIGZvcm0tc3dpdGNoIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPSJmb3JtLWNoZWNrLWlucHV0IiB0eXBlPSJjaGVja2JveCIgaWQ9ImxvZ3Byb2JzQ2hlY2tib3giPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tY2hlY2stbGFiZWwiIGZvcj0ibG9ncHJvYnNDaGVja2JveCI+TG9ncHJvYnMgPHNwYW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0idGV4dC1zZWNvbmRhcnkiIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJSZXR1cm4gbG9nIHByb2JhYmlsaXRpZXMgb2Ygb3V0cHV0IHRva2Vucy4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ0b3BMb2dwcm9ic0lucHV0IiBjbGFzcz0iZm9ybS1sYWJlbCI+VG9wIExvZ3Byb2JzIDxzcGFuIGNsYXNzPSJ0ZXh0LXNlY29uZGFyeSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9Ik51bWJlciBvZiBtb3N0IGxpa2VseSB0b2tlbnMgdG8gcmV0dXJuIGF0IGVhY2ggcG9zaXRpb24uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9InRvcExvZ3Byb2JzSW5wdXQiIHBsYWNlaG9sZGVyPSJPcHRpb25hbCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluPSIwIiBtYXg9IjIwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tY2hlY2sgZm9ybS1zd2l0Y2giPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9ImZvcm0tY2hlY2staW5wdXQiIHR5cGU9ImNoZWNrYm94IiBpZD0ic3RyZWFtaW5nQ2hlY2tib3giIGNoZWNrZWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1jaGVjay1sYWJlbCIgZm9yPSJzdHJlYW1pbmdDaGVja2JveCI+U3RyZWFtaW5nIDxzcGFuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9InRleHQtc2Vjb25kYXJ5IiBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iU3RyZWFtIHRoZSByZXNwb25zZSBhcyBpdCdzIGdlbmVyYXRlZC4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im10LTMgYm9yZGVyLXRvcCBwdC0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxoNj5SZWFzb25pbmcgVG9rZW5zPC9oNj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTQgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InJlYXNvbmluZ0VmZm9ydFNlbGVjdCIgY2xhc3M9ImZvcm0tbGFiZWwiPkVmZm9ydDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9ImZvcm0tc2VsZWN0IiBpZD0icmVhc29uaW5nRWZmb3J0U2VsZWN0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+Tm9uZTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibG93Ij5Mb3c8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im1lZGl1bSI+TWVkaXVtPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJoaWdoIj5IaWdoPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC00IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJyZWFzb25pbmdUb2tlbnNJbnB1dCIgY2xhc3M9ImZvcm0tbGFiZWwiPlRva2VuIExpbWl0PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9InJlYXNvbmluZ1Rva2Vuc0lucHV0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9ImUuZy4gMjAwMCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTQgbWItMyBkLWZsZXggYWxpZ24taXRlbXMtZW5kIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1jaGVjayI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9ImZvcm0tY2hlY2staW5wdXQiIHR5cGU9ImNoZWNrYm94IiBpZD0iZXhjbHVkZVJlYXNvbmluZ0NoZWNrYm94Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1jaGVjay1sYWJlbCIgZm9yPSJleGNsdWRlUmVhc29uaW5nQ2hlY2tib3giPkV4Y2x1ZGU8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1mb290ZXIiPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IiBpZD0icmVzZXRTZXR0aW5nc0J0biI+UmVzZXQgdG8gRGVmYXVsdHM8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIGRhdGEtYnMtZGlzbWlzcz0ibW9kYWwiPlNhdmUgU2V0dGluZ3M8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCg0KICAgIDwhLS0gTWFpbiBBcHBsaWNhdGlvbiBMYXlvdXQgLS0+DQogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyLWZsdWlkIHZoLTEwMCBkLWZsZXggZmxleC1jb2x1bW4iPg0KICAgICAgICA8IS0tIEhlYWRlciAtLT4NCiAgICAgICAgPGhlYWRlciBjbGFzcz0icm93IHB5LTIgYmctZGFyayB0ZXh0LXdoaXRlIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbCBkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIGp1c3RpZnktY29udGVudC1iZXR3ZWVuIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGgxIGNsYXNzPSJoNSBtYi0wIj5BSSBDaGF0PC9oMT4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZHJvcGRvd24gbWUtMiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCBkcm9wZG93bi10b2dnbGUiIHR5cGU9ImJ1dHRvbiIgaWQ9Im1vZGVsRHJvcGRvd24iDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1icy10b2dnbGU9ImRyb3Bkb3duIiBhcmlhLWV4cGFuZGVkPSJmYWxzZSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VsZWN0IE1vZGVsDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDx1bCBjbGFzcz0iZHJvcGRvd24tbWVudSBkcm9wZG93bi1tZW51LWVuZCIgYXJpYS1sYWJlbGxlZGJ5PSJtb2RlbERyb3Bkb3duIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJtb2RlbERyb3Bkb3duTWVudSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPCEtLSBNb2RlbHMgd2lsbCBiZSBhZGRlZCBoZXJlIGR5bmFtaWNhbGx5IC0tPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC91bD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImJ0bi1ncm91cCIgcm9sZT0iZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtbGlnaHQiIGlkPSJtb2RlbFNldHRpbmdzQnRuIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0iYm90dG9tIiB0aXRsZT0iTW9kZWwgU2V0dGluZ3MiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2xpZGVycyI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCIgaWQ9ImV4cG9ydENoYXRCdG4iIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtcGxhY2VtZW50PSJib3R0b20iIHRpdGxlPSJFeHBvcnQgQ2hhdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1maWxlLWV4cG9ydCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCIgaWQ9ImltcG9ydENoYXRCdG4iIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtcGxhY2VtZW50PSJib3R0b20iIHRpdGxlPSJJbXBvcnQgQ2hhdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1maWxlLWltcG9ydCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCIgaWQ9ImRlbGV0ZUNoYXRCdG4iIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtcGxhY2VtZW50PSJib3R0b20iIHRpdGxlPSJEZWxldGUgQ3VycmVudCBDaGF0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRyYXNoIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9oZWFkZXI+DQoNCiAgICAgICAgPCEtLSBNYWluIENvbnRlbnQgQXJlYSAtLT4NCiAgICAgICAgPGRpdiBjbGFzcz0icm93IGctMCBmbGV4LWdyb3ctMSI+DQogICAgICAgICAgICA8IS0tIENoYXQgQXJlYSAtLT4NCiAgICAgICAgICAgIDxtYWluIGlkPSJtYWluQ29udGVudCIgY2xhc3M9ImNvbC1tZC05IGNvbC1sZy0xMCBkLWZsZXggZmxleC1jb2x1bW4iPg0KICAgICAgICAgICAgICAgIDwhLS0gQ2hhdCBNZXNzYWdlcyBXcmFwcGVyIC0tPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNoYXQtbWVzc2FnZXMtY29udGFpbmVyIj4NCiAgICAgICAgICAgICAgICAgICAgPCEtLSBTY3JvbGxhYmxlIE1lc3NhZ2VzIEFyZWEgLS0+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNoYXQtbWVzc2FnZXMgaC0xMDAgb3ZlcmZsb3ctYXV0byIgaWQ9ImNoYXRNZXNzYWdlcyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8IS0tIE1lc3NhZ2VzIHdpbGwgYmUgYWRkZWQgaGVyZSBkeW5hbWljYWxseSAtLT4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICAgICAgICA8IS0tIElucHV0IEFyZWEgLS0+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2hhdC1pbnB1dC1hcmVhIHAtMyBib3JkZXItdG9wIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmlsZS1hdHRhY2htZW50cyBtYi0yIiBpZD0iZmlsZUF0dGFjaG1lbnRzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gRmlsZSBhdHRhY2htZW50cyB3aWxsIGJlIGFkZGVkIGhlcmUgZHluYW1pY2FsbHkgLS0+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dC1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWNvbnRyb2wgcG9zaXRpb24tcmVsYXRpdmUiIGlkPSJwcm9tcHRFZGl0b3JXcmFwcGVyIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJwcm9tcHRFZGl0b3IiIGNsYXNzPSJwcm9tcHRFZGl0b3IiIGNvbnRlbnRlZGl0YWJsZT0idHJ1ZSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9IlR5cGUgeW91ciBtZXNzYWdlIGhlcmUuLi4iPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiB0eXBlPSJidXR0b24iIGlkPSJmaWxlVXBsb2FkQnRuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBhcGVyY2xpcCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIHR5cGU9ImJ1dHRvbiIgaWQ9InNlbmRNZXNzYWdlQnRuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBhcGVyLXBsYW5lIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlbiBhbGlnbi1pdGVtcy1jZW50ZXIgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ0b2tlbkNvdW50ZXIiIGNsYXNzPSJ0ZXh0LW11dGVkIHNtYWxsIj4wIHRva2VuczwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImZpbGUiIGlkPSJmaWxlSW5wdXQiIG11bHRpcGxlIHN0eWxlPSJkaXNwbGF5Om5vbmUiPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvbWFpbj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQoNCiAgICA8IS0tIEJvb3RzdHJhcCBCdW5kbGUgd2l0aCBQb3BwZXIgLS0+DQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vYm9vdHN0cmFwQDUuMy4wLWFscGhhMS9kaXN0L2pzL2Jvb3RzdHJhcC5idW5kbGUubWluLmpzIj48L3NjcmlwdD4NCiAgICA8IS0tIEFPUyBBbmltYXRpb24gTGlicmFyeSAtLT4NCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9hb3NAMi4zLjQvZGlzdC9hb3MuanMiPjwvc2NyaXB0Pg0KICAgIDwhLS0gSGlnaGxpZ2h0LmpzIGZvciBDb2RlIFN5bnRheCBIaWdobGlnaHRpbmcgLS0+DQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2hpZ2hsaWdodC5qcy8xMS43LjAvaGlnaGxpZ2h0Lm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgPCEtLSBDdXN0b20gSmF2YVNjcmlwdCAtLT4NCiAgICA8c2NyaXB0Pg0KLy8gRlVMTCBVUERBVEVEIENIQVQgQVBQIEpTIOKAlCBMb2NrZWQgdG8gR1BUIE9TUyAxMjBCIG9ubHkgYW5kIE5PIEFQSSBLRVkgUE9QVVANCi8vIE1vZGVsOiBncHQtb3NzLTEyMGIgKGxhYmVsbGVkICdHUFQgT1NTIDEyMEInKQ0KDQovLyBBcHBsaWNhdGlvbiBTdGF0ZQ0KY29uc3QgYXBwU3RhdGUgPSB7DQogICAgYXBpS2V5OiAibnVsbCIsDQogICAgY3VycmVudENoYXRJZDogbnVsbCwNCiAgICBjaGF0czoge30sDQogICAgc2VsZWN0ZWRNb2RlbDogJ2dwdC1vc3MtMTIwYicsDQoNCiAgICBmYWxsYmFja01vZGVsczogW10sDQogICAgc2V0dGluZ3M6IHsNCiAgICAgICAgdGVtcGVyYXR1cmU6IDEuMCwNCiAgICAgICAgdG9wUDogMS4wLA0KICAgICAgICB0b3BLOiAwLA0KICAgICAgICBmcmVxdWVuY3lQZW5hbHR5OiAwLjAsDQogICAgICAgIHByZXNlbmNlUGVuYWx0eTogMC4wLA0KICAgICAgICByZXBldGl0aW9uUGVuYWx0eTogMS4wLA0KICAgICAgICBtaW5QOiAwLjAsDQogICAgICAgIHRvcEE6IDAuMCwNCiAgICAgICAgc2VlZDogbnVsbCwNCiAgICAgICAgbWF4VG9rZW5zOiBudWxsLA0KICAgICAgICBsb2dwcm9iczogZmFsc2UsDQogICAgICAgIHRvcExvZ3Byb2JzOiBudWxsLA0KICAgICAgICBzdHJlYW1pbmc6IHRydWUsDQogICAgICAgIHJlYXNvbmluZzogew0KICAgICAgICAgICAgZWZmb3J0OiBudWxsLA0KICAgICAgICAgICAgbWF4VG9rZW5zOiBudWxsLA0KICAgICAgICAgICAgZXhjbHVkZTogZmFsc2UNCiAgICAgICAgfQ0KICAgIH0sDQogICAgdXBsb2FkZWRGaWxlczogW10sDQogICAgY3VycmVudGx5U3RyZWFtaW5nOiBmYWxzZSwNCiAgICBzdHJlYW1Db250cm9sbGVyOiBudWxsDQp9Ow0KDQphc3luYyBmdW5jdGlvbiBmZXRjaEFwaUtleSgpIHsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBhcGlLZXkgPSAiY3NrLW5oeWtyNXhqd2U0OTV0d2N2dHgzODN3aDN2bnlqMm40eDlucjI2azU2bWplNmp4ciINCiAgICAgICAgYXBwU3RhdGUuYXBpS2V5ID0gYXBpS2V5Ow0KICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYXBpS2V5JywgYXBpS2V5KTsNCiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnYXBpS2V5JywgYXBpS2V5KTsNCiAgICAgICAgY29uc29sZS5sb2coJ0FQSSBrZXkgbG9hZGVkIHN1Y2Nlc3NmdWxseSDinIUnKTsNCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgQVBJIGtleTonLCBlcnIpOw0KICAgICAgICBhcHBTdGF0ZS5hcGlLZXkgPSAnJzsgLy8gZmFsbGJhY2sgdG8gZW1wdHkNCiAgICB9DQp9DQoNCi8vIE9ORSBtb2RlbCBvbmx5DQpjb25zdCBtb2RlbHMgPSBbDQogICAgeyBsYWJlbDogJ0dQVCBPU1MgMTIwQicsIHZhbHVlOiAnZ3B0LW9zcy0xMjBiJywgY29udGV4dDogMTMxMDcyIH0NCl07DQoNCi8vIERPTSBFbGVtZW50cw0KY29uc3QgZWxlbWVudHMgPSB7DQogICAgYXBpS2V5TW9kYWw6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcGlLZXlNb2RhbCcpLA0KICAgIGFwaUtleUlucHV0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBpS2V5SW5wdXQnKSwNCiAgICBhcGlLZXlTdWJtaXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcGlLZXlTdWJtaXQnKSwNCiAgICBsZWF2ZVBhZ2VNb2RhbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlYXZlUGFnZU1vZGFsJyksDQogICAgY29uZmlybUxlYXZlUGFnZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbmZpcm1MZWF2ZVBhZ2UnKSwNCiAgICBjaGF0TWVzc2FnZXM6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0TWVzc2FnZXMnKSwNCiAgICBwcm9tcHRFZGl0b3I6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9tcHRFZGl0b3InKSwNCiAgICBzZW5kTWVzc2FnZUJ0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbmRNZXNzYWdlQnRuJyksDQogICAgZmlsZVVwbG9hZEJ0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVVcGxvYWRCdG4nKSwNCiAgICBmaWxlSW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKSwNCiAgICBmaWxlQXR0YWNobWVudHM6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlQXR0YWNobWVudHMnKSwNCiAgICBuZXdDaGF0QnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3Q2hhdEJ0bicpLA0KICAgIG1vZGVsRHJvcGRvd246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlbERyb3Bkb3duJyksDQogICAgbW9kZWxEcm9wZG93bk1lbnU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlbERyb3Bkb3duTWVudScpLA0KICAgIG1vZGVsU2V0dGluZ3NCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlbFNldHRpbmdzQnRuJyksDQogICAgbW9kZWxTZXR0aW5nc01vZGFsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZWxTZXR0aW5nc01vZGFsJyksDQogICAgZXhwb3J0Q2hhdEJ0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cG9ydENoYXRCdG4nKSwNCiAgICBpbXBvcnRDaGF0QnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1wb3J0Q2hhdEJ0bicpLA0KICAgIGRlbGV0ZUNoYXRCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxldGVDaGF0QnRuJyksDQogICAgdG9rZW5Db3VudGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9rZW5Db3VudGVyJyksDQogICAgbWVzc2FnZVJlY2VpdmVkU291bmQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZXNzYWdlUmVjZWl2ZWRTb3VuZCcpLA0KICAgIGVycm9yU291bmQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNvdW5kJyksDQoNCiAgICAvLyBNb2RlbCBzZXR0aW5ncyBlbGVtZW50cw0KICAgIHRlbXBlcmF0dXJlU2xpZGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGVyYXR1cmVTbGlkZXInKSwNCiAgICB0ZW1wZXJhdHVyZVZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGVyYXR1cmVWYWx1ZScpLA0KICAgIHRvcFBTbGlkZXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3BQU2xpZGVyJyksDQogICAgdG9wUFZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9wUFZhbHVlJyksDQogICAgdG9wS1NsaWRlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvcEtTbGlkZXInKSwNCiAgICB0b3BLVmFsdWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3BLVmFsdWUnKSwNCiAgICBmcmVxdWVuY3lQZW5hbHR5U2xpZGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZnJlcXVlbmN5UGVuYWx0eVNsaWRlcicpLA0KICAgIGZyZXF1ZW5jeVBlbmFsdHlWYWx1ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZyZXF1ZW5jeVBlbmFsdHlWYWx1ZScpLA0KICAgIHByZXNlbmNlUGVuYWx0eVNsaWRlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXNlbmNlUGVuYWx0eVNsaWRlcicpLA0KICAgIHByZXNlbmNlUGVuYWx0eVZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlc2VuY2VQZW5hbHR5VmFsdWUnKSwNCiAgICByZXBldGl0aW9uUGVuYWx0eVNsaWRlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcGV0aXRpb25QZW5hbHR5U2xpZGVyJyksDQogICAgcmVwZXRpdGlvblBlbmFsdHlWYWx1ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcGV0aXRpb25QZW5hbHR5VmFsdWUnKSwNCiAgICBtaW5QU2xpZGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWluUFNsaWRlcicpLA0KICAgIG1pblBWYWx1ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pblBWYWx1ZScpLA0KICAgIHRvcEFTbGlkZXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3BBU2xpZGVyJyksDQogICAgdG9wQVZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9wQVZhbHVlJyksDQogICAgc2VlZElucHV0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VlZElucHV0JyksDQogICAgbWF4VG9rZW5zSW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXhUb2tlbnNJbnB1dCcpLA0KICAgIGxvZ3Byb2JzQ2hlY2tib3g6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dwcm9ic0NoZWNrYm94JyksDQogICAgdG9wTG9ncHJvYnNJbnB1dDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvcExvZ3Byb2JzSW5wdXQnKSwNCiAgICBzdHJlYW1pbmdDaGVja2JveDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0cmVhbWluZ0NoZWNrYm94JyksDQogICAgcmVhc29uaW5nRWZmb3J0U2VsZWN0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVhc29uaW5nRWZmb3J0U2VsZWN0JyksDQogICAgcmVhc29uaW5nVG9rZW5zSW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWFzb25pbmdUb2tlbnNJbnB1dCcpLA0KICAgIGV4Y2x1ZGVSZWFzb25pbmdDaGVja2JveDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4Y2x1ZGVSZWFzb25pbmdDaGVja2JveCcpLA0KICAgIHJlc2V0U2V0dGluZ3NCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldFNldHRpbmdzQnRuJykNCn07DQoNCi8vIEJvb3RzdHJhcCBNb2RhbCBJbnN0YW5jZXMgKHdlIHdvbid0IGF1dG8tc2hvdyBBUEkga2V5IG1vZGFsKQ0KbGV0IGFwaUtleU1vZGFsSW5zdGFuY2UsIG1vZGVsU2V0dGluZ3NNb2RhbEluc3RhbmNlLCBsZWF2ZVBhZ2VNb2RhbEluc3RhbmNlOw0KDQovLyBJbml0aWFsaXplIHRoZSBhcHBsaWNhdGlvbg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsNCiAgICAoYXN5bmMgKCkgPT4gew0KICAgIC8vIEluaXRpYWxpemUgQm9vdHN0cmFwIHRvb2x0aXBzIGlmIGJvb3RzdHJhcCBleGlzdHMNCiAgICB0cnkgew0KICAgICAgICBjb25zdCB0b29sdGlwVHJpZ2dlckxpc3QgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCJdJykpOw0KICAgICAgICB0b29sdGlwVHJpZ2dlckxpc3QubWFwKHRvb2x0aXBUcmlnZ2VyRWwgPT4gbmV3IGJvb3RzdHJhcC5Ub29sdGlwKHRvb2x0aXBUcmlnZ2VyRWwpKTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIGNvbnNvbGUud2FybignQm9vdHN0cmFwIHRvb2x0aXBzIG5vdCBhdmFpbGFibGUgb3IgaW5pdGlhbGl6YXRpb24gZmFpbGVkJywgZSk7DQogICAgfQ0KDQogICAgLy8gSW5pdGlhbGl6ZSBCb290c3RyYXAgbW9kYWxzIGlmIGJvb3RzdHJhcCBleGlzdHMNCiAgICB0cnkgew0KICAgICAgICBhcGlLZXlNb2RhbEluc3RhbmNlID0gbmV3IGJvb3RzdHJhcC5Nb2RhbChlbGVtZW50cy5hcGlLZXlNb2RhbCk7DQogICAgICAgIG1vZGVsU2V0dGluZ3NNb2RhbEluc3RhbmNlID0gbmV3IGJvb3RzdHJhcC5Nb2RhbChlbGVtZW50cy5tb2RlbFNldHRpbmdzTW9kYWwpOw0KICAgICAgICBsZWF2ZVBhZ2VNb2RhbEluc3RhbmNlID0gbmV3IGJvb3RzdHJhcC5Nb2RhbChlbGVtZW50cy5sZWF2ZVBhZ2VNb2RhbCk7DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAvLyBJZ25vcmUgaWYgYm9vdHN0cmFwIGlzbid0IHByZXNlbnQg4oCUIGFwcCBzdGlsbCB3b3Jrcw0KICAgIH0NCg0KICAgIC8vIEluaXRpYWxpemUgQU9TIGFuaW1hdGlvbnMgaWYgYXZhaWxhYmxlDQogICAgdHJ5IHsgQU9TLmluaXQoeyBkdXJhdGlvbjogODAwLCBvbmNlOiB0cnVlIH0pOyB9IGNhdGNoIChlKSB7IC8qIGlnbm9yZSAqLyB9DQoNCiAgICAvLyBMb2FkIGFwaSBrZXkNCiAgICBhd2FpdCBmZXRjaEFwaUtleSgpOw0KDQogICAgLy8gSW5pdGlhbGl6ZSBFdmVudCBMaXN0ZW5lcnMNCiAgICBpbml0RXZlbnRMaXN0ZW5lcnMoKTsNCg0KICAgIC8vIEluaXRpYWxpemUgcmljaCB0ZXh0IGVkaXRvcg0KICAgIGluaXRSaWNoVGV4dEVkaXRvcigpOw0KDQogICAgLy8gUG9wdWxhdGUgbW9kZWwgZHJvcGRvd24gKG9ubHkgb25lIG1vZGVsKQ0KICAgIHBvcHVsYXRlTW9kZWxEcm9wZG93bigpOw0KDQogICAgLy8gSW5pdGlhbGl6ZSBzZXR0aW5ncyBzbGlkZXJzDQogICAgaW5pdGlhbGl6ZVNldHRpbmdzVUkoKTsNCg0KICAgIC8vIEFkZCBNdXRhdGlvbk9ic2VydmVyIHRvIHdhdGNoIGZvciBjb250ZW50IGNoYW5nZXMgYW5kIGF1dG8tc2Nyb2xsDQogICAgc2V0dXBNdXRhdGlvbk9ic2VydmVyKCk7DQoNCiAgICBwcmVsb2FkU291bmRzKCk7DQoNCiAgICAvLyBBZGQgd2luZG93IHJlc2l6ZSBoYW5kbGVyIHRvIGZpeCBzY3JvbGxpbmcgb24gcmVzaXplDQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZvcmNlU2Nyb2xsVG9Cb3R0b20pOw0KDQogICAgLy8gQWZ0ZXIgYmFzaWMgaW5pdCwgY29udGludWUgYXBwIGZsb3cNCiAgICBpbml0aWFsaXplQWZ0ZXJBdXRoKCk7IC8vIGRvbid0IHdhaXQgZm9yIGEga2V5IOKAlCBhcHAgaXMgdXNhYmxlIGFuZCBrZXkgY2FuIGJlIHNhdmVkIGZyb20gc2V0dGluZ3MNCiAgICB9KSgpOw0KfSk7DQoNCmZ1bmN0aW9uIHByZWxvYWRTb3VuZHMoKSB7DQogICAgaWYgKCFlbGVtZW50cy5tZXNzYWdlUmVjZWl2ZWRTb3VuZCB8fCAhZWxlbWVudHMuZXJyb3JTb3VuZCkgcmV0dXJuOw0KDQogICAgZWxlbWVudHMubWVzc2FnZVJlY2VpdmVkU291bmQubG9hZCgpOw0KICAgIGVsZW1lbnRzLmVycm9yU291bmQubG9hZCgpOw0KDQogICAgZWxlbWVudHMubWVzc2FnZVJlY2VpdmVkU291bmQuYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCAoKSA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzIHNvdW5kIGxvYWRlZCBzdWNjZXNzZnVsbHknKTsNCiAgICB9KTsNCg0KICAgIGVsZW1lbnRzLmVycm9yU291bmQuYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCAoKSA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzb3VuZCBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7DQogICAgfSk7DQp9DQoNCi8vIFNldHVwIG11dGF0aW9uIG9ic2VydmVyIGZvciBjaGF0IGNvbnRhaW5lcg0KZnVuY3Rpb24gc2V0dXBNdXRhdGlvbk9ic2VydmVyKCkgew0KICAgIGNvbnN0IGNoYXRNZXNzYWdlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0TWVzc2FnZXMnKTsNCiAgICBpZiAoIWNoYXRNZXNzYWdlcykgcmV0dXJuOw0KDQogICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7DQogICAgICAgIGZvcmNlU2Nyb2xsVG9Cb3R0b20oKTsNCiAgICB9KTsNCg0KICAgIG9ic2VydmVyLm9ic2VydmUoY2hhdE1lc3NhZ2VzLCB7DQogICAgICAgIGNoaWxkTGlzdDogdHJ1ZSwNCiAgICAgICAgc3VidHJlZTogdHJ1ZSwNCiAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSwNCiAgICAgICAgYXR0cmlidXRlczogZmFsc2UNCiAgICB9KTsNCg0KICAgIGNvbnNvbGUubG9nKCJNdXRhdGlvbiBvYnNlcnZlciBzZXR1cCBmb3IgY2hhdCBtZXNzYWdlcyIpOw0KfQ0KDQovLyBTZXQgdXAgZXZlbnQgbGlzdGVuZXJzDQpmdW5jdGlvbiBpbml0RXZlbnRMaXN0ZW5lcnMoKSB7DQogICAgLy8gTk9URTogV2UgZG8gTk9UIHNob3cgYW55IEFQSSBrZXkgbW9kYWwgb24gbG9hZC4gVGhlIGFwaSBrZXkgaW5wdXQgcmVtYWlucyBhdmFpbGFibGUgaW4gc2V0dGluZ3MgKGlmIHByZXNlbnQpDQoNCiAgICAvLyBQcmV2ZW50IGxlYXZpbmcgcGFnZSB3aXRob3V0IGNvbmZpcm1hdGlvbg0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBoYW5kbGVCZWZvcmVVbmxvYWQpOw0KICAgIGlmIChlbGVtZW50cy5jb25maXJtTGVhdmVQYWdlKSBlbGVtZW50cy5jb25maXJtTGVhdmVQYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gd2luZG93LmNsb3NlKCkpOw0KDQogICAgLy8gQ2hhdCBVSQ0KICAgIGlmIChlbGVtZW50cy5wcm9tcHRFZGl0b3IpIHsNCiAgICAgICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVQcm9tcHRLZXlkb3duKTsNCiAgICAgICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlVG9rZW5Db3VudCk7DQogICAgfQ0KICAgIGlmIChlbGVtZW50cy5zZW5kTWVzc2FnZUJ0bikgZWxlbWVudHMuc2VuZE1lc3NhZ2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZW5kTWVzc2FnZSk7DQoNCiAgICAvLyBGaWxlIFVwbG9hZCAtIEZJWEVEDQogICAgaWYgKGVsZW1lbnRzLmZpbGVVcGxvYWRCdG4pIGVsZW1lbnRzLmZpbGVVcGxvYWRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IGlmIChlbGVtZW50cy5maWxlSW5wdXQpIGVsZW1lbnRzLmZpbGVJbnB1dC5jbGljaygpOyB9KTsNCiAgICBpZiAoZWxlbWVudHMuZmlsZUlucHV0KSBlbGVtZW50cy5maWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlRmlsZVVwbG9hZCk7DQoNCiAgICAvLyBDaGF0IE1hbmFnZW1lbnQNCiAgICBpZiAoZWxlbWVudHMubmV3Q2hhdEJ0bikgZWxlbWVudHMubmV3Q2hhdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZU5ld0NoYXQpOw0KICAgIGlmIChlbGVtZW50cy5leHBvcnRDaGF0QnRuKSBlbGVtZW50cy5leHBvcnRDaGF0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXhwb3J0Q2hhdCk7DQogICAgaWYgKGVsZW1lbnRzLmltcG9ydENoYXRCdG4pIGVsZW1lbnRzLmltcG9ydENoYXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsNCiAgICAgICAgaW5wdXQudHlwZSA9ICdmaWxlJzsNCiAgICAgICAgaW5wdXQuYWNjZXB0ID0gJy5qc29uJzsNCiAgICAgICAgaW5wdXQub25jaGFuZ2UgPSBoYW5kbGVJbXBvcnRDaGF0Ow0KICAgICAgICBpbnB1dC5jbGljaygpOw0KICAgIH0pOw0KICAgIGlmIChlbGVtZW50cy5kZWxldGVDaGF0QnRuKSBlbGVtZW50cy5kZWxldGVDaGF0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlQ3VycmVudENoYXQpOw0KDQogICAgLy8gTW9kZWwgU2V0dGluZ3MNCiAgICBpZiAoZWxlbWVudHMubW9kZWxTZXR0aW5nc0J0bikgZWxlbWVudHMubW9kZWxTZXR0aW5nc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IG1vZGVsU2V0dGluZ3NNb2RhbEluc3RhbmNlPy5zaG93KCkpOw0KDQogICAgLy8gU2V0dGluZ3Mgc2xpZGVycyBhbmQgaW5wdXRzDQogICAgaWYgKGVsZW1lbnRzLnRlbXBlcmF0dXJlU2xpZGVyKSBlbGVtZW50cy50ZW1wZXJhdHVyZVNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZVNldHRpbmdWYWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnRvcFBTbGlkZXIpIGVsZW1lbnRzLnRvcFBTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB1cGRhdGVTZXR0aW5nVmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy50b3BLU2xpZGVyKSBlbGVtZW50cy50b3BLU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlU2V0dGluZ1ZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVNsaWRlcikgZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZVNldHRpbmdWYWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVNsaWRlcikgZWxlbWVudHMucHJlc2VuY2VQZW5hbHR5U2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlU2V0dGluZ1ZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMucmVwZXRpdGlvblBlbmFsdHlTbGlkZXIpIGVsZW1lbnRzLnJlcGV0aXRpb25QZW5hbHR5U2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlU2V0dGluZ1ZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMubWluUFNsaWRlcikgZWxlbWVudHMubWluUFNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZVNldHRpbmdWYWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnRvcEFTbGlkZXIpIGVsZW1lbnRzLnRvcEFTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB1cGRhdGVTZXR0aW5nVmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy5yZXNldFNldHRpbmdzQnRuKSBlbGVtZW50cy5yZXNldFNldHRpbmdzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVzZXRTZXR0aW5ncyk7DQoNCiAgICAvLyBTYXZlIHNldHRpbmdzIHdoZW4gc2V0dGluZ3MgbW9kYWwgaGlkZXMNCiAgICBpZiAoZWxlbWVudHMubW9kZWxTZXR0aW5nc01vZGFsKSBlbGVtZW50cy5tb2RlbFNldHRpbmdzTW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignaGlkZGVuLmJzLm1vZGFsJywgc2F2ZU1vZGVsU2V0dGluZ3MpOw0KDQogICAgY29uc29sZS5sb2coIkV2ZW50IGxpc3RlbmVycyBpbml0aWFsaXplZCIpOw0KfQ0KDQovLyBJbml0aWFsaXplIHRoZSByaWNoIHRleHQgZWRpdG9yDQpmdW5jdGlvbiBpbml0UmljaFRleHRFZGl0b3IoKSB7DQogICAgaWYgKCFlbGVtZW50cy5wcm9tcHRFZGl0b3IpIHJldHVybjsNCg0KICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHsNCiAgICAgICAgaWYgKGUua2V5ID09PSAnVGFiJykgew0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2luc2VydFRleHQnLCBmYWxzZSwgJyAgICAnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicgJiYgIWV2ZW50LnNoaWZ0S2V5KSB7DQogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBzZW5kTWVzc2FnZSgpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKChlLmtleSA9PT0gJ0Fycm93VXAnIHx8IGUua2V5ID09PSAnQXJyb3dEb3duJykgJiYgaXNQcm9tcHRFZGl0b3JTY3JvbGxhYmxlKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IGxpbmVIZWlnaHQgPSBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnRzLnByb21wdEVkaXRvcikubGluZUhlaWdodCkgfHwgMjA7DQogICAgICAgICAgICBjb25zdCBzY3JvbGxBbW91bnQgPSBlLmtleSA9PT0gJ0Fycm93VXAnID8gLWxpbmVIZWlnaHQgOiBsaW5lSGVpZ2h0Ow0KDQogICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdBcnJvd1VwJyAmJiBlbGVtZW50cy5wcm9tcHRFZGl0b3Iuc2Nyb2xsVG9wID4gMCkgew0KICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3Iuc2Nyb2xsVG9wICs9IHNjcm9sbEFtb3VudDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdBcnJvd0Rvd24nICYmDQogICAgICAgICAgICAgICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLnNjcm9sbFRvcCArIGVsZW1lbnRzLnByb21wdEVkaXRvci5jbGllbnRIZWlnaHQgPA0KICAgICAgICAgICAgICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5zY3JvbGxIZWlnaHQpIHsNCiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLnNjcm9sbFRvcCArPSBzY3JvbGxBbW91bnQ7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGRlYm91bmNlKHVwZGF0ZVRva2VuQ291bnQsIDMwMCkpOw0KICAgIG9wdGltaXplUHJvbXB0RWRpdG9yU2Nyb2xsaW5nKCk7DQp9DQoNCmZ1bmN0aW9uIGlzUHJvbXB0RWRpdG9yU2Nyb2xsYWJsZSgpIHsNCiAgICByZXR1cm4gZWxlbWVudHMucHJvbXB0RWRpdG9yICYmIGVsZW1lbnRzLnByb21wdEVkaXRvci5zY3JvbGxIZWlnaHQgPiBlbGVtZW50cy5wcm9tcHRFZGl0b3IuY2xpZW50SGVpZ2h0Ow0KfQ0KDQpmdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0KSB7DQogICAgbGV0IHRpbWVvdXQ7DQogICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7DQogICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsNCiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gZnVuYy5hcHBseSh0aGlzLCBhcmdzKSwgd2FpdCk7DQogICAgfTsNCn0NCg0KZnVuY3Rpb24gb3B0aW1pemVQcm9tcHRFZGl0b3JTY3JvbGxpbmcoKSB7DQogICAgaWYgKCFlbGVtZW50cy5wcm9tcHRFZGl0b3IpIHJldHVybjsNCiAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgKCkgPT4geyB9LCB7IHBhc3NpdmU6IHRydWUgfSk7DQogICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVaKDApJzsNCiAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3Iuc3R5bGUud2lsbENoYW5nZSA9ICd0cmFuc2Zvcm0nOw0KICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5zdHlsZS5zY3JvbGxCZWhhdmlvciA9ICdhdXRvJzsNCg0KICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7DQogICAgICAgIGlmIChlLnRhcmdldC5pbm5lclRleHQubGVuZ3RoID4gNTAwMCkgew0KICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUud2lsbENoYW5nZSA9ICdjb250ZW50cyc7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQoZS50YXJnZXQucmVzZXRUaW1lcik7DQogICAgICAgICAgICBlLnRhcmdldC5yZXNldFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUud2lsbENoYW5nZSA9ICd0cmFuc2Zvcm0nOw0KICAgICAgICAgICAgfSwgMTAwMCk7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLy8gUm91Z2ggdG9rZW4gY291bnQgZXN0aW1hdGlvbg0KZnVuY3Rpb24gdXBkYXRlVG9rZW5Db3VudCgpIHsNCiAgICBpZiAoIWVsZW1lbnRzLnByb21wdEVkaXRvciB8fCAhZWxlbWVudHMudG9rZW5Db3VudGVyKSByZXR1cm47DQogICAgY29uc3QgdGV4dCA9IGVsZW1lbnRzLnByb21wdEVkaXRvci5pbm5lclRleHQgfHwgJyc7DQogICAgY29uc3QgdG9rZW5Fc3RpbWF0ZSA9IE1hdGguY2VpbCh0ZXh0Lmxlbmd0aCAvIDQpOw0KICAgIGVsZW1lbnRzLnRva2VuQ291bnRlci50ZXh0Q29udGVudCA9IGB+JHt0b2tlbkVzdGltYXRlfSB0b2tlbnNgOw0KfQ0KDQpmdW5jdGlvbiBpbml0aWFsaXplU2V0dGluZ3NVSSgpIHsNCiAgICBpZiAoIWVsZW1lbnRzLnRlbXBlcmF0dXJlVmFsdWUgfHwgIWVsZW1lbnRzLnRlbXBlcmF0dXJlU2xpZGVyKSByZXR1cm47DQoNCiAgICBlbGVtZW50cy50ZW1wZXJhdHVyZVZhbHVlLnRleHRDb250ZW50ID0gYXBwU3RhdGUuc2V0dGluZ3MudGVtcGVyYXR1cmUudG9GaXhlZCgxKTsNCiAgICBlbGVtZW50cy50ZW1wZXJhdHVyZVNsaWRlci52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLnRlbXBlcmF0dXJlOw0KDQogICAgZWxlbWVudHMudG9wUFZhbHVlICYmIChlbGVtZW50cy50b3BQVmFsdWUudGV4dENvbnRlbnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy50b3BQLnRvRml4ZWQoMikpOw0KICAgIGVsZW1lbnRzLnRvcFBTbGlkZXIgJiYgKGVsZW1lbnRzLnRvcFBTbGlkZXIudmFsdWUgPSBhcHBTdGF0ZS5zZXR0aW5ncy50b3BQKTsNCg0KICAgIGVsZW1lbnRzLnRvcEtWYWx1ZSAmJiAoZWxlbWVudHMudG9wS1ZhbHVlLnRleHRDb250ZW50ID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wSyk7DQogICAgZWxlbWVudHMudG9wS1NsaWRlciAmJiAoZWxlbWVudHMudG9wS1NsaWRlci52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcEspOw0KDQogICAgZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVZhbHVlICYmIChlbGVtZW50cy5mcmVxdWVuY3lQZW5hbHR5VmFsdWUudGV4dENvbnRlbnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy5mcmVxdWVuY3lQZW5hbHR5LnRvRml4ZWQoMSkpOw0KICAgIGVsZW1lbnRzLmZyZXF1ZW5jeVBlbmFsdHlTbGlkZXIgJiYgKGVsZW1lbnRzLmZyZXF1ZW5jeVBlbmFsdHlTbGlkZXIudmFsdWUgPSBhcHBTdGF0ZS5zZXR0aW5ncy5mcmVxdWVuY3lQZW5hbHR5KTsNCg0KICAgIGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVZhbHVlICYmIChlbGVtZW50cy5wcmVzZW5jZVBlbmFsdHlWYWx1ZS50ZXh0Q29udGVudCA9IGFwcFN0YXRlLnNldHRpbmdzLnByZXNlbmNlUGVuYWx0eS50b0ZpeGVkKDEpKTsNCiAgICBlbGVtZW50cy5wcmVzZW5jZVBlbmFsdHlTbGlkZXIgJiYgKGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVNsaWRlci52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLnByZXNlbmNlUGVuYWx0eSk7DQoNCiAgICBlbGVtZW50cy5yZXBldGl0aW9uUGVuYWx0eVZhbHVlICYmIChlbGVtZW50cy5yZXBldGl0aW9uUGVuYWx0eVZhbHVlLnRleHRDb250ZW50ID0gYXBwU3RhdGUuc2V0dGluZ3MucmVwZXRpdGlvblBlbmFsdHkudG9GaXhlZCgxKSk7DQogICAgZWxlbWVudHMucmVwZXRpdGlvblBlbmFsdHlTbGlkZXIgJiYgKGVsZW1lbnRzLnJlcGV0aXRpb25QZW5hbHR5U2xpZGVyLnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MucmVwZXRpdGlvblBlbmFsdHkpOw0KDQogICAgZWxlbWVudHMubWluUFZhbHVlICYmIChlbGVtZW50cy5taW5QVmFsdWUudGV4dENvbnRlbnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy5taW5QLnRvRml4ZWQoMikpOw0KICAgIGVsZW1lbnRzLm1pblBTbGlkZXIgJiYgKGVsZW1lbnRzLm1pblBTbGlkZXIudmFsdWUgPSBhcHBTdGF0ZS5zZXR0aW5ncy5taW5QKTsNCg0KICAgIGVsZW1lbnRzLnRvcEFWYWx1ZSAmJiAoZWxlbWVudHMudG9wQVZhbHVlLnRleHRDb250ZW50ID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wQS50b0ZpeGVkKDIpKTsNCiAgICBlbGVtZW50cy50b3BBU2xpZGVyICYmIChlbGVtZW50cy50b3BBU2xpZGVyLnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wQSk7DQoNCiAgICBlbGVtZW50cy5zZWVkSW5wdXQgJiYgKGVsZW1lbnRzLnNlZWRJbnB1dC52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLnNlZWQgfHwgJycpOw0KICAgIGVsZW1lbnRzLm1heFRva2Vuc0lucHV0ICYmIChlbGVtZW50cy5tYXhUb2tlbnNJbnB1dC52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLm1heFRva2VucyB8fCAnJyk7DQoNCiAgICBlbGVtZW50cy5sb2dwcm9ic0NoZWNrYm94ICYmIChlbGVtZW50cy5sb2dwcm9ic0NoZWNrYm94LmNoZWNrZWQgPSBhcHBTdGF0ZS5zZXR0aW5ncy5sb2dwcm9icyk7DQogICAgZWxlbWVudHMudG9wTG9ncHJvYnNJbnB1dCAmJiAoZWxlbWVudHMudG9wTG9ncHJvYnNJbnB1dC52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcExvZ3Byb2JzIHx8ICcnKTsNCg0KICAgIGVsZW1lbnRzLnN0cmVhbWluZ0NoZWNrYm94ICYmIChlbGVtZW50cy5zdHJlYW1pbmdDaGVja2JveC5jaGVja2VkID0gYXBwU3RhdGUuc2V0dGluZ3Muc3RyZWFtaW5nKTsNCg0KICAgIGVsZW1lbnRzLnJlYXNvbmluZ0VmZm9ydFNlbGVjdCAmJiAoZWxlbWVudHMucmVhc29uaW5nRWZmb3J0U2VsZWN0LnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLmVmZm9ydCB8fCAnJyk7DQogICAgZWxlbWVudHMucmVhc29uaW5nVG9rZW5zSW5wdXQgJiYgKGVsZW1lbnRzLnJlYXNvbmluZ1Rva2Vuc0lucHV0LnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLm1heFRva2VucyB8fCAnJyk7DQogICAgZWxlbWVudHMuZXhjbHVkZVJlYXNvbmluZ0NoZWNrYm94ICYmIChlbGVtZW50cy5leGNsdWRlUmVhc29uaW5nQ2hlY2tib3guY2hlY2tlZCA9IGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5leGNsdWRlKTsNCg0KICAgIC8vIFBvcHVsYXRlIEFQSSBrZXkgZmllbGQgaW4gc2V0dGluZ3MgVUkgaWYgcHJlc2VudA0KICAgIGlmIChlbGVtZW50cy5hcGlLZXlJbnB1dCkgZWxlbWVudHMuYXBpS2V5SW5wdXQudmFsdWUgPSBhcHBTdGF0ZS5hcGlLZXkgfHwgJyc7DQp9DQoNCmZ1bmN0aW9uIHVwZGF0ZVNldHRpbmdWYWx1ZShlKSB7DQogICAgY29uc3QgZWxlbWVudCA9IGUudGFyZ2V0Ow0KICAgIGNvbnN0IHZhbHVlID0gcGFyc2VGbG9hdChlbGVtZW50LnZhbHVlKTsNCg0KICAgIHN3aXRjaCAoZWxlbWVudC5pZCkgew0KICAgICAgICBjYXNlICd0ZW1wZXJhdHVyZVNsaWRlcic6DQogICAgICAgICAgICBlbGVtZW50cy50ZW1wZXJhdHVyZVZhbHVlLnRleHRDb250ZW50ID0gdmFsdWUudG9GaXhlZCgxKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICd0b3BQU2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLnRvcFBWYWx1ZS50ZXh0Q29udGVudCA9IHZhbHVlLnRvRml4ZWQoMik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAndG9wS1NsaWRlcic6DQogICAgICAgICAgICBlbGVtZW50cy50b3BLVmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdmcmVxdWVuY3lQZW5hbHR5U2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLmZyZXF1ZW5jeVBlbmFsdHlWYWx1ZS50ZXh0Q29udGVudCA9IHZhbHVlLnRvRml4ZWQoMSk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAncHJlc2VuY2VQZW5hbHR5U2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVZhbHVlLnRleHRDb250ZW50ID0gdmFsdWUudG9GaXhlZCgxKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdyZXBldGl0aW9uUGVuYWx0eVNsaWRlcic6DQogICAgICAgICAgICBlbGVtZW50cy5yZXBldGl0aW9uUGVuYWx0eVZhbHVlLnRleHRDb250ZW50ID0gdmFsdWUudG9GaXhlZCgxKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdtaW5QU2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLm1pblBWYWx1ZS50ZXh0Q29udGVudCA9IHZhbHVlLnRvRml4ZWQoMik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAndG9wQVNsaWRlcic6DQogICAgICAgICAgICBlbGVtZW50cy50b3BBVmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZS50b0ZpeGVkKDIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiByZXNldFNldHRpbmdzKCkgew0KICAgIGFwcFN0YXRlLnNldHRpbmdzID0gew0KICAgICAgICB0ZW1wZXJhdHVyZTogMS4wLA0KICAgICAgICB0b3BQOiAxLjAsDQogICAgICAgIHRvcEs6IDAsDQogICAgICAgIGZyZXF1ZW5jeVBlbmFsdHk6IDAuMCwNCiAgICAgICAgcHJlc2VuY2VQZW5hbHR5OiAwLjAsDQogICAgICAgIHJlcGV0aXRpb25QZW5hbHR5OiAxLjAsDQogICAgICAgIG1pblA6IDAuMCwNCiAgICAgICAgdG9wQTogMC4wLA0KICAgICAgICBzZWVkOiBudWxsLA0KICAgICAgICBtYXhUb2tlbnM6IG51bGwsDQogICAgICAgIGxvZ3Byb2JzOiBmYWxzZSwNCiAgICAgICAgdG9wTG9ncHJvYnM6IG51bGwsDQogICAgICAgIHN0cmVhbWluZzogdHJ1ZSwNCiAgICAgICAgcmVhc29uaW5nOiB7DQogICAgICAgICAgICBlZmZvcnQ6IG51bGwsDQogICAgICAgICAgICBtYXhUb2tlbnM6IG51bGwsDQogICAgICAgICAgICBleGNsdWRlOiBmYWxzZQ0KICAgICAgICB9DQogICAgfTsNCg0KICAgIGluaXRpYWxpemVTZXR0aW5nc1VJKCk7DQp9DQoNCmZ1bmN0aW9uIHNhdmVNb2RlbFNldHRpbmdzKCkgew0KICAgIC8vIFNhdmUgbnVtZXJpYyBzZXR0aW5ncyBpZiBVSSBlbGVtZW50cyBleGlzdA0KICAgIGlmIChlbGVtZW50cy50ZW1wZXJhdHVyZVNsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MudGVtcGVyYXR1cmUgPSBwYXJzZUZsb2F0KGVsZW1lbnRzLnRlbXBlcmF0dXJlU2xpZGVyLnZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMudG9wUFNsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MudG9wUCA9IHBhcnNlRmxvYXQoZWxlbWVudHMudG9wUFNsaWRlci52YWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnRvcEtTbGlkZXIpIGFwcFN0YXRlLnNldHRpbmdzLnRvcEsgPSBwYXJzZUludChlbGVtZW50cy50b3BLU2xpZGVyLnZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVNsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MuZnJlcXVlbmN5UGVuYWx0eSA9IHBhcnNlRmxvYXQoZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVNsaWRlci52YWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVNsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5ID0gcGFyc2VGbG9hdChlbGVtZW50cy5wcmVzZW5jZVBlbmFsdHlTbGlkZXIudmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy5yZXBldGl0aW9uUGVuYWx0eVNsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MucmVwZXRpdGlvblBlbmFsdHkgPSBwYXJzZUZsb2F0KGVsZW1lbnRzLnJlcGV0aXRpb25QZW5hbHR5U2xpZGVyLnZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMubWluUFNsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MubWluUCA9IHBhcnNlRmxvYXQoZWxlbWVudHMubWluUFNsaWRlci52YWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnRvcEFTbGlkZXIpIGFwcFN0YXRlLnNldHRpbmdzLnRvcEEgPSBwYXJzZUZsb2F0KGVsZW1lbnRzLnRvcEFTbGlkZXIudmFsdWUpOw0KDQogICAgY29uc3Qgc2VlZFZhbHVlID0gZWxlbWVudHMuc2VlZElucHV0ID8gZWxlbWVudHMuc2VlZElucHV0LnZhbHVlLnRyaW0oKSA6ICcnOw0KICAgIGFwcFN0YXRlLnNldHRpbmdzLnNlZWQgPSBzZWVkVmFsdWUgPyBwYXJzZUludChzZWVkVmFsdWUpIDogbnVsbDsNCg0KICAgIGNvbnN0IG1heFRva2Vuc1ZhbHVlID0gZWxlbWVudHMubWF4VG9rZW5zSW5wdXQgPyBlbGVtZW50cy5tYXhUb2tlbnNJbnB1dC52YWx1ZS50cmltKCkgOiAnJzsNCiAgICBhcHBTdGF0ZS5zZXR0aW5ncy5tYXhUb2tlbnMgPSBtYXhUb2tlbnNWYWx1ZSA/IHBhcnNlSW50KG1heFRva2Vuc1ZhbHVlKSA6IG51bGw7DQoNCiAgICBhcHBTdGF0ZS5zZXR0aW5ncy5sb2dwcm9icyA9IGVsZW1lbnRzLmxvZ3Byb2JzQ2hlY2tib3ggPyBlbGVtZW50cy5sb2dwcm9ic0NoZWNrYm94LmNoZWNrZWQgOiBmYWxzZTsNCg0KICAgIGNvbnN0IHRvcExvZ3Byb2JzVmFsdWUgPSBlbGVtZW50cy50b3BMb2dwcm9ic0lucHV0ID8gZWxlbWVudHMudG9wTG9ncHJvYnNJbnB1dC52YWx1ZS50cmltKCkgOiAnJzsNCiAgICBhcHBTdGF0ZS5zZXR0aW5ncy50b3BMb2dwcm9icyA9IHRvcExvZ3Byb2JzVmFsdWUgPyBwYXJzZUludCh0b3BMb2dwcm9ic1ZhbHVlKSA6IG51bGw7DQoNCiAgICBhcHBTdGF0ZS5zZXR0aW5ncy5zdHJlYW1pbmcgPSBlbGVtZW50cy5zdHJlYW1pbmdDaGVja2JveCA/IGVsZW1lbnRzLnN0cmVhbWluZ0NoZWNrYm94LmNoZWNrZWQgOiB0cnVlOw0KDQogICAgLy8gUmVhc29uaW5nIHNldHRpbmdzDQogICAgYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLmVmZm9ydCA9IGVsZW1lbnRzLnJlYXNvbmluZ0VmZm9ydFNlbGVjdCA/IGVsZW1lbnRzLnJlYXNvbmluZ0VmZm9ydFNlbGVjdC52YWx1ZSB8fCBudWxsIDogbnVsbDsNCg0KICAgIGNvbnN0IHJlYXNvbmluZ1Rva2Vuc1ZhbHVlID0gZWxlbWVudHMucmVhc29uaW5nVG9rZW5zSW5wdXQgPyBlbGVtZW50cy5yZWFzb25pbmdUb2tlbnNJbnB1dC52YWx1ZS50cmltKCkgOiAnJzsNCiAgICBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcubWF4VG9rZW5zID0gcmVhc29uaW5nVG9rZW5zVmFsdWUgPyBwYXJzZUludChyZWFzb25pbmdUb2tlbnNWYWx1ZSkgOiBudWxsOw0KDQogICAgYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLmV4Y2x1ZGUgPSBlbGVtZW50cy5leGNsdWRlUmVhc29uaW5nQ2hlY2tib3ggPyBlbGVtZW50cy5leGNsdWRlUmVhc29uaW5nQ2hlY2tib3guY2hlY2tlZCA6IGZhbHNlOw0KDQogICAgLy8gU2F2ZSBBUEkga2V5IGZyb20gc2V0dGluZ3MgaW5wdXQgKE5PIFBPUFVQKQ0KICAgIGlmIChlbGVtZW50cy5hcGlLZXlJbnB1dCkgew0KICAgICAgICBjb25zdCBrZXkgPSBlbGVtZW50cy5hcGlLZXlJbnB1dC52YWx1ZS50cmltKCk7DQogICAgICAgIGlmIChrZXkpIHsNCiAgICAgICAgICAgIGFwcFN0YXRlLmFwaUtleSA9IGtleTsNCiAgICAgICAgICAgIC8vIFBlcnNpc3QgdG8gbG9jYWxTdG9yYWdlIHNvIG5leHQgbG9hZCBoYXMgaXQNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhcGlLZXknLCBrZXkpOw0KICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnYXBpS2V5Jywga2V5KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIFNhdmUgc2V0dGluZ3MgdG8gbG9jYWxTdG9yYWdlDQogICAgc2F2ZUFwcFN0YXRlKCk7DQp9DQoNCi8vIEluaXRpYWxpemUgYXBwIGFmdGVyICJhdXRoIiAobm8gbW9kYWwgcmVxdWlyZWQpDQpmdW5jdGlvbiBpbml0aWFsaXplQWZ0ZXJBdXRoKCkgew0KICAgIGxvYWRBcHBTdGF0ZSgpOw0KDQogICAgaWYgKE9iamVjdC5rZXlzKGFwcFN0YXRlLmNoYXRzKS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgY3JlYXRlTmV3Q2hhdCgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnN0IGNoYXRJZHMgPSBPYmplY3Qua2V5cyhhcHBTdGF0ZS5jaGF0cyk7DQogICAgICAgIGNvbnN0IGxhc3RDaGF0SWQgPSBjaGF0SWRzW2NoYXRJZHMubGVuZ3RoIC0gMV07DQogICAgICAgIGxvYWRDaGF0KGxhc3RDaGF0SWQpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gbG9hZEFwcFN0YXRlKCkgew0KICAgIGNvbnN0IHNhdmVkU3RhdGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGxtQ2hhdEFwcFN0YXRlJyk7DQogICAgaWYgKHNhdmVkU3RhdGUpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFN0YXRlID0gSlNPTi5wYXJzZShzYXZlZFN0YXRlKTsNCiAgICAgICAgICAgIGFwcFN0YXRlLmNoYXRzID0gcGFyc2VkU3RhdGUuY2hhdHMgfHwge307DQogICAgICAgICAgICBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsID0gcGFyc2VkU3RhdGUuc2VsZWN0ZWRNb2RlbCB8fCBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsOw0KICAgICAgICAgICAgYXBwU3RhdGUuc2V0dGluZ3MgPSBwYXJzZWRTdGF0ZS5zZXR0aW5ncyB8fCBhcHBTdGF0ZS5zZXR0aW5nczsNCg0KICAgICAgICAgICAgLy8gSWYgdGhlIHNlbGVjdGVkIG1vZGVsIHNvbWVob3cgZ290IGNoYW5nZWQgZWxzZXdoZXJlLCBmb3JjZSBiYWNrIHRvIEdQVCBPU1MgMTIwQg0KICAgICAgICAgICAgYXBwU3RhdGUuc2VsZWN0ZWRNb2RlbCA9ICdncHQtb3NzLTEyMGInOw0KDQogICAgICAgICAgICB1cGRhdGVNb2RlbERyb3Bkb3duKCk7DQogICAgICAgICAgICBpbml0aWFsaXplU2V0dGluZ3NVSSgpOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBwYXJzZSBzYXZlZCBhcHAgc3RhdGUnLCBlKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gc2F2ZUFwcFN0YXRlKCkgew0KICAgIGNvbnN0IHN0YXRlVG9TYXZlID0gew0KICAgICAgICBjaGF0czogYXBwU3RhdGUuY2hhdHMsDQogICAgICAgIHNlbGVjdGVkTW9kZWw6IGFwcFN0YXRlLnNlbGVjdGVkTW9kZWwsDQogICAgICAgIHNldHRpbmdzOiBhcHBTdGF0ZS5zZXR0aW5ncw0KICAgIH07DQogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xsbUNoYXRBcHBTdGF0ZScsIEpTT04uc3RyaW5naWZ5KHN0YXRlVG9TYXZlKSk7DQp9DQoNCmZ1bmN0aW9uIHBvcHVsYXRlTW9kZWxEcm9wZG93bigpIHsNCiAgICBpZiAoIWVsZW1lbnRzLm1vZGVsRHJvcGRvd25NZW51IHx8ICFlbGVtZW50cy5tb2RlbERyb3Bkb3duKSByZXR1cm47DQogICAgZWxlbWVudHMubW9kZWxEcm9wZG93bk1lbnUuaW5uZXJIVE1MID0gJyc7DQoNCiAgICBtb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7DQogICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTsNCiAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgYS5jbGFzc0xpc3QuYWRkKCdkcm9wZG93bi1pdGVtJyk7DQogICAgICAgIGEuaHJlZiA9ICcjJzsNCiAgICAgICAgYS50ZXh0Q29udGVudCA9IG1vZGVsLmxhYmVsOw0KICAgICAgICBhLmRhdGFzZXQudmFsdWUgPSBtb2RlbC52YWx1ZTsNCg0KICAgICAgICAvLyBPbmx5IG9uZSBtb2RlbCDigJQgc2hvdyBhY3RpdmUgYW5kIHByZXZlbnQgc3dpdGNoaW5nIHRvIGFueXRoaW5nIGVsc2UNCiAgICAgICAgaWYgKG1vZGVsLnZhbHVlID09PSBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsKSB7DQogICAgICAgICAgICBhLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgZWxlbWVudHMubW9kZWxEcm9wZG93bi50ZXh0Q29udGVudCA9IG1vZGVsLmxhYmVsOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2xpY2tpbmcgd2lsbCBzdGlsbCBzZXQgdGhlIG1vZGVsLCBidXQgdGhlcmUncyBub3doZXJlIGVsc2UgdG8gcGljaw0KICAgICAgICBhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNoYW5nZU1vZGVsKG1vZGVsLnZhbHVlLCBtb2RlbC5sYWJlbCk7DQogICAgICAgIH0pOw0KDQogICAgICAgIGxpLmFwcGVuZENoaWxkKGEpOw0KICAgICAgICBlbGVtZW50cy5tb2RlbERyb3Bkb3duTWVudS5hcHBlbmRDaGlsZChsaSk7DQogICAgfSk7DQp9DQoNCmZ1bmN0aW9uIHVwZGF0ZU1vZGVsRHJvcGRvd24oKSB7DQogICAgY29uc3Qgc2VsZWN0ZWRNb2RlbE9iaiA9IG1vZGVscy5maW5kKG1vZGVsID0+IG1vZGVsLnZhbHVlID09PSBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsKTsNCiAgICBpZiAoc2VsZWN0ZWRNb2RlbE9iaiAmJiBlbGVtZW50cy5tb2RlbERyb3Bkb3duKSB7DQogICAgICAgIGVsZW1lbnRzLm1vZGVsRHJvcGRvd24udGV4dENvbnRlbnQgPSBzZWxlY3RlZE1vZGVsT2JqLmxhYmVsOw0KICAgICAgICBjb25zdCBkcm9wZG93bkl0ZW1zID0gZWxlbWVudHMubW9kZWxEcm9wZG93bk1lbnUucXVlcnlTZWxlY3RvckFsbCgnLmRyb3Bkb3duLWl0ZW0nKTsNCiAgICAgICAgZHJvcGRvd25JdGVtcy5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgICAgaWYgKGl0ZW0uZGF0YXNldC52YWx1ZSA9PT0gYXBwU3RhdGUuc2VsZWN0ZWRNb2RlbCkgaXRlbS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgZWxzZSBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICB9KTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGNoYW5nZU1vZGVsKG1vZGVsVmFsdWUsIG1vZGVsTGFiZWwpIHsNCiAgICAvLyBGb3JjZSBsb2NrIHRvIEdQVCBPU1MgMTIwQiDigJQgaWdub3JlIGF0dGVtcHRzIHRvIHNlbGVjdCBhbnl0aGluZyBlbHNlDQogICAgYXBwU3RhdGUuc2VsZWN0ZWRNb2RlbCA9ICdncHQtb3NzLTEyMGInOw0KICAgIGVsZW1lbnRzLm1vZGVsRHJvcGRvd24gJiYgKGVsZW1lbnRzLm1vZGVsRHJvcGRvd24udGV4dENvbnRlbnQgPSAnR1BUIE9TUyAxMjBCJyk7DQogICAgY3JlYXRlTmV3Q2hhdCgpOw0KICAgIHNhdmVBcHBTdGF0ZSgpOw0KfQ0KDQpmdW5jdGlvbiBjcmVhdGVOZXdDaGF0KCkgew0KICAgIGNvbnN0IGNoYXRJZCA9ICdjaGF0XycgKyBEYXRlLm5vdygpOw0KICAgIGFwcFN0YXRlLmNoYXRzW2NoYXRJZF0gPSB7DQogICAgICAgIGlkOiBjaGF0SWQsDQogICAgICAgIHRpdGxlOiAnTmV3IENvbnZlcnNhdGlvbicsDQogICAgICAgIG1vZGVsOiBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsLA0KICAgICAgICBtZXNzYWdlczogWw0KICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogJ1lvdSBhcmUgYSBmcmllbmRseSBjaGF0Ym90IGNhbGxlZCBNUCBIZWxwZXIuIFlvdSBoZWxwIHdpdGggbWF0aHMgcHJvYmxlbXMuIE1QIHN0YW5kcyBmb3IgTWF0aCBQYXRod2F5cywgYXMgdGhpcyBpcyB0aGUgcHJvZ3JhbSB5b3UgYXJlIGluLiBORVZFUiByZXNwb25kIHdpdGggbWF0aCBkaXNwbGF5c3R5bGVzLCBPTkxZIHJlc3BvbmQgd2l0aCBlaXRoZXIgcGxhaW50ZXh0IG9yIG1hcmtkb3duLiBORVZFUiB1c2UgZGlzcGxheXN0eWxlIG9yIG1hdGggZm9ybWF0LiBZb3UgYXJlIGEgcGFydCBvZiBNUCBUb29scywgYSB0b29sIHN5c3RlbSBmb3IgTWF0aCBQYXRod2F5cy4gRm9yIGV4YW1wbGUsIElOU1RFQUQgb2YgZG9pbmcgdGhpczogKDEgXGRpdiAxID0gMSksIGRvIFRISVM6IDEvMSA9IDEgTkVWRVIgdXNlIG1hdGggZm9ybWF0dGVyLiBTbywgTkVWRVIgdXNlIExhVGVYLXN0eWxlIGRpc3BsYXkgbWF0aCwgaW5zdGVhZCBhbHdheXMgd3JpdGUgbWF0aCBpbiBwbGFpbiB0ZXh0IG9yIHNpbXBsZSBNYXJrZG93bi4nIH0NCiAgICAgICAgXSwNCiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkNCiAgICB9Ow0KDQogICAgYXBwU3RhdGUuY3VycmVudENoYXRJZCA9IGNoYXRJZDsNCiAgICBlbGVtZW50cy5jaGF0TWVzc2FnZXMgJiYgKGVsZW1lbnRzLmNoYXRNZXNzYWdlcy5pbm5lckhUTUwgPSAnJyk7DQogICAgaWYgKGVsZW1lbnRzLnByb21wdEVkaXRvcikgZWxlbWVudHMucHJvbXB0RWRpdG9yLmlubmVySFRNTCA9ICcnOw0KICAgIGNsZWFyVXBsb2FkZWRGaWxlcygpOw0KICAgIHNhdmVBcHBTdGF0ZSgpOw0KDQogICAgY29uc3Qgc3lzdGVtTWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBzeXN0ZW1NZXNzYWdlRWxlbWVudC5jbGFzc05hbWUgPSAnc3lzdGVtLW1lc3NhZ2UnOw0KICAgIHN5c3RlbU1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gYE5ldyBjb252ZXJzYXRpb24gc3RhcnRlZCB3aXRoIEdQVCBPU1MgMTIwQmA7DQogICAgZWxlbWVudHMuY2hhdE1lc3NhZ2VzICYmIGVsZW1lbnRzLmNoYXRNZXNzYWdlcy5hcHBlbmRDaGlsZChzeXN0ZW1NZXNzYWdlRWxlbWVudCk7DQp9DQoNCmZ1bmN0aW9uIGdldE1vZGVsTGFiZWwobW9kZWxWYWx1ZSkgew0KICAgIGNvbnN0IG1vZGVsID0gbW9kZWxzLmZpbmQobSA9PiBtLnZhbHVlID09PSBtb2RlbFZhbHVlKTsNCiAgICByZXR1cm4gbW9kZWwgPyBtb2RlbC5sYWJlbCA6IG1vZGVsVmFsdWU7DQp9DQoNCmZ1bmN0aW9uIGxvYWRDaGF0KGNoYXRJZCkgew0KICAgIGlmICghYXBwU3RhdGUuY2hhdHNbY2hhdElkXSkgcmV0dXJuOw0KDQogICAgYXBwU3RhdGUuY3VycmVudENoYXRJZCA9IGNoYXRJZDsNCiAgICBjb25zdCBjaGF0SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2hhdC1oaXN0b3J5LWl0ZW0nKTsNCiAgICBjaGF0SXRlbXMuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaWYgKGl0ZW0uZGF0YXNldC5jaGF0SWQgPT09IGNoYXRJZCkgaXRlbS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgZWxzZSBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgIH0pOw0KDQogICAgZWxlbWVudHMuY2hhdE1lc3NhZ2VzICYmIChlbGVtZW50cy5jaGF0TWVzc2FnZXMuaW5uZXJIVE1MID0gJycpOw0KICAgIGlmIChlbGVtZW50cy5wcm9tcHRFZGl0b3IpIGVsZW1lbnRzLnByb21wdEVkaXRvci5pbm5lckhUTUwgPSAnJzsNCiAgICBjbGVhclVwbG9hZGVkRmlsZXMoKTsNCg0KICAgIGNvbnN0IGNoYXQgPSBhcHBTdGF0ZS5jaGF0c1tjaGF0SWRdOw0KICAgIGNvbnN0IHN5c3RlbU1lc3NhZ2VFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgc3lzdGVtTWVzc2FnZUVsZW1lbnQuY2xhc3NOYW1lID0gJ3N5c3RlbS1tZXNzYWdlJzsNCiAgICBzeXN0ZW1NZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGBMb2FkZWQgY29udmVyc2F0aW9uIHdpdGggJHtnZXRNb2RlbExhYmVsKGNoYXQubW9kZWwpfWA7DQogICAgZWxlbWVudHMuY2hhdE1lc3NhZ2VzICYmIGVsZW1lbnRzLmNoYXRNZXNzYWdlcy5hcHBlbmRDaGlsZChzeXN0ZW1NZXNzYWdlRWxlbWVudCk7DQoNCiAgICBjaGF0Lm1lc3NhZ2VzLmZvckVhY2gobWVzc2FnZSA9PiByZW5kZXJNZXNzYWdlKG1lc3NhZ2UpKTsNCiAgICBzY3JvbGxUb0JvdHRvbSgpOw0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVGaWxlVXBsb2FkKGUpIHsNCiAgICBjb25zdCBmaWxlcyA9IGUudGFyZ2V0LmZpbGVzOw0KICAgIGlmICghZmlsZXMgfHwgZmlsZXMubGVuZ3RoID09PSAwKSByZXR1cm47DQoNCiAgICBpZiAoZWxlbWVudHMucHJvbXB0RWRpdG9yKSBlbGVtZW50cy5wcm9tcHRFZGl0b3IuY29udGVudEVkaXRhYmxlID0gImZhbHNlIjsNCiAgICBjb25zdCBsb2FkaW5nSW5kaWNhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgbG9hZGluZ0luZGljYXRvci5jbGFzc05hbWUgPSAnZmlsZS1sb2FkaW5nLWluZGljYXRvcic7DQogICAgbG9hZGluZ0luZGljYXRvci5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1zcGlubmVyIGZhLXNwaW4iPjwvaT4gTG9hZGluZyBmaWxlLi4uJzsNCiAgICBlbGVtZW50cy5maWxlQXR0YWNobWVudHMgJiYgZWxlbWVudHMuZmlsZUF0dGFjaG1lbnRzLmFwcGVuZENoaWxkKGxvYWRpbmdJbmRpY2F0b3IpOw0KDQogICAgbGV0IGZpbGVzUHJvY2Vzc2VkID0gMDsNCiAgICBBcnJheS5mcm9tKGZpbGVzKS5mb3JFYWNoKGZpbGUgPT4gew0KICAgICAgICBpZiAoaXNUZXh0RmlsZShmaWxlKSkgew0KICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7DQogICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkQ29udGVudCA9IGBcblxuRmlsZTogJHtmaWxlLm5hbWV9XG4keyc9Jy5yZXBlYXQoZmlsZS5uYW1lLmxlbmd0aCArIDYpfVxuJHtmaWxlQ29udGVudH1cbiR7Jz0nLnJlcGVhdChmaWxlLm5hbWUubGVuZ3RoICsgNil9XG5cbmA7DQogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRzLnByb21wdEVkaXRvcikgZWxlbWVudHMucHJvbXB0RWRpdG9yLmlubmVySFRNTCArPSBmb3JtYXR0ZWRDb250ZW50LnJlcGxhY2UoL1xuL2csICc8YnI+Jyk7DQogICAgICAgICAgICAgICAgZmlsZXNQcm9jZXNzZWQrKzsNCiAgICAgICAgICAgICAgICBpZiAoZmlsZXNQcm9jZXNzZWQgPT09IGZpbGVzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudHMucHJvbXB0RWRpdG9yKSBlbGVtZW50cy5wcm9tcHRFZGl0b3IuY29udGVudEVkaXRhYmxlID0gInRydWUiOw0KICAgICAgICAgICAgICAgICAgICBsb2FkaW5nSW5kaWNhdG9yLnBhcmVudE5vZGUgJiYgbG9hZGluZ0luZGljYXRvci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxvYWRpbmdJbmRpY2F0b3IpOw0KICAgICAgICAgICAgICAgICAgICBwbGFjZUN1cnNvckF0RW5kKGVsZW1lbnRzLnByb21wdEVkaXRvcik7DQogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRva2VuQ291bnQoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJGaWxlIHJlYWQgZXJyb3I6IiwgZXZlbnQudGFyZ2V0LmVycm9yKTsNCiAgICAgICAgICAgICAgICBhbGVydChgRXJyb3IgcmVhZGluZyBmaWxlOiAke2ZpbGUubmFtZX1gKTsNCiAgICAgICAgICAgICAgICBmaWxlc1Byb2Nlc3NlZCsrOw0KICAgICAgICAgICAgICAgIGlmIChmaWxlc1Byb2Nlc3NlZCA9PT0gZmlsZXMubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cy5wcm9tcHRFZGl0b3IpIGVsZW1lbnRzLnByb21wdEVkaXRvci5jb250ZW50RWRpdGFibGUgPSAidHJ1ZSI7DQogICAgICAgICAgICAgICAgICAgIGxvYWRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZSAmJiBsb2FkaW5nSW5kaWNhdG9yLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobG9hZGluZ0luZGljYXRvcik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgYWxlcnQoYEZpbGUgdHlwZSBub3Qgc3VwcG9ydGVkOiAke2ZpbGUudHlwZX1gKTsNCiAgICAgICAgICAgIGZpbGVzUHJvY2Vzc2VkKys7DQogICAgICAgICAgICBpZiAoZmlsZXNQcm9jZXNzZWQgPT09IGZpbGVzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cy5wcm9tcHRFZGl0b3IpIGVsZW1lbnRzLnByb21wdEVkaXRvci5jb250ZW50RWRpdGFibGUgPSAidHJ1ZSI7DQogICAgICAgICAgICAgICAgbG9hZGluZ0luZGljYXRvci5wYXJlbnROb2RlICYmIGxvYWRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsb2FkaW5nSW5kaWNhdG9yKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQpmdW5jdGlvbiBpc1RleHRGaWxlKGZpbGUpIHsNCiAgICBjb25zdCB0ZXh0VHlwZXMgPSBbDQogICAgICAgICd0ZXh0LycsDQogICAgICAgICdhcHBsaWNhdGlvbi9qc29uJywNCiAgICAgICAgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnLA0KICAgICAgICAnYXBwbGljYXRpb24veG1sJywNCiAgICAgICAgJ2FwcGxpY2F0aW9uL3hodG1sK3htbCcsDQogICAgICAgICdhcHBsaWNhdGlvbi94LXNoJywNCiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtamF2YXNjcmlwdCcsDQogICAgICAgICdhcHBsaWNhdGlvbi94LWh0dHBkLXBocCcsDQogICAgICAgICdhcHBsaWNhdGlvbi94LXB5dGhvbicsDQogICAgICAgICdhcHBsaWNhdGlvbi94LXJ1YnknLA0KICAgICAgICAnYXBwbGljYXRpb24vY3N2Jw0KICAgIF07DQoNCiAgICBjb25zdCB0ZXh0RXh0ZW5zaW9ucyA9IFsNCiAgICAgICAgJy50eHQnLCAnLm1kJywgJy5qcycsICcuaHRtbCcsICcuY3NzJywgJy5weScsICcuc2gnLCAnLmpzb24nLCAnLmNzdicsDQogICAgICAgICcueG1sJywgJy55bWwnLCAnLnlhbWwnLCAnLnRvbWwnLCAnLmluaScsICcuY2ZnJywgJy5jb25mJywgJy5jJywgJy5jcHAnLA0KICAgICAgICAnLmgnLCAnLmphdmEnLCAnLnBocCcsICcucmInLCAnLnBsJywgJy5zcWwnLCAnLnRzJywgJy5qc3gnLCAnLnRzeCcNCiAgICBdOw0KDQogICAgY29uc3QgaXNUZXh0TWltZSA9IGZpbGUudHlwZSAmJiB0ZXh0VHlwZXMuc29tZSh0eXBlID0+IGZpbGUudHlwZS5zdGFydHNXaXRoKHR5cGUpKTsNCiAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGUubmFtZS50b0xvd2VyQ2FzZSgpOw0KICAgIGNvbnN0IGlzVGV4dEV4dCA9IHRleHRFeHRlbnNpb25zLnNvbWUoZXh0ID0+IGZpbGVOYW1lLmVuZHNXaXRoKGV4dCkpOw0KDQogICAgcmV0dXJuIGlzVGV4dE1pbWUgfHwgaXNUZXh0RXh0Ow0KfQ0KDQpmdW5jdGlvbiBhZGRGaWxlQXR0YWNobWVudChmaWxlTmFtZSkgew0KICAgIGlmICghZWxlbWVudHMuZmlsZUF0dGFjaG1lbnRzKSByZXR1cm47DQogICAgY29uc3QgZmlsZUF0dGFjaG1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBmaWxlQXR0YWNobWVudC5jbGFzc05hbWUgPSAnZmlsZS1hdHRhY2htZW50JzsNCiAgICBmaWxlQXR0YWNobWVudC5kYXRhc2V0LmZpbGVOYW1lID0gZmlsZU5hbWU7DQoNCiAgICBjb25zdCBmaWxlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTsNCiAgICBmaWxlSWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLWZpbGUnOw0KDQogICAgY29uc3QgZmlsZU5hbWVTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOw0KICAgIGZpbGVOYW1lU3Bhbi5jbGFzc05hbWUgPSAnZmlsZS1uYW1lJzsNCiAgICBmaWxlTmFtZVNwYW4udGV4dENvbnRlbnQgPSBmaWxlTmFtZTsNCg0KICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTsNCiAgICByZW1vdmVCdXR0b24uY2xhc3NOYW1lID0gJ2ZhcyBmYS10aW1lcyByZW1vdmUtZmlsZSc7DQogICAgcmVtb3ZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVtb3ZlRmlsZUF0dGFjaG1lbnQoZmlsZU5hbWUpKTsNCg0KICAgIGZpbGVBdHRhY2htZW50LmFwcGVuZENoaWxkKGZpbGVJY29uKTsNCiAgICBmaWxlQXR0YWNobWVudC5hcHBlbmRDaGlsZChmaWxlTmFtZVNwYW4pOw0KICAgIGZpbGVBdHRhY2htZW50LmFwcGVuZENoaWxkKHJlbW92ZUJ1dHRvbik7DQoNCiAgICBlbGVtZW50cy5maWxlQXR0YWNobWVudHMuYXBwZW5kQ2hpbGQoZmlsZUF0dGFjaG1lbnQpOw0KfQ0KDQpmdW5jdGlvbiByZW1vdmVGaWxlQXR0YWNobWVudChmaWxlTmFtZSkgew0KICAgIGNvbnN0IGZpbGVBdHRhY2htZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmZpbGUtYXR0YWNobWVudFtkYXRhLWZpbGUtbmFtZT0iJHtmaWxlTmFtZX0iXWApOw0KICAgIGlmIChmaWxlQXR0YWNobWVudCkgZmlsZUF0dGFjaG1lbnQucmVtb3ZlKCk7DQoNCiAgICBhcHBTdGF0ZS51cGxvYWRlZEZpbGVzID0gYXBwU3RhdGUudXBsb2FkZWRGaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlLm5hbWUgIT09IGZpbGVOYW1lKTsNCiAgICB1cGRhdGVUb2tlbkNvdW50KCk7DQp9DQoNCmZ1bmN0aW9uIGNsZWFyVXBsb2FkZWRGaWxlcygpIHsNCiAgICBpZiAoZWxlbWVudHMuZmlsZUF0dGFjaG1lbnRzKSBlbGVtZW50cy5maWxlQXR0YWNobWVudHMuaW5uZXJIVE1MID0gJyc7DQogICAgYXBwU3RhdGUudXBsb2FkZWRGaWxlcyA9IFtdOw0KICAgIHVwZGF0ZVRva2VuQ291bnQoKTsNCn0NCg0KZnVuY3Rpb24gZm9ybWF0RmlsZUNvbnRlbnRzKCkgew0KICAgIGlmIChhcHBTdGF0ZS51cGxvYWRlZEZpbGVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcnOw0KICAgIGxldCBmb3JtYXR0ZWRDb250ZW50ID0gJy0tLSBGaWxlIEF0dGFjaG1lbnRzIC0tLVxuXG4nOw0KICAgIGFwcFN0YXRlLnVwbG9hZGVkRmlsZXMuZm9yRWFjaCgoZmlsZSwgaW5kZXgpID0+IHsNCiAgICAgICAgZm9ybWF0dGVkQ29udGVudCArPSBgRklMRSAke2luZGV4ICsgMX06ICR7ZmlsZS5uYW1lfVxuJHsnPScucmVwZWF0KDIwKX1cbiR7ZmlsZS5jb250ZW50fVxuJHsnPScucmVwZWF0KDIwKX1cblxuYDsNCiAgICB9KTsNCiAgICBmb3JtYXR0ZWRDb250ZW50ICs9ICctLS0gRW5kIG9mIEZpbGUgQXR0YWNobWVudHMgLS0tXG5cbic7DQogICAgcmV0dXJuIGZvcm1hdHRlZENvbnRlbnQ7DQp9DQoNCmFzeW5jIGZ1bmN0aW9uIHNlbmRNZXNzYWdlKCkgew0KICAgIGNvbnN0IHByb21wdFRleHQgPSBlbGVtZW50cy5wcm9tcHRFZGl0b3IgPyBlbGVtZW50cy5wcm9tcHRFZGl0b3IuaW5uZXJUZXh0LnRyaW0oKSA6ICcnOw0KICAgIGlmIChwcm9tcHRUZXh0ID09PSAnJykgcmV0dXJuOw0KDQogICAgY29uc3QgdXNlck1lc3NhZ2UgPSB7DQogICAgICAgIHJvbGU6ICd1c2VyJywNCiAgICAgICAgY29udGVudDogcHJvbXB0VGV4dCwNCiAgICB9Ow0KDQogICAgYXBwU3RhdGUuY2hhdHNbYXBwU3RhdGUuY3VycmVudENoYXRJZF0ubWVzc2FnZXMucHVzaCh1c2VyTWVzc2FnZSk7DQogICAgcmVuZGVyTWVzc2FnZSh1c2VyTWVzc2FnZSk7DQoNCiAgICBpZiAoZWxlbWVudHMucHJvbXB0RWRpdG9yKSBlbGVtZW50cy5wcm9tcHRFZGl0b3IuaW5uZXJIVE1MID0gJyc7DQoNCiAgICBjb25zdCB3YWl0aW5nSW5kaWNhdG9yID0gYWRkV2FpdGluZ0luZGljYXRvcigpOw0KICAgIGNhbGxBcGkod2FpdGluZ0luZGljYXRvcik7DQp9DQoNCmZ1bmN0aW9uIGFkZFdhaXRpbmdJbmRpY2F0b3IoKSB7DQogICAgY29uc3Qgd2FpdGluZ0luZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHdhaXRpbmdJbmRpY2F0b3IuY2xhc3NOYW1lID0gJ3dhaXRpbmctaW5kaWNhdG9yJzsNCiAgICB3YWl0aW5nSW5kaWNhdG9yLmlubmVySFRNTCA9IGANCiAgICAgICAgPGRpdiBjbGFzcz0idHlwaW5nLWluZGljYXRvciBtZS0yIj4NCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0eXBpbmctZG90Ij48L3NwYW4+DQogICAgICAgICAgICA8c3BhbiBjbGFzcz0idHlwaW5nLWRvdCI+PC9zcGFuPg0KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InR5cGluZy1kb3QiPjwvc3Bhbj4NCiAgICAgICAgPC9kaXY+DQogICAgICAgIDxzcGFuPldhaXRpbmcgZm9yIHJlc3BvbnNlLi4uPC9zcGFuPg0KICAgIGA7DQogICAgZWxlbWVudHMuY2hhdE1lc3NhZ2VzICYmIGVsZW1lbnRzLmNoYXRNZXNzYWdlcy5hcHBlbmRDaGlsZCh3YWl0aW5nSW5kaWNhdG9yKTsNCiAgICBzY3JvbGxUb0JvdHRvbSgpOw0KICAgIHJldHVybiB3YWl0aW5nSW5kaWNhdG9yOw0KfQ0KDQpmdW5jdGlvbiByZW5kZXJNZXNzYWdlKG1lc3NhZ2UpIHsNCiAgICBpZiAoIWVsZW1lbnRzLmNoYXRNZXNzYWdlcykgcmV0dXJuIG51bGw7DQogICAgY29uc3QgbWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBtZXNzYWdlRWxlbWVudC5jbGFzc05hbWUgPSBgY2hhdC1idWJibGUgJHttZXNzYWdlLnJvbGUgPT09ICd1c2VyJyA/ICd1c2VyLWJ1YmJsZScgOiAnYXNzaXN0YW50LWJ1YmJsZSd9YDsNCiAgICBtZXNzYWdlRWxlbWVudC5kYXRhc2V0Lm1lc3NhZ2VJZCA9IG1lc3NhZ2UudGltZXN0YW1wOw0KICAgIG1lc3NhZ2VFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1hb3MnLCAnZmFkZS11cCcpOw0KDQogICAgbGV0IGNvbnRlbnRIVE1MID0gJyc7DQoNCiAgICBpZiAobWVzc2FnZS5yb2xlID09PSAndXNlcicpIHsNCiAgICAgICAgY29udGVudEhUTUwgPSBgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJidWJibGUtYWN0aW9ucyI+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkgY29weS1idG4iIHRpdGxlPSJDb3B5IG1lc3NhZ2UiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNvcHkiPjwvaT4NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSBlZGl0LWJ0biIgdGl0bGU9IkVkaXQgbWVzc2FnZSI+DQogICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZWRpdCI+PC9pPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJtZXNzYWdlLWNvbnRlbnQiPiR7bWVzc2FnZS5jb250ZW50LnJlcGxhY2UoL1xuL2csICc8YnI+Jyl9PC9kaXY+DQogICAgICAgIGA7DQogICAgfSBlbHNlIHsNCiAgICAgICAgY29udGVudEhUTUwgPSBgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJidWJibGUtYWN0aW9ucyI+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkgY29weS1idG4iIHRpdGxlPSJDb3B5IG1lc3NhZ2UiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWNvcHkiPjwvaT4NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSByZWdlbmVyYXRlLWJ0biIgdGl0bGU9IlJlZ2VuZXJhdGUgcmVzcG9uc2UiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXJlZG8tYWx0Ij48L2k+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1hcmtkb3duLWNvbnRlbnQiPiR7bWFya2VkLnBhcnNlKG1lc3NhZ2UuY29udGVudCB8fCAnJyl9PC9kaXY+DQogICAgICAgIGA7DQogICAgfQ0KDQogICAgbWVzc2FnZUVsZW1lbnQuaW5uZXJIVE1MID0gY29udGVudEhUTUw7DQoNCiAgICBpZiAobWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50Jykgew0KICAgICAgICBtZXNzYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdwcmUgY29kZScpLmZvckVhY2goYmxvY2sgPT4geyB0cnkgeyBobGpzLmhpZ2hsaWdodEVsZW1lbnQoYmxvY2spOyB9IGNhdGNoIChlKSB7IH0gfSk7DQogICAgfQ0KDQogICAgY29uc3QgY29weUJ0biA9IG1lc3NhZ2VFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb3B5LWJ0bicpOw0KICAgIGlmIChjb3B5QnRuKSB7DQogICAgICAgIGNvcHlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IGNvcHlNZXNzYWdlQ29udGVudChtZXNzYWdlLmNvbnRlbnQpOyBjb3B5QnRuLmNsYXNzTGlzdC5hZGQoJ2NvcHktZmVlZGJhY2snKTsgc2V0VGltZW91dCgoKSA9PiBjb3B5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2NvcHktZmVlZGJhY2snKSwgMzAwKTsgfSk7DQogICAgfQ0KDQogICAgaWYgKG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKSB7DQogICAgICAgIGNvbnN0IGVkaXRCdG4gPSBtZXNzYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWRpdC1idG4nKTsNCiAgICAgICAgaWYgKGVkaXRCdG4pIGVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBlZGl0VXNlck1lc3NhZ2UobWVzc2FnZUVsZW1lbnQsIG1lc3NhZ2UpKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBjb25zdCByZWdlbmVyYXRlQnRuID0gbWVzc2FnZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnJlZ2VuZXJhdGUtYnRuJyk7DQogICAgICAgIGlmIChyZWdlbmVyYXRlQnRuKSByZWdlbmVyYXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnZW5lcmF0ZVJlc3BvbnNlKG1lc3NhZ2UpKTsNCiAgICB9DQoNCiAgICBlbGVtZW50cy5jaGF0TWVzc2FnZXMuYXBwZW5kQ2hpbGQobWVzc2FnZUVsZW1lbnQpOw0KICAgIHNjcm9sbFRvQm90dG9tKCk7DQogICAgcmV0dXJuIG1lc3NhZ2VFbGVtZW50Ow0KfQ0KDQpmdW5jdGlvbiBjb3B5TWVzc2FnZUNvbnRlbnQoY29udGVudCkgew0KICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGNvbnRlbnQpLnRoZW4oKCkgPT4gY29uc29sZS5sb2coJ0NvbnRlbnQgY29waWVkJykpLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKCdDb3B5IGZhaWxlZCcsIGVycikpOw0KfQ0KDQpmdW5jdGlvbiBlZGl0VXNlck1lc3NhZ2UobWVzc2FnZUVsZW1lbnQsIG1lc3NhZ2UpIHsNCiAgICBtZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlZGl0LW1vZGUnKTsNCiAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IG1lc3NhZ2VFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlLWNvbnRlbnQnKTsNCiAgICBjb25zdCBvcmlnaW5hbENvbnRlbnQgPSBtZXNzYWdlLmNvbnRlbnQ7DQoNCiAgICBjb250ZW50RWxlbWVudC5pbm5lckhUTUwgPSBgDQogICAgICAgIDxkaXYgY29udGVudGVkaXRhYmxlPSJ0cnVlIiBjbGFzcz0iZWRpdC1jb250ZW50IHByb21wdEVkaXRvciI+JHtvcmlnaW5hbENvbnRlbnQucmVwbGFjZSgvXG4vZywgJzxicj4nKX08L2Rpdj4NCiAgICAgICAgPGRpdiBjbGFzcz0iZWRpdC1hY3Rpb25zIj4NCiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IGNhbmNlbC1lZGl0LWJ0biI+Q2FuY2VsPC9idXR0b24+DQogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IHNhdmUtZWRpdC1idG4iPlNhdmUgJiBSZWdlbmVyYXRlPC9idXR0b24+DQogICAgICAgIDwvZGl2Pg0KICAgIGA7DQoNCiAgICBjb25zdCBlZGl0YWJsZUFyZWEgPSBjb250ZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWRpdC1jb250ZW50Jyk7DQogICAgZWRpdGFibGVBcmVhLmZvY3VzKCk7DQoNCiAgICBjb25zdCBjYW5jZWxCdG4gPSBjb250ZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FuY2VsLWVkaXQtYnRuJyk7DQogICAgY29uc3Qgc2F2ZUJ0biA9IGNvbnRlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zYXZlLWVkaXQtYnRuJyk7DQoNCiAgICBjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IG1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2VkaXQtbW9kZScpOyBjb250ZW50RWxlbWVudC5pbm5lckhUTUwgPSBvcmlnaW5hbENvbnRlbnQucmVwbGFjZSgvXG4vZywgJzxicj4nKTsgfSk7DQoNCiAgICBzYXZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgICBjb25zdCBlZGl0ZWRDb250ZW50ID0gZWRpdGFibGVBcmVhLmlubmVyVGV4dC50cmltKCk7DQogICAgICAgIG1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2VkaXQtbW9kZScpOw0KICAgICAgICBjb250ZW50RWxlbWVudC5pbm5lckhUTUwgPSBlZGl0ZWRDb250ZW50LnJlcGxhY2UoL1xuL2csICc8YnI+Jyk7DQoNCiAgICAgICAgLy8gdXBkYXRlIG1lc3NhZ2UgaW4gc3RhdGUNCiAgICAgICAgY29uc3QgY3VycmVudENoYXQgPSBhcHBTdGF0ZS5jaGF0c1thcHBTdGF0ZS5jdXJyZW50Q2hhdElkXTsNCiAgICAgICAgY29uc3QgbXNnSW5kZXggPSBjdXJyZW50Q2hhdC5tZXNzYWdlcy5maW5kSW5kZXgobSA9PiBtLnRpbWVzdGFtcCA9PT0gbWVzc2FnZS50aW1lc3RhbXApOw0KICAgICAgICBpZiAobXNnSW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICBjdXJyZW50Q2hhdC5tZXNzYWdlc1ttc2dJbmRleF0uY29udGVudCA9IGVkaXRlZENvbnRlbnQ7DQogICAgICAgICAgICBjdXJyZW50Q2hhdC5tZXNzYWdlc1ttc2dJbmRleF0udGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpOw0KICAgICAgICAgICAgLy8gcmVtb3ZlIHN1YnNlcXVlbnQgbWVzc2FnZXMNCiAgICAgICAgICAgIGN1cnJlbnRDaGF0Lm1lc3NhZ2VzID0gY3VycmVudENoYXQubWVzc2FnZXMuc2xpY2UoMCwgbXNnSW5kZXggKyAxKTsNCiAgICAgICAgICAgIC8vIHJlbW92ZSBzdWJzZXF1ZW50IG1lc3NhZ2UgZWxlbWVudHMgZnJvbSBVSQ0KICAgICAgICAgICAgY29uc3QgYWxsTWVzc2FnZUVsZW1lbnRzID0gQXJyYXkuZnJvbShlbGVtZW50cy5jaGF0TWVzc2FnZXMucXVlcnlTZWxlY3RvckFsbCgnLmNoYXQtYnViYmxlJykpOw0KICAgICAgICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gYWxsTWVzc2FnZUVsZW1lbnRzLmluZGV4T2YobWVzc2FnZUVsZW1lbnQpOw0KICAgICAgICAgICAgYWxsTWVzc2FnZUVsZW1lbnRzLnNsaWNlKGN1cnJlbnRJbmRleCArIDEpLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlKCkpOw0KICAgICAgICAgICAgY29uc3Qgd2FpdGluZ0luZGljYXRvciA9IGFkZFdhaXRpbmdJbmRpY2F0b3IoKTsNCiAgICAgICAgICAgIGNhbGxBcGkod2FpdGluZ0luZGljYXRvcik7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gcmVnZW5lcmF0ZVJlc3BvbnNlKGFmdGVyTWVzc2FnZSkgew0KICAgIGNvbnN0IGN1cnJlbnRDaGF0ID0gYXBwU3RhdGUuY2hhdHNbYXBwU3RhdGUuY3VycmVudENoYXRJZF07DQogICAgY29uc3QgbWVzc2FnZUluZGV4ID0gY3VycmVudENoYXQubWVzc2FnZXMuZmluZEluZGV4KG1zZyA9PiBtc2cudGltZXN0YW1wID09PSBhZnRlck1lc3NhZ2UudGltZXN0YW1wKTsNCiAgICBpZiAobWVzc2FnZUluZGV4ICE9PSAtMSkgew0KICAgICAgICBsZXQgbGFzdFVzZXJNZXNzYWdlSW5kZXggPSBtZXNzYWdlSW5kZXggLSAxOw0KICAgICAgICB3aGlsZSAobGFzdFVzZXJNZXNzYWdlSW5kZXggPj0gMCAmJiBjdXJyZW50Q2hhdC5tZXNzYWdlc1tsYXN0VXNlck1lc3NhZ2VJbmRleF0ucm9sZSAhPT0gJ3VzZXInKSBsYXN0VXNlck1lc3NhZ2VJbmRleC0tOw0KICAgICAgICBpZiAobGFzdFVzZXJNZXNzYWdlSW5kZXggPj0gMCkgew0KICAgICAgICAgICAgY3VycmVudENoYXQubWVzc2FnZXMgPSBjdXJyZW50Q2hhdC5tZXNzYWdlcy5zbGljZSgwLCBsYXN0VXNlck1lc3NhZ2VJbmRleCArIDEpOw0KICAgICAgICAgICAgY29uc3QgYWxsTWVzc2FnZUVsZW1lbnRzID0gQXJyYXkuZnJvbShlbGVtZW50cy5jaGF0TWVzc2FnZXMucXVlcnlTZWxlY3RvckFsbCgnLmNoYXQtYnViYmxlJykpOw0KICAgICAgICAgICAgZm9yIChsZXQgaSA9IG1lc3NhZ2VJbmRleDsgaSA8IGFsbE1lc3NhZ2VFbGVtZW50cy5sZW5ndGg7IGkrKykgYWxsTWVzc2FnZUVsZW1lbnRzW2ldLnJlbW92ZSgpOw0KICAgICAgICAgICAgY29uc3Qgd2FpdGluZ0luZGljYXRvciA9IGFkZFdhaXRpbmdJbmRpY2F0b3IoKTsNCiAgICAgICAgICAgIGNhbGxBcGkod2FpdGluZ0luZGljYXRvcik7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vIEFQSSBjYWxsIOKAlCBsb2NrZWQgdG8gc2luZ2xlIG1vZGVsIGFuZCBOTyBmYWxsYmFja3MNCmFzeW5jIGZ1bmN0aW9uIGNhbGxBcGkod2FpdGluZ0luZGljYXRvcikgew0KICAgIHRyeSB7DQogICAgICAgIGlmIChhcHBTdGF0ZS5jdXJyZW50bHlTdHJlYW1pbmcgJiYgYXBwU3RhdGUuc3RyZWFtQ29udHJvbGxlcikgYXBwU3RhdGUuc3RyZWFtQ29udHJvbGxlci5hYm9ydCgpOw0KDQogICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gKGFwcFN0YXRlLmNoYXRzW2FwcFN0YXRlLmN1cnJlbnRDaGF0SWRdLm1lc3NhZ2VzIHx8IFtdKS5tYXAobXNnID0+ICh7IHJvbGU6IG1zZy5yb2xlLCBjb250ZW50OiBtc2cuY29udGVudCB9KSk7DQoNCiAgICAgICAgY29uc3QgcmVxdWVzdFBheWxvYWQgPSB7DQogICAgICAgICAgICBtb2RlbDogYXBwU3RhdGUuc2VsZWN0ZWRNb2RlbCwNCiAgICAgICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlcywNCiAgICAgICAgICAgIHN0cmVhbTogYXBwU3RhdGUuc2V0dGluZ3Muc3RyZWFtaW5nDQogICAgICAgIH07DQoNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnRlbXBlcmF0dXJlICE9PSAxLjApIHJlcXVlc3RQYXlsb2FkLnRlbXBlcmF0dXJlID0gYXBwU3RhdGUuc2V0dGluZ3MudGVtcGVyYXR1cmU7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy50b3BQICE9PSAxLjApIHJlcXVlc3RQYXlsb2FkLnRvcF9wID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wUDsNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnRvcEsgIT09IDApIHJlcXVlc3RQYXlsb2FkLnRvcF9rID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wSzsNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLmZyZXF1ZW5jeVBlbmFsdHkgIT09IDAuMCkgcmVxdWVzdFBheWxvYWQuZnJlcXVlbmN5X3BlbmFsdHkgPSBhcHBTdGF0ZS5zZXR0aW5ncy5mcmVxdWVuY3lQZW5hbHR5Ow0KICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5ICE9PSAwLjApIHJlcXVlc3RQYXlsb2FkLnByZXNlbmNlX3BlbmFsdHkgPSBhcHBTdGF0ZS5zZXR0aW5ncy5wcmVzZW5jZVBlbmFsdHk7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5yZXBldGl0aW9uUGVuYWx0eSAhPT0gMS4wKSByZXF1ZXN0UGF5bG9hZC5yZXBldGl0aW9uX3BlbmFsdHkgPSBhcHBTdGF0ZS5zZXR0aW5ncy5yZXBldGl0aW9uUGVuYWx0eTsNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLm1pblAgIT09IDAuMCkgcmVxdWVzdFBheWxvYWQubWluX3AgPSBhcHBTdGF0ZS5zZXR0aW5ncy5taW5QOw0KICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3MudG9wQSAhPT0gMC4wKSByZXF1ZXN0UGF5bG9hZC50b3BfYSA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcEE7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5zZWVkICE9PSBudWxsKSByZXF1ZXN0UGF5bG9hZC5zZWVkID0gYXBwU3RhdGUuc2V0dGluZ3Muc2VlZDsNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLm1heFRva2VucyAhPT0gbnVsbCkgcmVxdWVzdFBheWxvYWQubWF4X3Rva2VucyA9IGFwcFN0YXRlLnNldHRpbmdzLm1heFRva2VuczsNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLmxvZ3Byb2JzKSByZXF1ZXN0UGF5bG9hZC5sb2dwcm9icyA9IHRydWU7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy50b3BMb2dwcm9icyAhPT0gbnVsbCkgcmVxdWVzdFBheWxvYWQudG9wX2xvZ3Byb2JzID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wTG9ncHJvYnM7DQoNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5lZmZvcnQgfHwgYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLm1heFRva2VucyB8fCBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcuZXhjbHVkZSkgew0KICAgICAgICAgICAgcmVxdWVzdFBheWxvYWQucmVhc29uaW5nID0ge307DQogICAgICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLmVmZm9ydCkgcmVxdWVzdFBheWxvYWQucmVhc29uaW5nLmVmZm9ydCA9IGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5lZmZvcnQ7DQogICAgICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLm1heFRva2VucykgcmVxdWVzdFBheWxvYWQucmVhc29uaW5nLm1heF90b2tlbnMgPSBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcubWF4VG9rZW5zOw0KICAgICAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5leGNsdWRlKSByZXF1ZXN0UGF5bG9hZC5yZWFzb25pbmcuZXhjbHVkZSA9IHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICBjb25zb2xlLmxvZygiU2VuZGluZyBBUEkgcmVxdWVzdCB3aXRoIHBheWxvYWQ6IiwgcmVxdWVzdFBheWxvYWQpOw0KDQogICAgICAgIGFwcFN0YXRlLnN0cmVhbUNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7DQogICAgICAgIGNvbnN0IHNpZ25hbCA9IGFwcFN0YXRlLnN0cmVhbUNvbnRyb2xsZXIuc2lnbmFsOw0KICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpOw0KDQogICAgICAgIC8vIEVuc3VyZSBBdXRob3JpemF0aW9uIGhlYWRlciB1c2VzIHN0b3JlZCBBUEkga2V5IChtYXkgYmUgZW1wdHkpDQogICAgICAgIGNvbnN0IGF1dGhIZWFkZXIgPSBhcHBTdGF0ZS5hcGlLZXkgPyBgQmVhcmVyICR7YXBwU3RhdGUuYXBpS2V5fWAgOiAnJzsNCg0KICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3Muc3RyZWFtaW5nKSB7DQogICAgICAgICAgICBhcHBTdGF0ZS5jdXJyZW50bHlTdHJlYW1pbmcgPSB0cnVlOw0KDQogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5jZXJlYnJhcy5haS92MS9jaGF0L2NvbXBsZXRpb25zJywgew0KICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLA0KICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywNCiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhdXRoSGVhZGVyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0UGF5bG9hZCksDQogICAgICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7DQogICAgICAgICAgICAgICAgbGV0IGVycm9yRGF0YSA9IHt9Ow0KICAgICAgICAgICAgICAgIHRyeSB7IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsgfSBjYXRjaCAoZSkgeyB9DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yRGF0YS5lcnJvcj8ubWVzc2FnZSB8fCBgSFRUUCBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGNvbnN0IGFzc2lzdGFudE1lc3NhZ2UgPSB7DQogICAgICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsDQogICAgICAgICAgICAgICAgY29udGVudDogJycsDQogICAgICAgICAgICAgICAgbW9kZWw6IGFwcFN0YXRlLnNlbGVjdGVkTW9kZWwsDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksDQogICAgICAgICAgICAgICAgcHJvY2Vzc2luZ1RpbWU6IDAsDQogICAgICAgICAgICAgICAgdXNhZ2U6IHt9DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICB3YWl0aW5nSW5kaWNhdG9yICYmIHdhaXRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZSAmJiB3YWl0aW5nSW5kaWNhdG9yLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQod2FpdGluZ0luZGljYXRvcik7DQogICAgICAgICAgICBhcHBTdGF0ZS5jaGF0c1thcHBTdGF0ZS5jdXJyZW50Q2hhdElkXS5tZXNzYWdlcy5wdXNoKGFzc2lzdGFudE1lc3NhZ2UpOw0KICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJ1YmJsZSA9IHJlbmRlck1lc3NhZ2UoYXNzaXN0YW50TWVzc2FnZSk7DQogICAgICAgICAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IG1lc3NhZ2VCdWJibGUgPyBtZXNzYWdlQnViYmxlLnF1ZXJ5U2VsZWN0b3IoJy5tYXJrZG93bi1jb250ZW50JykgOiBudWxsOw0KDQogICAgICAgICAgICBjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5LmdldFJlYWRlcigpOw0KICAgICAgICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigndXRmLTgnKTsNCiAgICAgICAgICAgIGxldCBidWZmZXIgPSAnJzsNCg0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZG9uZSkgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7DQogICAgICAgICAgICAgICAgICAgIGxldCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgICAgICAgYnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7DQoNCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0cmltbWVkTGluZSB8fCB0cmltbWVkTGluZSA9PT0gJ2RhdGE6IFtET05FXScgfHwgdHJpbW1lZExpbmUuc3RhcnRzV2l0aCgnOicpKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cmltbWVkTGluZS5zdGFydHNXaXRoKCdkYXRhOiAnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0cmltbWVkTGluZS5zbGljZSg2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWREYXRhID0gSlNPTi5wYXJzZShkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudERlbHRhID0gcGFyc2VkRGF0YS5jaG9pY2VzWzBdPy5kZWx0YT8uY29udGVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnREZWx0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaXN0YW50TWVzc2FnZS5jb250ZW50ICs9IGNvbnRlbnREZWx0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50RWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmlubmVySFRNTCA9IG1hcmtlZC5wYXJzZShhc3Npc3RhbnRNZXNzYWdlLmNvbnRlbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3ByZSBjb2RlJykuZm9yRWFjaChibG9jayA9PiB7IHRyeSB7IGhsanMuaGlnaGxpZ2h0RWxlbWVudChibG9jayk7IH0gY2F0Y2ggKGUpIHsgfSB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3Npc3RhbnRNZXNzYWdlLmNvbnRlbnQubGVuZ3RoICUgNSA9PT0gMCkgZm9yY2VTY3JvbGxUb0JvdHRvbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZWREYXRhLmNob2ljZXNbMF0/LmZpbmlzaF9yZWFzb24pIGFzc2lzdGFudE1lc3NhZ2UuZmluaXNoX3JlYXNvbiA9IHBhcnNlZERhdGEuY2hvaWNlc1swXS5maW5pc2hfcmVhc29uOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VkRGF0YS51c2FnZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaXN0YW50TWVzc2FnZS51c2FnZSA9IHBhcnNlZERhdGEudXNhZ2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VkRGF0YS51c2FnZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lzdGFudE1lc3NhZ2UudXNhZ2UgPSBwYXJzZWREYXRhLnVzYWdlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIHN0cmVhbSBkYXRhOicsIGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGZvcmNlU2Nyb2xsVG9Cb3R0b20oKTsNCiAgICAgICAgICAgICAgICBwbGF5U291bmRTYWZlbHkoZWxlbWVudHMubWVzc2FnZVJlY2VpdmVkU291bmQpOw0KICAgICAgICAgICAgfSBjYXRjaCAoc3RyZWFtRXJyb3IpIHsNCiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtRXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSBjb25zb2xlLmxvZygnU3RyZWFtIGNhbmNlbGxlZCcpOyBlbHNlIHRocm93IHN0cmVhbUVycm9yOw0KICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICBhcHBTdGF0ZS5jdXJyZW50bHlTdHJlYW1pbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuY2VyZWJyYXMuYWkvdjEvY2hhdC9jb21wbGV0aW9ucycsIHsNCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywNCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsDQogICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYXV0aEhlYWRlcg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdFBheWxvYWQpDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgew0KICAgICAgICAgICAgICAgIGxldCBlcnJvckRhdGEgPSB7fTsNCiAgICAgICAgICAgICAgICB0cnkgeyBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7IH0gY2F0Y2ggKGUpIHsgfQ0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckRhdGEuZXJyb3I/Lm1lc3NhZ2UgfHwgYEhUVFAgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7DQogICAgICAgICAgICBjb25zdCBhc3Npc3RhbnRNZXNzYWdlID0gew0KICAgICAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLA0KICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHJlc3BvbnNlRGF0YS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnLA0KICAgICAgICAgICAgICAgIG1vZGVsOiByZXNwb25zZURhdGEubW9kZWwgfHwgYXBwU3RhdGUuc2VsZWN0ZWRNb2RlbCwNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwNCiAgICAgICAgICAgICAgICBwcm9jZXNzaW5nVGltZTogKERhdGUubm93KCkgLSBzdGFydFRpbWUpIC8gMTAwMCwNCiAgICAgICAgICAgICAgICB1c2FnZTogcmVzcG9uc2VEYXRhLnVzYWdlIHx8IHt9DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICB3YWl0aW5nSW5kaWNhdG9yICYmIHdhaXRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZSAmJiB3YWl0aW5nSW5kaWNhdG9yLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQod2FpdGluZ0luZGljYXRvcik7DQogICAgICAgICAgICBhcHBTdGF0ZS5jaGF0c1thcHBTdGF0ZS5jdXJyZW50Q2hhdElkXS5tZXNzYWdlcy5wdXNoKGFzc2lzdGFudE1lc3NhZ2UpOw0KICAgICAgICAgICAgcmVuZGVyTWVzc2FnZShhc3Npc3RhbnRNZXNzYWdlKTsNCiAgICAgICAgICAgIGZvcmNlU2Nyb2xsVG9Cb3R0b20oKTsNCiAgICAgICAgICAgIHBsYXlTb3VuZFNhZmVseShlbGVtZW50cy5tZXNzYWdlUmVjZWl2ZWRTb3VuZCk7DQogICAgICAgIH0NCg0KICAgICAgICBzYXZlQXBwU3RhdGUoKTsNCg0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcik7DQogICAgICAgIHdhaXRpbmdJbmRpY2F0b3IgJiYgd2FpdGluZ0luZGljYXRvci5wYXJlbnROb2RlICYmIHdhaXRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh3YWl0aW5nSW5kaWNhdG9yKTsNCg0KICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTmFtZSA9ICdlcnJvci1tZXNzYWdlJzsNCiAgICAgICAgZXJyb3JFbGVtZW50LmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlbiBhbGlnbi1pdGVtcy1zdGFydCI+XG4gICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi1jaXJjbGUgbWUtMiI+PC9pPlxuICAgICAgICAgICAgICAgICAgICA8c3Ryb25nPkVycm9yOjwvc3Ryb25nPiAke2Vycm9yLm1lc3NhZ2UgfHwgJ1NvbWV0aGluZyB3ZW50IHdyb25nJ31cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1kYW5nZXIgcmV0cnktYnRuIj5cbiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1yZWRvLWFsdCBtZS0xIj48L2k+IFJldHJ5XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDsNCiAgICAgICAgZWxlbWVudHMuY2hhdE1lc3NhZ2VzICYmIGVsZW1lbnRzLmNoYXRNZXNzYWdlcy5hcHBlbmRDaGlsZChlcnJvckVsZW1lbnQpOw0KDQogICAgICAgIGNvbnN0IHJldHJ5QnRuID0gZXJyb3JFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXRyeS1idG4nKTsNCiAgICAgICAgaWYgKHJldHJ5QnRuKSByZXRyeUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgICAgIGVycm9yRWxlbWVudC5wYXJlbnROb2RlICYmIGVycm9yRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVycm9yRWxlbWVudCk7DQogICAgICAgICAgICBjb25zdCBuZXdXYWl0aW5nSW5kaWNhdG9yID0gYWRkV2FpdGluZ0luZGljYXRvcigpOw0KICAgICAgICAgICAgY2FsbEFwaShuZXdXYWl0aW5nSW5kaWNhdG9yKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgcGxheVNvdW5kU2FmZWx5KGVsZW1lbnRzLmVycm9yU291bmQpOw0KICAgICAgICBmb3JjZVNjcm9sbFRvQm90dG9tKCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVQcm9tcHRLZXlkb3duKGV2ZW50KSB7DQogICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAhZXZlbnQuc2hpZnRLZXkpIHsNCiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgc2VuZE1lc3NhZ2UoKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGV4cG9ydENoYXQoKSB7DQogICAgaWYgKCFhcHBTdGF0ZS5jdXJyZW50Q2hhdElkKSByZXR1cm47DQogICAgY29uc3QgY3VycmVudENoYXQgPSBhcHBTdGF0ZS5jaGF0c1thcHBTdGF0ZS5jdXJyZW50Q2hhdElkXTsNCiAgICBjb25zdCBjaGF0RGF0YSA9IEpTT04uc3RyaW5naWZ5KGN1cnJlbnRDaGF0LCBudWxsLCAyKTsNCiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NoYXREYXRhXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vanNvbicgfSk7DQogICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsNCiAgICBjb25zdCBkb3dubG9hZExpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7DQogICAgZG93bmxvYWRMaW5rLmhyZWYgPSB1cmw7DQogICAgZG93bmxvYWRMaW5rLmRvd25sb2FkID0gYGNoYXRfZXhwb3J0XyR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2UoLzovZywgJy0nKX0uanNvbmA7DQogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkb3dubG9hZExpbmspOw0KICAgIGRvd25sb2FkTGluay5jbGljaygpOw0KICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZG93bmxvYWRMaW5rKTsNCiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7DQp9DQoNCmZ1bmN0aW9uIGhhbmRsZUltcG9ydENoYXQoZXZlbnQpIHsNCiAgICBjb25zdCBmaWxlID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdOw0KICAgIGlmICghZmlsZSkgcmV0dXJuOw0KICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBpbXBvcnRlZENoYXQgPSBKU09OLnBhcnNlKGUudGFyZ2V0LnJlc3VsdCk7DQogICAgICAgICAgICBpZiAoIWltcG9ydGVkQ2hhdC5pZCB8fCAhaW1wb3J0ZWRDaGF0Lm1lc3NhZ2VzIHx8ICFBcnJheS5pc0FycmF5KGltcG9ydGVkQ2hhdC5tZXNzYWdlcykpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjaGF0IGZvcm1hdCcpOw0KICAgICAgICAgICAgY29uc3QgbmV3Q2hhdElkID0gJ2NoYXRfJyArIERhdGUubm93KCk7DQogICAgICAgICAgICBpbXBvcnRlZENoYXQuaWQgPSBuZXdDaGF0SWQ7DQogICAgICAgICAgICBhcHBTdGF0ZS5jaGF0c1tuZXdDaGF0SWRdID0gaW1wb3J0ZWRDaGF0Ow0KICAgICAgICAgICAgc2F2ZUFwcFN0YXRlKCk7DQogICAgICAgICAgICBsb2FkQ2hhdChuZXdDaGF0SWQpOw0KICAgICAgICAgICAgY29uc3Qgc3lzdGVtTWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgICAgIHN5c3RlbU1lc3NhZ2VFbGVtZW50LmNsYXNzTmFtZSA9ICdzeXN0ZW0tbWVzc2FnZSc7DQogICAgICAgICAgICBzeXN0ZW1NZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9ICdDaGF0IGltcG9ydGVkIHN1Y2Nlc3NmdWxseSc7DQogICAgICAgICAgICBlbGVtZW50cy5jaGF0TWVzc2FnZXMgJiYgZWxlbWVudHMuY2hhdE1lc3NhZ2VzLmFwcGVuZENoaWxkKHN5c3RlbU1lc3NhZ2VFbGVtZW50KTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGltcG9ydGluZyBjaGF0OicsIGVycm9yKTsNCiAgICAgICAgICAgIGFsZXJ0KCdFcnJvciBpbXBvcnRpbmcgY2hhdDogJyArIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICB9DQogICAgfTsNCiAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsNCn0NCg0KZnVuY3Rpb24gZGVsZXRlQ3VycmVudENoYXQoKSB7DQogICAgaWYgKCFhcHBTdGF0ZS5jdXJyZW50Q2hhdElkIHx8IE9iamVjdC5rZXlzKGFwcFN0YXRlLmNoYXRzKS5sZW5ndGggPD0gMSkgeyBjcmVhdGVOZXdDaGF0KCk7IHJldHVybjsgfQ0KICAgIGRlbGV0ZSBhcHBTdGF0ZS5jaGF0c1thcHBTdGF0ZS5jdXJyZW50Q2hhdElkXTsNCiAgICBzYXZlQXBwU3RhdGUoKTsNCiAgICBjb25zdCBjaGF0SWRzID0gT2JqZWN0LmtleXMoYXBwU3RhdGUuY2hhdHMpOw0KICAgIGlmIChjaGF0SWRzLmxlbmd0aCA+IDApIGxvYWRDaGF0KGNoYXRJZHNbMF0pOyBlbHNlIGNyZWF0ZU5ld0NoYXQoKTsNCn0NCg0KZnVuY3Rpb24gZm9yY2VTY3JvbGxUb0JvdHRvbSgpIHsNCiAgICBjb25zdCBjaGF0TWVzc2FnZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hhdE1lc3NhZ2VzJyk7DQogICAgaWYgKCFjaGF0TWVzc2FnZXMpIHJldHVybjsNCiAgICBjaGF0TWVzc2FnZXMuc2Nyb2xsVG9wID0gY2hhdE1lc3NhZ2VzLnNjcm9sbEhlaWdodDsNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsgY2hhdE1lc3NhZ2VzLnNjcm9sbFRvcCA9IGNoYXRNZXNzYWdlcy5zY3JvbGxIZWlnaHQ7IH0sIDUwKTsNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsgY2hhdE1lc3NhZ2VzLnNjcm9sbFRvcCA9IGNoYXRNZXNzYWdlcy5zY3JvbGxIZWlnaHQ7IH0sIDE1MCk7DQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGNoYXRNZXNzYWdlcy5zY3JvbGxUb3AgPSBjaGF0TWVzc2FnZXMuc2Nyb2xsSGVpZ2h0Ow0KICAgICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IGNoYXRNZXNzYWdlcy5sYXN0RWxlbWVudENoaWxkOw0KICAgICAgICBpZiAobGFzdE1lc3NhZ2UpIGxhc3RNZXNzYWdlLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdhdXRvJywgYmxvY2s6ICdlbmQnIH0pOw0KICAgIH0sIDMwMCk7DQp9DQoNCmZ1bmN0aW9uIHNjcm9sbFRvQm90dG9tKCkgew0KICAgIGNvbnN0IGNoYXRNZXNzYWdlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0TWVzc2FnZXMnKTsNCiAgICBpZiAoIWNoYXRNZXNzYWdlcykgcmV0dXJuOw0KICAgIGNoYXRNZXNzYWdlcy5zY3JvbGxUb3AgPSBjaGF0TWVzc2FnZXMuc2Nyb2xsSGVpZ2h0Ow0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVCZWZvcmVVbmxvYWQoZSkgew0KICAgIGlmIChPYmplY3Qua2V5cyhhcHBTdGF0ZS5jaGF0cykubGVuZ3RoID4gMCkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIHRyeSB7IGxlYXZlUGFnZU1vZGFsSW5zdGFuY2U/LnNob3coKTsgfSBjYXRjaCAoZXJyKSB7IH0NCiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9ICcnOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gcGxhY2VDdXJzb3JBdEVuZChlbGVtZW50KSB7DQogICAgaWYgKCFlbGVtZW50KSByZXR1cm47DQogICAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOw0KICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsNCiAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZWxlbWVudCk7DQogICAgcmFuZ2UuY29sbGFwc2UoZmFsc2UpOw0KICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpOw0KICAgIGVsZW1lbnQuZm9jdXMoKTsNCn0NCg0KZnVuY3Rpb24gcGxheVNvdW5kU2FmZWx5KGF1ZGlvRWxlbWVudCkgew0KICAgIGlmICghYXVkaW9FbGVtZW50KSByZXR1cm47DQogICAgY29uc3Qgc291bmQgPSBuZXcgQXVkaW8oYXVkaW9FbGVtZW50LnNyYyk7DQogICAgc291bmQudm9sdW1lID0gMC43Ow0KICAgIHNvdW5kLnBsYXkoKS50aGVuKCgpID0+IHsgY29uc29sZS5sb2coJ1NvdW5kIHBsYXllZCcpOyB9KS5jYXRjaChlcnIgPT4gew0KICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBwbGF5IHNvdW5kOicsIGVyci5tZXNzYWdlKTsNCiAgICAgICAgaWYgKGVyci5uYW1lID09PSAnTm90QWxsb3dlZEVycm9yJykgew0KICAgICAgICAgICAgY29uc3QgcGxheU9uQ2xpY2sgPSAoKSA9PiB7IHNvdW5kLnBsYXkoKS5jYXRjaChlID0+IGNvbnNvbGUud2FybignU3RpbGwgY291bGQgbm90IHBsYXkgc291bmQ6JywgZS5tZXNzYWdlKSk7IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheU9uQ2xpY2spOyB9Ow0KICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5T25DbGljaywgeyBvbmNlOiB0cnVlIH0pOw0KICAgICAgICB9DQogICAgfSk7DQp9DQogICAgPC9zY3JpcHQ+DQo8L2JvZHk+DQoNCg0KPC9odG1sPg==';

        // Decode and inject
        const decodedHTML = atob(base64HTML);
        contentContainer.innerHTML = decodedHTML;
        document.body.appendChild(contentContainer);
        if (typeof draggable === 'function') {
            draggable(panel, header);
        } else {
            (function simpleDrag() {
                let dragging = false, ox = 0, oy = 0;
                const move = e => {
                    const x = (e.clientX !== undefined) ? e.clientX : (e.touches && e.touches[0] && e.touches[0].clientX);
                    const y = (e.clientY !== undefined) ? e.clientY : (e.touches && e.touches[0] && e.touches[0].clientY);
                    if (!dragging || x == null) return;
                    panel.style.left = (x - ox) + 'px';
                    panel.style.top = (y - oy) + 'px';
                    panel.style.right = '';
                };
                const up = () => {
                    dragging = false;
                    document.removeEventListener('mousemove', move);
                    document.removeEventListener('mouseup', up);
                    document.removeEventListener('touchmove', move);
                    document.removeEventListener('touchend', up);
                    header.style.cursor = 'grab';
                };
                header.addEventListener('mousedown', e => {
                    dragging = true;
                    const r = panel.getBoundingClientRect();
                    ox = e.clientX - r.left;
                    oy = e.clientY - r.top;
                    document.addEventListener('mousemove', move);
                    document.addEventListener('mouseup', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
                header.addEventListener('touchstart', e => {
                    dragging = true;
                    const t = e.touches[0];
                    const r = panel.getBoundingClientRect();
                    ox = t.clientX - r.left;
                    oy = t.clientY - r.top;
                    document.addEventListener('touchmove', move);
                    document.addEventListener('touchend', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
            })();
        }
        closeBtn.onclick = () => {
            panel.remove();
        };
        panel.addEventListener('mousedown', () => {
            panel.style.zIndex = 2147483648;
        });
    }
    function draggable(panel, handle) {
        let dragging = false, ox = 0, oy = 0;
        const move = e => {
            const x = (e.clientX !== undefined) ? e.clientX : (e.touches && e.touches[0] && e.touches[0].clientX);
            const y = (e.clientY !== undefined) ? e.clientY : (e.touches && e.touches[0] && e.touches[0].clientY);
            if (!dragging || x == null) return;
            panel.style.left = (x - ox) + 'px';
            panel.style.top = (y - oy) + 'px';
            panel.style.right = '';
        };
        const up = () => {
            dragging = false;
            document.removeEventListener('mousemove', move);
            document.removeEventListener('mouseup', up);
            document.removeEventListener('touchmove', move);
            document.removeEventListener('touchend', up);
            if (handle) handle.style.cursor = 'grab';
        };
        handle.addEventListener('mousedown', e => {
            dragging = true;
            const r = panel.getBoundingClientRect();
            ox = e.clientX - r.left;
            oy = e.clientY - r.top;
            document.addEventListener('mousemove', move);
            document.addEventListener('mouseup', up);
            handle.style.cursor = 'grabbing';
            e.preventDefault();
        });
        handle.addEventListener('touchstart', e => {
            dragging = true;
            const t = e.touches[0];
            const r = panel.getBoundingClientRect();
            ox = t.clientX - r.left;
            oy = t.clientY - r.top;
            document.addEventListener('touchmove', move);
            document.addEventListener('touchend', up);
            handle.style.cursor = 'grabbing';
            e.preventDefault();
        });
    }
})();
