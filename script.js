(function () {
    window.MP_Tools = function () {
        if (document.getElementById('mp-tools-panel')) {
            document.getElementById('mp-tools-panel').remove();
            return;
        }
        createPanel();
    };
    function createPanel() {
        const p = document.createElement('div');
        p.id = 'mp-tools-panel';
        p.style.cssText = `
            position:fixed;right:12px;top:12px;width:420px;z-index:2147483647;
            background:#0f1724;color:#e6eef8;padding:12px;border-radius:10px;
            box-shadow:0 8px 32px rgba(2,6,23,.7);font-family:Arial,Helvetica,sans-serif;
            font-size:13px;box-sizing:border-box;user-select:none;
        `;
        const h = document.createElement('div');
        h.style.cssText = `
            font-weight:700;margin-bottom:8px;display:flex;
            justify-content:space-between;align-items:center;cursor:grab;
        `;
        h.textContent = 'MP Tools';
        const x = document.createElement('button');
        x.textContent = 'X';
        x.title = 'Close';
        x.style.cssText = `
            background:transparent;border:0;color:inherit;
            cursor:pointer;font-size:14px;padding:4px 8px;
        `;
        x.onclick = () => p.remove();
        h.appendChild(x);
        p.appendChild(h);
        const i = document.createElement('div');
        i.textContent = 'Choose a tool:';
        i.style.marginBottom = '8px';
        p.appendChild(i);
        const cols = document.createElement('div');
        cols.style.cssText = 'display:flex;gap:10px;';
        const c1 = column();
        const c2 = column();
        const startBtn = btn('Start Speedrunner', '#16a34a', '#fff');
        const stopBtn = btn('Stop Speedrunner', '#ef4444', '#fff');
        stopBtn.style.marginBottom = '12px';
        c1.appendChild(startBtn);
        c1.appendChild(stopBtn);
        const enableBtn = btn('Enable Right Click', '#16a34a', '#fff');
        const disableBtn = btn('Disable Right Click', '#ef4444', '#fff');
        c2.appendChild(enableBtn);
        c2.appendChild(disableBtn);
        const calcBtn = btn('Open Calculator', '#0ea5a4', '#fff');
        c1.appendChild(calcBtn);
        // NEW: Open AI button (same color/style as calculator)
        const openAiBtn = btn('Open AI', '#0ea5a4', '#fff');
        c1.appendChild(openAiBtn);
        cols.appendChild(c1);
        cols.appendChild(c2);
        p.appendChild(cols);
        document.body.appendChild(p);
        speedrunner(startBtn, stopBtn);
        rightClick(enableBtn, disableBtn);
        draggable(p, h);
        calcBtn.onclick = () => openCalculator();
        openAiBtn.onclick = () => openOpenAI(); // hook up new button
    }
    function column() {
        const d = document.createElement('div');
        d.style.cssText = 'flex:1;display:flex;flex-direction:column;gap:8px;';
        return d;
    }
    function btn(text, bg, fg) {
        const b = document.createElement('button');
        b.textContent = text;
        b.style.cssText = `
            width:100%;padding:10px;border-radius:8px;border:0;
            cursor:pointer;box-sizing:border-box;font-weight:700;
            font-size:12px;background:${bg};color:${fg};
        `;
        return b;
    }
    function speedrunner(start, stop) {
        start.onclick = async function () {
            if (window.__autoClickerRunning) return console.log('Speedrunner already running');
            window.__autoClickerStopRequested = false;
            window.__autoClickerRunning = true;
            const wait = (sel, txt, to = 10000) => new Promise((res, rej) => {
                const s = Date.now();
                const iv = setInterval(() => {
                    const els = [...document.querySelectorAll(sel)];
                    for (const el of els) if (el.textContent.trim() === txt) { clearInterval(iv); res(el); return; }
                    if (Date.now() - s > to) { clearInterval(iv); rej(new Error('Timeout: ' + txt)); }
                }, 200);
            });
            const sleep = ms => new Promise(r => setTimeout(r, ms));
            try {
                while (!window.__autoClickerStopRequested) {
                    try {
                        (await wait('div.bottom-button.card-button.check-button.flex.items-center.relative.right-button.round-button',
                                    'Check my answer')).click();
                        (await wait('div.next-button.ph3.pv2.card-button.round-button.bottom-button.left-button.flex.items-center.mr2',
                                    'Complete question')).click();
                        await sleep(3000);
                    } catch { await sleep(1000); }
                }
            } finally {
                window.__autoClickerRunning = false;
                console.log('Speedrunner stopped');
            }
        };
        stop.onclick = () => {
            window.__autoClickerStopRequested = true;
            window.__autoClickerRunning = false;
            console.log('Stop requested');
        };
    }
    function rightClick(enable, disable) {
        enable.onclick = function () {
            if (window.__allowRClickInterval) return console.log('Already running');
            const handler = e => { try { e.stopImmediatePropagation(); } catch (_) {} };
            const purge = () => {
                document.oncontextmenu = document.onmousedown = document.onmouseup = null;
                document.querySelectorAll('*').forEach(el => {
                    el.oncontextmenu = el.onmousedown = el.onmouseup = null;
                });
                ['contextmenu','mousedown','mouseup'].forEach(ev => {
                    window.addEventListener(ev, handler, true);
                    document.addEventListener(ev, handler, true);
                });
                window.__allowRClick_installed = true;
                window.__allowRClick_handler = handler;
            };
            window.__allowRClickInterval = setInterval(purge, 50);
            console.log('Right-click unblocker ON');
        };
        disable.onclick = function () {
            if (window.__allowRClickInterval) clearInterval(window.__allowRClickInterval);
            if (window.__allowRClick_installed && window.__allowRClick_handler) {
                ['contextmenu','mousedown','mouseup'].forEach(ev => {
                    try { window.removeEventListener(ev, window.__allowRClick_handler, true); } catch (_) {}
                    try { document.removeEventListener(ev, window.__allowRClick_handler, true); } catch (_) {}
                });
            }
            window.__allowRClick_installed = false;
            window.__allowRClick_handler = null;
            window.__allowRClickInterval = null;
            console.log('Right-click unblocker OFF');
        };
    }
    function openCalculator() {
        const existingPanel = document.getElementById('mp-desmos-panel');
        if (existingPanel) {
            existingPanel.style.display = existingPanel.style.display === 'none' ? '' : existingPanel.style.display;
            existingPanel.style.zIndex = 2147483648;
            return;
        }
        const panel = document.createElement('div');
        panel.id = 'mp-desmos-panel';
        panel.style.cssText = `
            position:fixed;left:12px;top:12px;width:420px;height:500px;z-index:2147483648;
            background:#fff;color:#111;border-radius:8px;border:1px solid #bbb;
            box-shadow:0 8px 30px rgba(0,0,0,.4);font-family:Arial,Helvetica,sans-serif;
            box-sizing:border-box;user-select:none;padding:0;overflow:hidden;
        `;
        const header = document.createElement('div');
        header.style.cssText = `
            display:flex;align-items:center;justify-content:space-between;
            background:#2b2f33;color:#fff;padding:8px 10px;cursor:grab;
            font-weight:700;font-size:13px;
        `;
        header.innerHTML = `<span style="pointer-events:none;">Calculator</span>`;
        const headerBtns = document.createElement('div');
        headerBtns.style.cssText = 'display:flex;gap:6px;align-items:center;';
        const closeBtn = document.createElement('button');
        closeBtn.title = 'Close';
        closeBtn.textContent = '✕';
        closeBtn.style.cssText = `
            background:transparent;border:0;color:inherit;cursor:pointer;padding:2px 6px;
            font-size:14px;
        `;
        headerBtns.appendChild(closeBtn);
        header.appendChild(headerBtns);
        panel.appendChild(header);
        const body = document.createElement('div');
        body.id = 'mp-desmos-body';
        body.style.cssText = `
            width:100%;height:calc(100% - 42px);padding:8px;box-sizing:border-box;
            background:transparent;
        `;
        const desmosContainer = document.createElement('div');
        desmosContainer.id = 'scientificCalc';
        desmosContainer.style.cssText = 'width:100%;height:100%;border-radius:6px;overflow:hidden;';
        body.appendChild(desmosContainer);
        panel.appendChild(body);
        document.body.appendChild(panel);
        if (typeof draggable === 'function') {
            draggable(panel, header);
        } else {
            (function simpleDrag() {
                let dragging = false, ox = 0, oy = 0;
                const move = e => {
                    const x = (e.clientX !== undefined) ? e.clientX : (e.touches && e.touches[0] && e.touches[0].clientX);
                    const y = (e.clientY !== undefined) ? e.clientY : (e.touches && e.touches[0] && e.touches[0].clientY);
                    if (!dragging || x == null) return;
                    panel.style.left = (x - ox) + 'px';
                    panel.style.top = (y - oy) + 'px';
                    panel.style.right = '';
                };
                const up = () => {
                    dragging = false;
                    document.removeEventListener('mousemove', move);
                    document.removeEventListener('mouseup', up);
                    document.removeEventListener('touchmove', move);
                    document.removeEventListener('touchend', up);
                    header.style.cursor = 'grab';
                };
                header.addEventListener('mousedown', e => {
                    dragging = true;
                    const r = panel.getBoundingClientRect();
                    ox = e.clientX - r.left;
                    oy = e.clientY - r.top;
                    document.addEventListener('mousemove', move);
                    document.addEventListener('mouseup', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
                header.addEventListener('touchstart', e => {
                    dragging = true;
                    const t = e.touches[0];
                    const r = panel.getBoundingClientRect();
                    ox = t.clientX - r.left;
                    oy = t.clientY - r.top;
                    document.addEventListener('touchmove', move);
                    document.addEventListener('touchend', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
            })();
        }
        closeBtn.onclick = () => {
            try {
                if (window.__mp_desmos_instance && typeof window.__mp_desmos_instance.destroy === 'function') {
                    window.__mp_desmos_instance.destroy();
                }
            } catch (err) {}
            window.__mp_desmos_instance = null;
            panel.remove();
        };
        function ensureDesmos() {
            if (window.Desmos) return Promise.resolve();
            if (window.__mp_desmos_loading_promise) return window.__mp_desmos_loading_promise;
            window.__mp_desmos_loading_promise = new Promise((resolve, reject) => {
                const s = document.createElement('script');
                s.src = 'https://www.desmos.com/api/v1.11/calculator.js?apiKey=78043328c170484d8c2b47e1013a0d12';
                s.async = true;
                s.onload = () => resolve();
                s.onerror = (e) => reject(new Error('Failed to load Desmos script'));
                document.head.appendChild(s);
            });
            return window.__mp_desmos_loading_promise;
        }
        function initDesmos() {
            try {
                if (!document.getElementById('scientificCalc')) {
                    console.error('Desmos container missing');
                    return;
                }
                if (window.__mp_desmos_instance) {
                    try { if (typeof window.__mp_desmos_instance.update === 'function') window.__mp_desmos_instance.update(); } catch(_) {}
                    return;
                }
                window.__mp_desmos_instance = Desmos && Desmos.ScientificCalculator
                    ? Desmos.ScientificCalculator(document.getElementById('scientificCalc'), { keypad: true })
                    : null;
                if (!window.__mp_desmos_instance) console.error('Desmos object not available or API changed');
            } catch (err) {
                console.error('Error initialising Desmos', err);
            }
        }
        ensureDesmos().then(initDesmos).catch(err => {
            console.error('Failed to load Desmos calculator:', err);
            const errNotice = document.createElement('div');
            errNotice.style.cssText = 'padding:10px;color:#900;font-weight:700;';
            errNotice.textContent = 'Desmos failed to load.';
            body.appendChild(errNotice);
        });
        panel.addEventListener('mousedown', () => {
            panel.style.zIndex = 2147483648;
        });
    }
    // NEW: Open AI panel that embeds the given URL in an iframe, same header & size as calculator
    function openOpenAI() {
        const existingPanel = document.getElementById('mp-openai-panel');
        if (existingPanel) {
            existingPanel.style.display = existingPanel.style.display === 'none' ? '' : existingPanel.style.display;
            existingPanel.style.zIndex = 2147483648;
            return;
        }
        const panel = document.createElement('div');
        panel.id = 'mp-openai-panel';
        panel.style.cssText = `
            position:fixed;left:12px;top:12px;width:420px;height:500px;z-index:2147483648;
            background:#fff;color:#111;border-radius:8px;border:1px solid #bbb;
            box-shadow:0 8px 30px rgba(0,0,0,.4);font-family:Arial,Helvetica,sans-serif;
            box-sizing:border-box;user-select:none;padding:0;overflow:hidden;
        `;
        const header = document.createElement('div');
        header.style.cssText = `
            display:flex;align-items:center;justify-content:space-between;
            background:#2b2f33;color:#fff;padding:8px 10px;cursor:grab;
            font-weight:700;font-size:13px;
        `;
        header.innerHTML = `<span style="pointer-events:none;">Open AI</span>`;
        const headerBtns = document.createElement('div');
        headerBtns.style.cssText = 'display:flex;gap:6px;align-items:center;';
        const closeBtn = document.createElement('button');
        closeBtn.title = 'Close';
        closeBtn.textContent = '✕';
        closeBtn.style.cssText = `
            background:transparent;border:0;color:inherit;cursor:pointer;padding:2px 6px;
            font-size:14px;
        `;
        headerBtns.appendChild(closeBtn);
        header.appendChild(headerBtns);
        panel.appendChild(header);
        const body = document.createElement('div');
        body.id = 'mp-openai-body';
        body.style.cssText = `
            width:100%;height:calc(100% - 42px);padding:0;box-sizing:border-box;
            background:transparent;display:flex;flex-direction:column;
        `;
        // iframe that embeds the requested page
        const iframe = document.createElement('iframe');
        iframe.src = 'data:text/html;base64,PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQoNCjxoZWFkPg0KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4NCiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+DQogICAgPHRpdGxlPkFJIENoYXQ8L3RpdGxlPg0KICAgIDwhLS0gQm9vdHN0cmFwIENTUyAtLT4NCiAgICA8bGluayBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2Jvb3RzdHJhcEA1LjMuMC1hbHBoYTEvZGlzdC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiIHJlbD0ic3R5bGVzaGVldCI+DQogICAgPCEtLSBBT1MgQW5pbWF0aW9uIExpYnJhcnkgLS0+DQogICAgPGxpbmsgaHJlZj0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9hb3NAMi4zLjQvZGlzdC9hb3MuY3NzIiByZWw9InN0eWxlc2hlZXQiPg0KICAgIDwhLS0gRm9udCBBd2Vzb21lIGZvciBJY29ucyAtLT4NCiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2ZvbnQtYXdlc29tZS82LjQuMC9jc3MvYWxsLm1pbi5jc3MiPg0KICAgIDwhLS0gSGlnaGxpZ2h0LmpzIGZvciBDb2RlIFN5bnRheCBIaWdobGlnaHRpbmcgLS0+DQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9oaWdobGlnaHQuanMvMTEuNy4wL3N0eWxlcy9naXRodWIubWluLmNzcyI+DQogICAgPCEtLSBNYXJrZWQgZm9yIE1hcmtkb3duIC0tPg0KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL21hcmtlZEA0LjIuMTIvbWFya2VkLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgPCEtLSBDdXN0b20gQ1NTIC0tPg0KICAgIDxzdHlsZT4NCiAgICAgICAgLyogTWFpbiBDb250ZW50IEFyZWEgKi8NCi5tYWluLWNvbnRlbnQgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA1NnB4KTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KDQovKiBDaGF0IE1lc3NhZ2VzIEFyZWEgKi8NCi5jaGF0LW1lc3NhZ2VzIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodC1iZyk7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogMjBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQp9DQoNCi8qIE1ha2Ugc3VyZSB0aGUgbWFpbiBjb250ZW50IHRha2VzIHVwIHRoZSBmdWxsIGhlaWdodCAqLw0KI21haW5Db250ZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNTZweCk7DQp9DQoNCi8qIENoYXQgbWVzc2FnZXMgY29udGFpbmVyIHNob3VsZCB0YWtlIGFsbCBhdmFpbGFibGUgc3BhY2UgKi8NCi5jaGF0LW1lc3NhZ2VzLWNvbnRhaW5lciB7DQogICAgZmxleDogMTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLyogQ2hhdCBJbnB1dCBBcmVhICovDQouY2hhdC1pbnB1dC1hcmVhIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KICAgIHotaW5kZXg6IDEwOw0KfQ0KDQo6cm9vdCB7DQogICAgLS1wcmltYXJ5LWNvbG9yOiAjMjU2M2ViOw0KICAgIC0tc2Vjb25kYXJ5LWNvbG9yOiAjNGI1NTYzOw0KICAgIC0tbGlnaHQtYmc6ICNmOWZhZmI7DQogICAgLS1kYXJrLWJnOiAjMWYyOTM3Ow0KICAgIC0tdXNlci1idWJibGUtYmc6ICNlOWYyZmY7DQogICAgLS1hc3Npc3RhbnQtYnViYmxlLWJnOiAjZjNmNGY2Ow0KICAgIC0tYm9yZGVyLWNvbG9yOiAjZTVlN2ViOw0KICAgIC0tdHJhbnNpdGlvbi1zcGVlZDogMC4zczsNCn0NCg0KYm9keSB7DQogICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBPeHlnZW4sIFVidW50dSwgQ2FudGFyZWxsLCAnT3BlbiBTYW5zJywgJ0hlbHZldGljYSBOZXVlJywgc2Fucy1zZXJpZjsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0LWJnKTsNCn0NCg0KLyogU2lkZWJhciBTdHlsZXMgKi8NCi5zaWRlYmFyIHsNCiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gdmFyKC0tdHJhbnNpdGlvbi1zcGVlZCkgZWFzZTsNCiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA1NnB4KTsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIHotaW5kZXg6IDEwMDA7DQp9DQoNCi5zaWRlYmFyLmNvbGxhcHNlZCB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0xMDAlKTsNCn0NCg0KLyogTWFpbiBjb250ZW50IHdpdGggc2lkZWJhciBleHBhbmRlZC9jb2xsYXBzZWQgc3RhdGVzICovDQoubWFpbi1jb250ZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNTZweCk7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICB0cmFuc2l0aW9uOiB3aWR0aCB2YXIoLS10cmFuc2l0aW9uLXNwZWVkKSBlYXNlOw0KfQ0KDQovKiBXaGVuIHNpZGViYXIgaXMgY29sbGFwc2VkLCBleHBhbmQgbWFpbiBjb250ZW50ICovDQoubWFpbi1jb250ZW50LWV4cGFuZGVkIHsNCiAgICBtYXJnaW4tbGVmdDogMDsNCiAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50Ow0KfQ0KDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAuc2lkZWJhciB7DQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgd2lkdGg6IDI1MHB4Ow0KICAgICAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA1NnB4KTsNCiAgICB9DQoNCiAgICAubWFpbi1jb250ZW50IHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgfQ0KfQ0KDQovKiBDaGF0IEhpc3RvcnkgSXRlbXMgKi8NCi5jaGF0LWhpc3RvcnktaXRlbSB7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTsNCiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQp9DQoNCi5jaGF0LWhpc3RvcnktaXRlbTpob3ZlciB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCn0NCg0KLmNoYXQtaGlzdG9yeS1pdGVtLmFjdGl2ZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzNywgOTksIDIzNSwgMC4xKTsNCiAgICBib3JkZXItbGVmdDogM3B4IHNvbGlkIHZhcigtLXByaW1hcnktY29sb3IpOw0KfQ0KDQovKiBDaGF0IE1lc3NhZ2VzIEFyZWEgKi8NCi5jaGF0LW1lc3NhZ2VzIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodC1iZyk7DQogICAgc2Nyb2xsLWJlaGF2aW9yOiBzbW9vdGg7DQp9DQoNCi8qIENoYXQgQnViYmxlcyAqLw0KLmNoYXQtYnViYmxlIHsNCiAgICBtYXgtd2lkdGg6IDg1JTsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgb3BhY2l0eTogMDsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMjBweCk7DQogICAgYW5pbWF0aW9uOiBidWJibGVBcHBlYXIgMC4zcyBmb3J3YXJkczsNCn0NCg0KQGtleWZyYW1lcyBidWJibGVBcHBlYXIgew0KICAgIHRvIHsNCiAgICAgICAgb3BhY2l0eTogMTsNCiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOw0KICAgIH0NCn0NCg0KLnVzZXItYnViYmxlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS11c2VyLWJ1YmJsZS1iZyk7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2QxZTNmZjsNCiAgICBtYXJnaW4tbGVmdDogYXV0bzsNCn0NCg0KLmFzc2lzdGFudC1idWJibGUgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWFzc2lzdGFudC1idWJibGUtYmcpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkICNlNWU3ZWI7DQogICAgbWFyZ2luLXJpZ2h0OiBhdXRvOw0KfQ0KDQouYnViYmxlLWFjdGlvbnMgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB0b3A6IDEwcHg7DQogICAgcmlnaHQ6IDE1cHg7DQogICAgb3BhY2l0eTogMDsNCiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMnMgZWFzZTsNCn0NCg0KLmNoYXQtYnViYmxlOmhvdmVyIC5idWJibGUtYWN0aW9ucyB7DQogICAgb3BhY2l0eTogMTsNCn0NCg0KLmJ1YmJsZS1tZXRhZGF0YSB7DQogICAgZm9udC1zaXplOiAwLjc1cmVtOw0KICAgIGNvbG9yOiB2YXIoLS1zZWNvbmRhcnktY29sb3IpOw0KICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICB0ZXh0LWFsaWduOiByaWdodDsNCn0NCg0KLyogV2FpdGluZyBBbmltYXRpb24gKi8NCi53YWl0aW5nLWluZGljYXRvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIHBhZGRpbmc6IDE1cHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYXNzaXN0YW50LWJ1YmJsZS1iZyk7DQogICAgYm9yZGVyLXJhZGl1czogMTVweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZTVlN2ViOw0KICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQogICAgbWF4LXdpZHRoOiA4NSU7DQp9DQoNCi50eXBpbmctaW5kaWNhdG9yIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi50eXBpbmctZG90IHsNCiAgICB3aWR0aDogOHB4Ow0KICAgIGhlaWdodDogOHB4Ow0KICAgIG1hcmdpbjogMCAycHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5LWNvbG9yKTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIGFuaW1hdGlvbjogdHlwaW5nRG90IDEuNHMgaW5maW5pdGUgZWFzZS1pbi1vdXQgYm90aDsNCn0NCg0KLnR5cGluZy1kb3Q6bnRoLWNoaWxkKDEpIHsNCiAgICBhbmltYXRpb24tZGVsYXk6IDBzOw0KfQ0KDQoudHlwaW5nLWRvdDpudGgtY2hpbGQoMikgew0KICAgIGFuaW1hdGlvbi1kZWxheTogMC4yczsNCn0NCg0KLnR5cGluZy1kb3Q6bnRoLWNoaWxkKDMpIHsNCiAgICBhbmltYXRpb24tZGVsYXk6IDAuNHM7DQp9DQoNCkBrZXlmcmFtZXMgdHlwaW5nRG90IHsNCg0KICAgIDAlLA0KICAgIDgwJSwNCiAgICAxMDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwLjUpOw0KICAgICAgICBvcGFjaXR5OiAwLjU7DQogICAgfQ0KDQogICAgNDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsNCiAgICAgICAgb3BhY2l0eTogMTsNCiAgICB9DQp9DQoNCi8qIFJpY2ggVGV4dCBFZGl0b3IgKi8NCi5wcm9tcHRFZGl0b3Igew0KICAgIG1pbi1oZWlnaHQ6IDUwcHg7DQogICAgbWF4LWhlaWdodDogMjUwcHg7DQogICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIC8qIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbnMgKi8NCiAgICAtd2Via2l0LW92ZXJmbG93LXNjcm9sbGluZzogdG91Y2g7DQogICAgLyogRm9yIHNtb290aGVyIHNjcm9sbGluZyBvbiBpT1MgKi8NCiAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47DQogICAgLyogUmVkdWNlcyBwYWludCBkdXJpbmcgc2Nyb2xsaW5nICovDQogICAgcGVyc3BlY3RpdmU6IDEwMDBweDsNCiAgICAvKiBIZWxwcyB3aXRoIDNEIGFjY2VsZXJhdGlvbiAqLw0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoMCwgMCwgMCk7DQogICAgLyogRm9yY2UgR1BVIGFjY2VsZXJhdGlvbiAqLw0KfQ0KDQoucHJvbXB0RWRpdG9yOmVtcHR5OmJlZm9yZSB7DQogICAgY29udGVudDogYXR0cihwbGFjZWhvbGRlcik7DQogICAgY29sb3I6ICNhYWE7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQp9DQoNCi5wcm9tcHRFZGl0b3IgcHJlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjFmM2Y1Ow0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA4cHg7DQogICAgZm9udC1mYW1pbHk6ICdDb3VyaWVyIE5ldycsIENvdXJpZXIsIG1vbm9zcGFjZTsNCiAgICBtYXJnaW46IDhweCAwOw0KfQ0KDQoucHJvbXB0RWRpdG9yIGNvZGUgew0KICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YxZjNmNTsNCiAgICBwYWRkaW5nOiAycHggNHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCn0NCg0KLyogT3B0aW1pemUgc2Nyb2xsYmFyIGFwcGVhcmFuY2UgZm9yIGJldHRlciBwZXJmb3JtYW5jZSAqLw0KLnByb21wdEVkaXRvcjo6LXdlYmtpdC1zY3JvbGxiYXIgew0KICAgIHdpZHRoOiA4cHg7DQp9DQoNCi5wcm9tcHRFZGl0b3I6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMik7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQoucHJvbXB0RWRpdG9yOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7DQogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjA1KTsNCn0NCg0KLyogRmlsZSBBdHRhY2htZW50cyAqLw0KLmZpbGUtYXR0YWNobWVudHMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC13cmFwOiB3cmFwOw0KICAgIGdhcDogOHB4Ow0KfQ0KDQouZmlsZS1hdHRhY2htZW50IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjRmNjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZDFkNWRiOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBwYWRkaW5nOiA0cHggOHB4Ow0KICAgIGZvbnQtc2l6ZTogMC44NXJlbTsNCn0NCg0KLmZpbGUtYXR0YWNobWVudCAuZmlsZS1uYW1lIHsNCiAgICBtYXJnaW46IDAgOHB4Ow0KICAgIG1heC13aWR0aDogMTUwcHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsNCiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KfQ0KDQouZmlsZS1hdHRhY2htZW50IC5yZW1vdmUtZmlsZSB7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGNvbG9yOiAjZWY0NDQ0Ow0KfQ0KDQovKiBNYXJrZG93biBDb250ZW50IFN0eWxpbmcgKi8NCi5tYXJrZG93bi1jb250ZW50IHsNCiAgICBsaW5lLWhlaWdodDogMS42Ow0KfQ0KDQoubWFya2Rvd24tY29udGVudCBoMSwNCi5tYXJrZG93bi1jb250ZW50IGgyLA0KLm1hcmtkb3duLWNvbnRlbnQgaDMsDQoubWFya2Rvd24tY29udGVudCBoNCwNCi5tYXJrZG93bi1jb250ZW50IGg1LA0KLm1hcmtkb3duLWNvbnRlbnQgaDYgew0KICAgIG1hcmdpbi10b3A6IDFlbTsNCiAgICBtYXJnaW4tYm90dG9tOiAwLjVlbTsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgcCB7DQogICAgbWFyZ2luLWJvdHRvbTogMWVtOw0KfQ0KDQoubWFya2Rvd24tY29udGVudCB1bCwNCi5tYXJrZG93bi1jb250ZW50IG9sIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxZW07DQogICAgcGFkZGluZy1sZWZ0OiAyZW07DQp9DQoNCi5tYXJrZG93bi1jb250ZW50IGNvZGUgew0KICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQogICAgcGFkZGluZzogMnB4IDRweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YxZjNmNTsNCiAgICBmb250LXNpemU6IDAuOWVtOw0KfQ0KDQoubWFya2Rvd24tY29udGVudCBwcmUgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmMWYzZjU7DQogICAgcGFkZGluZzogMWVtOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBvdmVyZmxvdy14OiBhdXRvOw0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgcHJlIGNvZGUgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50Ow0KICAgIHBhZGRpbmc6IDA7DQogICAgYm9yZGVyLXJhZGl1czogMDsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgYmxvY2txdW90ZSB7DQogICAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCAjZTVlN2ViOw0KICAgIHBhZGRpbmctbGVmdDogMWVtOw0KICAgIG1hcmdpbi1sZWZ0OiAwOw0KICAgIGNvbG9yOiAjNGI1NTYzOw0KfQ0KDQoubWFya2Rvd24tY29udGVudCBpbWcgew0KICAgIG1heC13aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IGF1dG87DQp9DQoNCi5tYXJrZG93bi1jb250ZW50IHRhYmxlIHsNCiAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOw0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLm1hcmtkb3duLWNvbnRlbnQgdGFibGUgdGgsDQoubWFya2Rvd24tY29udGVudCB0YWJsZSB0ZCB7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2QxZDVkYjsNCiAgICBwYWRkaW5nOiA4cHg7DQp9DQoNCi5tYXJrZG93bi1jb250ZW50IHRhYmxlIHRoIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjlmYWZiOw0KfQ0KDQovKiBFcnJvciBNZXNzYWdlICovDQouZXJyb3ItbWVzc2FnZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZlZTJlMjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWY0NDQ0Ow0KICAgIGNvbG9yOiAjYjkxYzFjOw0KICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgIG1heC13aWR0aDogODUlOw0KfQ0KDQovKiBFZGl0IE1vZGUgKi8NCi5lZGl0LW1vZGUgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmZiZWI7DQogICAgYm9yZGVyOiAxcHggZGFzaGVkICNkOTc3MDY7DQp9DQoNCi5lZGl0LWFjdGlvbnMgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIGdhcDogOHB4Ow0KfQ0KDQovKiBDb3B5IEFuaW1hdGlvbiAqLw0KQGtleWZyYW1lcyBjb3B5RmVlZGJhY2sgew0KICAgIDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsNCiAgICB9DQoNCiAgICA1MCUgew0KICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMik7DQogICAgfQ0KDQogICAgMTAwJSB7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7DQogICAgfQ0KfQ0KDQouY29weS1mZWVkYmFjayB7DQogICAgYW5pbWF0aW9uOiBjb3B5RmVlZGJhY2sgMC4zcyBlYXNlOw0KfQ0KDQovKiBNYWluIENvbnRlbnQgQXJlYSB3aGVuIFNpZGViYXIgaXMgQ29sbGFwc2VkICovDQoubWFpbi1jb250ZW50LWV4cGFuZGVkIHsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLyogVG9rZW4gQ291bnRlciAqLw0KI3Rva2VuQ291bnRlciB7DQogICAgZm9udC1zaXplOiAwLjhyZW07DQogICAgY29sb3I6IHZhcigtLXNlY29uZGFyeS1jb2xvcik7DQp9DQoNCi8qIFJlc3BvbnNlIHN0cmVhbWluZyBlZmZlY3QgKi8NCi5zdHJlYW1pbmctY2hhciB7DQogICAgb3BhY2l0eTogMDsNCiAgICBhbmltYXRpb246IGZhZGVJbiAwLjFzIGZvcndhcmRzOw0KfQ0KDQpAa2V5ZnJhbWVzIGZhZGVJbiB7DQogICAgdG8gew0KICAgICAgICBvcGFjaXR5OiAxOw0KICAgIH0NCn0NCg0KLyogU3lzdGVtIG1lc3NhZ2UgKi8NCi5zeXN0ZW0tbWVzc2FnZSB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIHBhZGRpbmc6IDEwcHg7DQogICAgbWFyZ2luOiAxMHB4IDA7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YwZjlmZjsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2JhZTZmZDsNCiAgICBjb2xvcjogIzAzNjlhMTsNCiAgICBmb250LXNpemU6IDAuOXJlbTsNCn0NCg0KLyogTW9kYWwgY3VzdG9taXphdGlvbnMgKi8NCi5tb2RhbC1oZWFkZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXByaW1hcnktY29sb3IpOw0KICAgIGNvbG9yOiB3aGl0ZTsNCn0NCg0KLyogVG9vbHRpcCBjdXN0b21pemF0aW9ucyAqLw0KLnRvb2x0aXAgew0KICAgIGZvbnQtc2l6ZTogMC44cmVtOw0KfQ0KDQovKiBEaXNhYmxlIHRleHQgc2VsZWN0aW9uIGluIGNlcnRhaW4gZWxlbWVudHMgKi8NCi5idWJibGUtYWN0aW9ucyBidXR0b24sDQouZmlsZS1hdHRhY2htZW50IC5yZW1vdmUtZmlsZSB7DQogICAgdXNlci1zZWxlY3Q6IG5vbmU7DQp9DQoNCi8qIE1vYmlsZSByZXNwb25zaXZlbmVzcyAqLw0KQG1lZGlhIChtYXgtd2lkdGg6IDU3NnB4KSB7DQogICAgLmNoYXQtYnViYmxlIHsNCiAgICAgICAgbWF4LXdpZHRoOiA5NSU7DQogICAgfQ0KDQogICAgLmJ1YmJsZS1hY3Rpb25zIHsNCiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICB0b3A6IGF1dG87DQogICAgICAgIHJpZ2h0OiBhdXRvOw0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOw0KICAgICAgICBtYXJnaW4tdG9wOiA4cHg7DQogICAgICAgIG9wYWNpdHk6IDE7DQogICAgfQ0KDQogICAgLmhlYWRlciBoMSB7DQogICAgICAgIGZvbnQtc2l6ZTogMS4ycmVtOw0KICAgIH0NCg0KICAgIC5idG4tZ3JvdXAgLmJ0biB7DQogICAgICAgIHBhZGRpbmc6IDAuMjVyZW0gMC41cmVtOw0KICAgIH0NCg0KICAgIC5kcm9wZG93bi1tZW51IHsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgfQ0KfQ0KDQouZmlsZS1sb2FkaW5nLWluZGljYXRvciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGdhcDogOHB4Ow0KICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjRmNjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZDFkNWRiOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KfQ0KDQovKiBFcnJvciBNZXNzYWdlIHdpdGggUmV0cnkgQnV0dG9uICovDQouZXJyb3ItbWVzc2FnZSB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZlZTJlMjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWY0NDQ0Ow0KICAgIGNvbG9yOiAjYjkxYzFjOw0KICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgIG1heC13aWR0aDogODUlOw0KfQ0KDQouZXJyb3ItbWVzc2FnZSAucmV0cnktYnRuIHsNCiAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgcGFkZGluZzogMC4yNXJlbSAwLjVyZW07DQp9DQoNCi5lcnJvci1tZXNzYWdlIC5yZXRyeS1idG46aG92ZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNkYzI2MjY7DQogICAgYm9yZGVyLWNvbG9yOiAjYjkxYzFjOw0KfQ0KICAgIDwvc3R5bGU+DQo8L2hlYWQ+DQoNCjxib2R5Pg0KICAgIDwhLS0gQVBJIEtleSBNb2RhbCAtLT4NCiAgICA8ZGl2IGNsYXNzPSJtb2RhbCBmYWRlIiBpZD0iYXBpS2V5TW9kYWwiIGRhdGEtYnMtYmFja2Ryb3A9InN0YXRpYyIgZGF0YS1icy1rZXlib2FyZD0iZmFsc2UiIHRhYmluZGV4PSItMSINCiAgICAgICAgYXJpYS1sYWJlbGxlZGJ5PSJhcGlLZXlNb2RhbExhYmVsIiBhcmlhLWhpZGRlbj0idHJ1ZSI+DQogICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWRpYWxvZyBtb2RhbC1kaWFsb2ctY2VudGVyZWQiPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtaGVhZGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGg1IGNsYXNzPSJtb2RhbC10aXRsZSIgaWQ9ImFwaUtleU1vZGFsTGFiZWwiPkVudGVyIFlvdXIgQVBJIEtleTwvaDU+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtYm9keSI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iYXBpS2V5SW5wdXQiIGNsYXNzPSJmb3JtLWxhYmVsIj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InBhc3N3b3JkIiBjbGFzcz0iZm9ybS1jb250cm9sIiBpZD0iYXBpS2V5SW5wdXQiIHBsYWNlaG9sZGVyPSJFbnRlciB5b3VyIEFQSSBrZXkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS10ZXh0IHRleHQtd2FybmluZyBtdC0yIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIj48L2k+IFdhcm5pbmc6IFlvdXIgQVBJIGtleSB3aWxsIGJlIHN0b3JlZCBpbiBzZXNzaW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZSBmb3IgdGhpcyBzZXNzaW9uIG9ubHkuDQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtZm9vdGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIGlkPSJhcGlLZXlTdWJtaXQiPlN1Ym1pdDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KDQogICAgPCEtLSBMZWF2ZSBQYWdlIFdhcm5pbmcgTW9kYWwgLS0+DQogICAgPGRpdiBjbGFzcz0ibW9kYWwgZmFkZSIgaWQ9ImxlYXZlUGFnZU1vZGFsIiB0YWJpbmRleD0iLTEiIGFyaWEtbGFiZWxsZWRieT0ibGVhdmVQYWdlTW9kYWxMYWJlbCIgYXJpYS1oaWRkZW49InRydWUiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1kaWFsb2cgbW9kYWwtZGlhbG9nLWNlbnRlcmVkIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWhlYWRlciI+DQogICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzcz0ibW9kYWwtdGl0bGUiIGlkPSJsZWF2ZVBhZ2VNb2RhbExhYmVsIj5XYXJuaW5nPC9oNT4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4tY2xvc2UiIGRhdGEtYnMtZGlzbWlzcz0ibW9kYWwiIGFyaWEtbGFiZWw9IkNsb3NlIj48L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1ib2R5Ij4NCiAgICAgICAgICAgICAgICAgICAgPHA+QXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGxlYXZlPyBZb3UgbWF5IGxvc2UgeW91ciBjaGF0IGhpc3RvcnkgdW5sZXNzIHlvdSBleHBvcnQgaXQgZmlyc3QuPC9wPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWZvb3RlciI+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiIGRhdGEtYnMtZGlzbWlzcz0ibW9kYWwiPlN0YXk8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLWRhbmdlciIgaWQ9ImNvbmZpcm1MZWF2ZVBhZ2UiPkxlYXZlPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQoNCiAgICA8IS0tIE1vZGVsIFNldHRpbmdzIE1vZGFsIC0tPg0KICAgIDxkaXYgY2xhc3M9Im1vZGFsIGZhZGUiIGlkPSJtb2RlbFNldHRpbmdzTW9kYWwiIHRhYmluZGV4PSItMSIgYXJpYS1sYWJlbGxlZGJ5PSJtb2RlbFNldHRpbmdzTW9kYWxMYWJlbCINCiAgICAgICAgYXJpYS1oaWRkZW49InRydWUiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1kaWFsb2cgbW9kYWwtZGlhbG9nLWNlbnRlcmVkIG1vZGFsLWxnIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWhlYWRlciI+DQogICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzcz0ibW9kYWwtdGl0bGUiIGlkPSJtb2RlbFNldHRpbmdzTW9kYWxMYWJlbCI+TW9kZWwgU2V0dGluZ3M8L2g1Pg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0bi1jbG9zZSIgZGF0YS1icy1kaXNtaXNzPSJtb2RhbCIgYXJpYS1sYWJlbD0iQ2xvc2UiPjwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWJvZHkiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0idGVtcGVyYXR1cmVTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5UZW1wZXJhdHVyZSA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJDb250cm9scyByYW5kb21uZXNzLiBMb3dlciB2YWx1ZXMgbWFrZSBvdXRwdXQgbW9yZSBmb2N1c2VkIGFuZCBkZXRlcm1pbmlzdGljLiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49IjAiIG1heD0iMiIgc3RlcD0iMC4xIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InRlbXBlcmF0dXJlU2xpZGVyIiB2YWx1ZT0iMSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtcy0yIiBpZD0idGVtcGVyYXR1cmVWYWx1ZSI+MS4wPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ0b3BQU2xpZGVyIiBjbGFzcz0iZm9ybS1sYWJlbCI+VG9wIFAgPHNwYW4gY2xhc3M9InRleHQtc2Vjb25kYXJ5Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1icy10b2dnbGU9InRvb2x0aXAiIGRhdGEtYnMtcGxhY2VtZW50PSJ0b3AiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iQ29udHJvbHMgZGl2ZXJzaXR5IHZpYSBudWNsZXVzIHNhbXBsaW5nLiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49IjAiIG1heD0iMSIgc3RlcD0iMC4wMSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJ0b3BQU2xpZGVyIiB2YWx1ZT0iMSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtcy0yIiBpZD0idG9wUFZhbHVlIj4xLjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ0b3BLU2xpZGVyIiBjbGFzcz0iZm9ybS1sYWJlbCI+VG9wIEsgPHNwYW4gY2xhc3M9InRleHQtc2Vjb25kYXJ5Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1icy10b2dnbGU9InRvb2x0aXAiIGRhdGEtYnMtcGxhY2VtZW50PSJ0b3AiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iTGltaXRzIGNob2ljZSB0byBLIHRvcCB0b2tlbnMuIDAgZGlzYWJsZXMgZmlsdGVyaW5nLiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49IjAiIG1heD0iMTAwIiBzdGVwPSIxIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InRvcEtTbGlkZXIiIHZhbHVlPSIwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im1zLTIiIGlkPSJ0b3BLVmFsdWUiPjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9ImZyZXF1ZW5jeVBlbmFsdHlTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5GcmVxdWVuY3kgUGVuYWx0eSA8c3Bhbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9InRleHQtc2Vjb25kYXJ5IiBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJSZWR1Y2VzIHJlcGV0aXRpb24gYmFzZWQgb24gZnJlcXVlbmN5IGluIGlucHV0LiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJmb3JtLXJhbmdlIGZsZXgtZ3Jvdy0xIiBtaW49Ii0yIiBtYXg9IjIiIHN0ZXA9IjAuMSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJmcmVxdWVuY3lQZW5hbHR5U2xpZGVyIiB2YWx1ZT0iMCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtcy0yIiBpZD0iZnJlcXVlbmN5UGVuYWx0eVZhbHVlIj4wLjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJwcmVzZW5jZVBlbmFsdHlTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5QcmVzZW5jZSBQZW5hbHR5IDxzcGFuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0idGV4dC1zZWNvbmRhcnkiIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9IlJlZHVjZXMgcmVwZXRpdGlvbiBvZiB0b2tlbnMgcmVnYXJkbGVzcyBvZiBmcmVxdWVuY3kuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgY2xhc3M9ImZvcm0tcmFuZ2UgZmxleC1ncm93LTEiIG1pbj0iLTIiIG1heD0iMiIgc3RlcD0iMC4xIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InByZXNlbmNlUGVuYWx0eVNsaWRlciIgdmFsdWU9IjAiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXMtMiIgaWQ9InByZXNlbmNlUGVuYWx0eVZhbHVlIj4wLjA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InJlcGV0aXRpb25QZW5hbHR5U2xpZGVyIiBjbGFzcz0iZm9ybS1sYWJlbCI+UmVwZXRpdGlvbiBQZW5hbHR5IDxzcGFuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0idGV4dC1zZWNvbmRhcnkiIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9IlJlZHVjZXMgcmVwZXRpdGlvbiBiYXNlZCBvbiB0b2tlbiBwcm9iYWJpbGl0eS4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1pbmZvLWNpcmNsZSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBjbGFzcz0iZm9ybS1yYW5nZSBmbGV4LWdyb3ctMSIgbWluPSIwIiBtYXg9IjIiIHN0ZXA9IjAuMSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJyZXBldGl0aW9uUGVuYWx0eVNsaWRlciIgdmFsdWU9IjEiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXMtMiIgaWQ9InJlcGV0aXRpb25QZW5hbHR5VmFsdWUiPjEuMDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9Im1pblBTbGlkZXIiIGNsYXNzPSJmb3JtLWxhYmVsIj5NaW4gUCA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJNaW4gcHJvYmFiaWxpdHkgcmVsYXRpdmUgdG8gbW9zdCBsaWtlbHkgdG9rZW4uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgY2xhc3M9ImZvcm0tcmFuZ2UgZmxleC1ncm93LTEiIG1pbj0iMCIgbWF4PSIxIiBzdGVwPSIwLjAxIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9Im1pblBTbGlkZXIiIHZhbHVlPSIwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im1zLTIiIGlkPSJtaW5QVmFsdWUiPjAuMDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0idG9wQVNsaWRlciIgY2xhc3M9ImZvcm0tbGFiZWwiPlRvcCBBIDxzcGFuIGNsYXNzPSJ0ZXh0LXNlY29uZGFyeSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9IkR5bmFtaWMgVG9wLVAgYmFzZWQgb24gaGlnaGVzdCBwcm9iYWJpbGl0eSB0b2tlbi4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1pbmZvLWNpcmNsZSI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBjbGFzcz0iZm9ybS1yYW5nZSBmbGV4LWdyb3ctMSIgbWluPSIwIiBtYXg9IjEiIHN0ZXA9IjAuMDEiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0idG9wQVNsaWRlciIgdmFsdWU9IjAiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXMtMiIgaWQ9InRvcEFWYWx1ZSI+MC4wPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0ic2VlZElucHV0IiBjbGFzcz0iZm9ybS1sYWJlbCI+U2VlZCA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJGb3IgZGV0ZXJtaW5pc3RpYyByZXNwb25zZXMuIFNhbWUgc2VlZCArIHNhbWUgcGFyYW1ldGVycyA9IHNhbWUgb3V0cHV0LiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWluZm8tY2lyY2xlIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJudW1iZXIiIGNsYXNzPSJmb3JtLWNvbnRyb2wiIGlkPSJzZWVkSW5wdXQiIHBsYWNlaG9sZGVyPSJPcHRpb25hbCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9Im1heFRva2Vuc0lucHV0IiBjbGFzcz0iZm9ybS1sYWJlbCI+TWF4IFRva2VucyA8c3BhbiBjbGFzcz0idGV4dC1zZWNvbmRhcnkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJNYXhpbXVtIG51bWJlciBvZiB0b2tlbnMgdG8gZ2VuZXJhdGUuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9Im1heFRva2Vuc0lucHV0IiBwbGFjZWhvbGRlcj0iT3B0aW9uYWwiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbj0iMSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWNoZWNrIGZvcm0tc3dpdGNoIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPSJmb3JtLWNoZWNrLWlucHV0IiB0eXBlPSJjaGVja2JveCIgaWQ9ImxvZ3Byb2JzQ2hlY2tib3giPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tY2hlY2stbGFiZWwiIGZvcj0ibG9ncHJvYnNDaGVja2JveCI+TG9ncHJvYnMgPHNwYW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0idGV4dC1zZWNvbmRhcnkiIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJSZXR1cm4gbG9nIHByb2JhYmlsaXRpZXMgb2Ygb3V0cHV0IHRva2Vucy4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ0b3BMb2dwcm9ic0lucHV0IiBjbGFzcz0iZm9ybS1sYWJlbCI+VG9wIExvZ3Byb2JzIDxzcGFuIGNsYXNzPSJ0ZXh0LXNlY29uZGFyeSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0idG9wIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9Ik51bWJlciBvZiBtb3N0IGxpa2VseSB0b2tlbnMgdG8gcmV0dXJuIGF0IGVhY2ggcG9zaXRpb24uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9InRvcExvZ3Byb2JzSW5wdXQiIHBsYWNlaG9sZGVyPSJPcHRpb25hbCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluPSIwIiBtYXg9IjIwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC02IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tY2hlY2sgZm9ybS1zd2l0Y2giPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9ImZvcm0tY2hlY2staW5wdXQiIHR5cGU9ImNoZWNrYm94IiBpZD0ic3RyZWFtaW5nQ2hlY2tib3giIGNoZWNrZWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1jaGVjay1sYWJlbCIgZm9yPSJzdHJlYW1pbmdDaGVja2JveCI+U3RyZWFtaW5nIDxzcGFuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9InRleHQtc2Vjb25kYXJ5IiBkYXRhLWJzLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1icy1wbGFjZW1lbnQ9InRvcCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iU3RyZWFtIHRoZSByZXNwb25zZSBhcyBpdCdzIGdlbmVyYXRlZC4iPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtaW5mby1jaXJjbGUiPjwvaT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KDQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im10LTMgYm9yZGVyLXRvcCBwdC0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxoNj5SZWFzb25pbmcgVG9rZW5zPC9oNj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTQgbWItMyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InJlYXNvbmluZ0VmZm9ydFNlbGVjdCIgY2xhc3M9ImZvcm0tbGFiZWwiPkVmZm9ydDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9ImZvcm0tc2VsZWN0IiBpZD0icmVhc29uaW5nRWZmb3J0U2VsZWN0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+Tm9uZTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibG93Ij5Mb3c8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im1lZGl1bSI+TWVkaXVtPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJoaWdoIj5IaWdoPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC00IG1iLTMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJyZWFzb25pbmdUb2tlbnNJbnB1dCIgY2xhc3M9ImZvcm0tbGFiZWwiPlRva2VuIExpbWl0PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9InJlYXNvbmluZ1Rva2Vuc0lucHV0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9ImUuZy4gMjAwMCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTQgbWItMyBkLWZsZXggYWxpZ24taXRlbXMtZW5kIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1jaGVjayI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9ImZvcm0tY2hlY2staW5wdXQiIHR5cGU9ImNoZWNrYm94IiBpZD0iZXhjbHVkZVJlYXNvbmluZ0NoZWNrYm94Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1jaGVjay1sYWJlbCIgZm9yPSJleGNsdWRlUmVhc29uaW5nQ2hlY2tib3giPkV4Y2x1ZGU8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1mb290ZXIiPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IiBpZD0icmVzZXRTZXR0aW5nc0J0biI+UmVzZXQgdG8gRGVmYXVsdHM8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIGRhdGEtYnMtZGlzbWlzcz0ibW9kYWwiPlNhdmUgU2V0dGluZ3M8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCg0KICAgIDwhLS0gTWFpbiBBcHBsaWNhdGlvbiBMYXlvdXQgLS0+DQogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyLWZsdWlkIHZoLTEwMCBkLWZsZXggZmxleC1jb2x1bW4iPg0KICAgICAgICA8IS0tIEhlYWRlciAtLT4NCiAgICAgICAgPGhlYWRlciBjbGFzcz0icm93IHB5LTIgYmctZGFyayB0ZXh0LXdoaXRlIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbCBkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIGp1c3RpZnktY29udGVudC1iZXR3ZWVuIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGgxIGNsYXNzPSJoNSBtYi0wIj5BSSBDaGF0PC9oMT4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZHJvcGRvd24gbWUtMiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCBkcm9wZG93bi10b2dnbGUiIHR5cGU9ImJ1dHRvbiIgaWQ9Im1vZGVsRHJvcGRvd24iDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1icy10b2dnbGU9ImRyb3Bkb3duIiBhcmlhLWV4cGFuZGVkPSJmYWxzZSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VsZWN0IE1vZGVsDQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDx1bCBjbGFzcz0iZHJvcGRvd24tbWVudSBkcm9wZG93bi1tZW51LWVuZCIgYXJpYS1sYWJlbGxlZGJ5PSJtb2RlbERyb3Bkb3duIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJtb2RlbERyb3Bkb3duTWVudSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPCEtLSBNb2RlbHMgd2lsbCBiZSBhZGRlZCBoZXJlIGR5bmFtaWNhbGx5IC0tPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC91bD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImJ0bi1ncm91cCIgcm9sZT0iZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtbGlnaHQiIGlkPSJtb2RlbFNldHRpbmdzQnRuIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLWJzLXBsYWNlbWVudD0iYm90dG9tIiB0aXRsZT0iTW9kZWwgU2V0dGluZ3MiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2xpZGVycyI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCIgaWQ9ImV4cG9ydENoYXRCdG4iIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtcGxhY2VtZW50PSJib3R0b20iIHRpdGxlPSJFeHBvcnQgQ2hhdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1maWxlLWV4cG9ydCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCIgaWQ9ImltcG9ydENoYXRCdG4iIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtcGxhY2VtZW50PSJib3R0b20iIHRpdGxlPSJJbXBvcnQgQ2hhdCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1maWxlLWltcG9ydCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS1saWdodCIgaWQ9ImRlbGV0ZUNoYXRCdG4iIGRhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYnMtcGxhY2VtZW50PSJib3R0b20iIHRpdGxlPSJEZWxldGUgQ3VycmVudCBDaGF0Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXRyYXNoIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9oZWFkZXI+DQoNCiAgICAgICAgPCEtLSBNYWluIENvbnRlbnQgQXJlYSAtLT4NCiAgICAgICAgPGRpdiBjbGFzcz0icm93IGctMCBmbGV4LWdyb3ctMSI+DQogICAgICAgICAgICA8IS0tIENoYXQgQXJlYSAtLT4NCiAgICAgICAgICAgIDxtYWluIGlkPSJtYWluQ29udGVudCIgY2xhc3M9ImNvbC1tZC05IGNvbC1sZy0xMCBkLWZsZXggZmxleC1jb2x1bW4iPg0KICAgICAgICAgICAgICAgIDwhLS0gQ2hhdCBNZXNzYWdlcyBXcmFwcGVyIC0tPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNoYXQtbWVzc2FnZXMtY29udGFpbmVyIj4NCiAgICAgICAgICAgICAgICAgICAgPCEtLSBTY3JvbGxhYmxlIE1lc3NhZ2VzIEFyZWEgLS0+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNoYXQtbWVzc2FnZXMgaC0xMDAgb3ZlcmZsb3ctYXV0byIgaWQ9ImNoYXRNZXNzYWdlcyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8IS0tIE1lc3NhZ2VzIHdpbGwgYmUgYWRkZWQgaGVyZSBkeW5hbWljYWxseSAtLT4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICAgICAgICA8IS0tIElucHV0IEFyZWEgLS0+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2hhdC1pbnB1dC1hcmVhIHAtMyBib3JkZXItdG9wIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmlsZS1hdHRhY2htZW50cyBtYi0yIiBpZD0iZmlsZUF0dGFjaG1lbnRzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gRmlsZSBhdHRhY2htZW50cyB3aWxsIGJlIGFkZGVkIGhlcmUgZHluYW1pY2FsbHkgLS0+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dC1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWNvbnRyb2wgcG9zaXRpb24tcmVsYXRpdmUiIGlkPSJwcm9tcHRFZGl0b3JXcmFwcGVyIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJwcm9tcHRFZGl0b3IiIGNsYXNzPSJwcm9tcHRFZGl0b3IiIGNvbnRlbnRlZGl0YWJsZT0idHJ1ZSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9IlR5cGUgeW91ciBtZXNzYWdlIGhlcmUuLi4iPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IiB0eXBlPSJidXR0b24iIGlkPSJmaWxlVXBsb2FkQnRuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBhcGVyY2xpcCI+PC9pPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIHR5cGU9ImJ1dHRvbiIgaWQ9InNlbmRNZXNzYWdlQnRuIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXBhcGVyLXBsYW5lIj48L2k+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlbiBhbGlnbi1pdGVtcy1jZW50ZXIgbXQtMiI+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ0b2tlbkNvdW50ZXIiIGNsYXNzPSJ0ZXh0LW11dGVkIHNtYWxsIj4wIHRva2VuczwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImZpbGUiIGlkPSJmaWxlSW5wdXQiIG11bHRpcGxlIHN0eWxlPSJkaXNwbGF5Om5vbmUiPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgIDwvbWFpbj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQoNCiAgICA8IS0tIEJvb3RzdHJhcCBCdW5kbGUgd2l0aCBQb3BwZXIgLS0+DQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vYm9vdHN0cmFwQDUuMy4wLWFscGhhMS9kaXN0L2pzL2Jvb3RzdHJhcC5idW5kbGUubWluLmpzIj48L3NjcmlwdD4NCiAgICA8IS0tIEFPUyBBbmltYXRpb24gTGlicmFyeSAtLT4NCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9hb3NAMi4zLjQvZGlzdC9hb3MuanMiPjwvc2NyaXB0Pg0KICAgIDwhLS0gSGlnaGxpZ2h0LmpzIGZvciBDb2RlIFN5bnRheCBIaWdobGlnaHRpbmcgLS0+DQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2hpZ2hsaWdodC5qcy8xMS43LjAvaGlnaGxpZ2h0Lm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgPCEtLSBDdXN0b20gSmF2YVNjcmlwdCAtLT4NCiAgICA8c2NyaXB0Pg0KICAgICAgICAvLyBGVUxMIFVQREFURUQgQ0hBVCBBUFAgSlMg4oCUIExvY2tlZCB0byBHUFQgT1NTIDEyMEIgb25seSBhbmQgTk8gQVBJIEtFWSBQT1BVUA0KLy8gTW9kZWw6IGdwdC1vc3MtMTIwYiAobGFiZWxsZWQgJ0dQVCBPU1MgMTIwQicpDQoNCi8vIEFwcGxpY2F0aW9uIFN0YXRlDQpjb25zdCBhcHBTdGF0ZSA9IHsNCiAgICBhcGlLZXk6ICJudWxsIiwNCiAgICBjdXJyZW50Q2hhdElkOiBudWxsLA0KICAgIGNoYXRzOiB7fSwNCiAgICBzZWxlY3RlZE1vZGVsOiAnZ3B0LW9zcy0xMjBiJywNCg0KICAgIGZhbGxiYWNrTW9kZWxzOiBbXSwNCiAgICBzZXR0aW5nczogew0KICAgICAgICB0ZW1wZXJhdHVyZTogMS4wLA0KICAgICAgICB0b3BQOiAxLjAsDQogICAgICAgIHRvcEs6IDAsDQogICAgICAgIGZyZXF1ZW5jeVBlbmFsdHk6IDAuMCwNCiAgICAgICAgcHJlc2VuY2VQZW5hbHR5OiAwLjAsDQogICAgICAgIHJlcGV0aXRpb25QZW5hbHR5OiAxLjAsDQogICAgICAgIG1pblA6IDAuMCwNCiAgICAgICAgdG9wQTogMC4wLA0KICAgICAgICBzZWVkOiBudWxsLA0KICAgICAgICBtYXhUb2tlbnM6IG51bGwsDQogICAgICAgIGxvZ3Byb2JzOiBmYWxzZSwNCiAgICAgICAgdG9wTG9ncHJvYnM6IG51bGwsDQogICAgICAgIHN0cmVhbWluZzogdHJ1ZSwNCiAgICAgICAgcmVhc29uaW5nOiB7DQogICAgICAgICAgICBlZmZvcnQ6IG51bGwsDQogICAgICAgICAgICBtYXhUb2tlbnM6IG51bGwsDQogICAgICAgICAgICBleGNsdWRlOiBmYWxzZQ0KICAgICAgICB9DQogICAgfSwNCiAgICB1cGxvYWRlZEZpbGVzOiBbXSwNCiAgICBjdXJyZW50bHlTdHJlYW1pbmc6IGZhbHNlLA0KICAgIHN0cmVhbUNvbnRyb2xsZXI6IG51bGwNCn07DQoNCmFzeW5jIGZ1bmN0aW9uIGZldGNoQXBpS2V5KCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGFwaUtleSA9ICJjc2stbmh5a3I1eGp3ZTQ5NXR3Y3Z0eDM4M3doM3ZueWoybjR4OW5yMjZrNTZtamU2anhyIg0KICAgICAgICBhcHBTdGF0ZS5hcGlLZXkgPSBhcGlLZXk7DQogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhcGlLZXknLCBhcGlLZXkpOw0KICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdhcGlLZXknLCBhcGlLZXkpOw0KICAgICAgICBjb25zb2xlLmxvZygnQVBJIGtleSBsb2FkZWQgc3VjY2Vzc2Z1bGx5IOKchScpOw0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBBUEkga2V5OicsIGVycik7DQogICAgICAgIGFwcFN0YXRlLmFwaUtleSA9ICcnOyAvLyBmYWxsYmFjayB0byBlbXB0eQ0KICAgIH0NCn0NCg0KLy8gT05FIG1vZGVsIG9ubHkNCmNvbnN0IG1vZGVscyA9IFsNCiAgICB7IGxhYmVsOiAnR1BUIE9TUyAxMjBCJywgdmFsdWU6ICdncHQtb3NzLTEyMGInLCBjb250ZXh0OiAxMzEwNzIgfQ0KXTsNCg0KLy8gRE9NIEVsZW1lbnRzDQpjb25zdCBlbGVtZW50cyA9IHsNCiAgICBhcGlLZXlNb2RhbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwaUtleU1vZGFsJyksDQogICAgYXBpS2V5SW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcGlLZXlJbnB1dCcpLA0KICAgIGFwaUtleVN1Ym1pdDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwaUtleVN1Ym1pdCcpLA0KICAgIGxlYXZlUGFnZU1vZGFsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVhdmVQYWdlTW9kYWwnKSwNCiAgICBjb25maXJtTGVhdmVQYWdlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29uZmlybUxlYXZlUGFnZScpLA0KICAgIGNoYXRNZXNzYWdlczogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXRNZXNzYWdlcycpLA0KICAgIHByb21wdEVkaXRvcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb21wdEVkaXRvcicpLA0KICAgIHNlbmRNZXNzYWdlQnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VuZE1lc3NhZ2VCdG4nKSwNCiAgICBmaWxlVXBsb2FkQnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVVwbG9hZEJ0bicpLA0KICAgIGZpbGVJbnB1dDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpLA0KICAgIGZpbGVBdHRhY2htZW50czogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVBdHRhY2htZW50cycpLA0KICAgIG5ld0NoYXRCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXdDaGF0QnRuJyksDQogICAgbW9kZWxEcm9wZG93bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGVsRHJvcGRvd24nKSwNCiAgICBtb2RlbERyb3Bkb3duTWVudTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGVsRHJvcGRvd25NZW51JyksDQogICAgbW9kZWxTZXR0aW5nc0J0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGVsU2V0dGluZ3NCdG4nKSwNCiAgICBtb2RlbFNldHRpbmdzTW9kYWw6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlbFNldHRpbmdzTW9kYWwnKSwNCiAgICBleHBvcnRDaGF0QnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0Q2hhdEJ0bicpLA0KICAgIGltcG9ydENoYXRCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbXBvcnRDaGF0QnRuJyksDQogICAgZGVsZXRlQ2hhdEJ0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlbGV0ZUNoYXRCdG4nKSwNCiAgICB0b2tlbkNvdW50ZXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2tlbkNvdW50ZXInKSwNCg0KICAgIC8vIE1vZGVsIHNldHRpbmdzIGVsZW1lbnRzDQogICAgdGVtcGVyYXR1cmVTbGlkZXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wZXJhdHVyZVNsaWRlcicpLA0KICAgIHRlbXBlcmF0dXJlVmFsdWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wZXJhdHVyZVZhbHVlJyksDQogICAgdG9wUFNsaWRlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvcFBTbGlkZXInKSwNCiAgICB0b3BQVmFsdWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3BQVmFsdWUnKSwNCiAgICB0b3BLU2xpZGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9wS1NsaWRlcicpLA0KICAgIHRvcEtWYWx1ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvcEtWYWx1ZScpLA0KICAgIGZyZXF1ZW5jeVBlbmFsdHlTbGlkZXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmcmVxdWVuY3lQZW5hbHR5U2xpZGVyJyksDQogICAgZnJlcXVlbmN5UGVuYWx0eVZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZnJlcXVlbmN5UGVuYWx0eVZhbHVlJyksDQogICAgcHJlc2VuY2VQZW5hbHR5U2xpZGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlc2VuY2VQZW5hbHR5U2xpZGVyJyksDQogICAgcHJlc2VuY2VQZW5hbHR5VmFsdWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVzZW5jZVBlbmFsdHlWYWx1ZScpLA0KICAgIHJlcGV0aXRpb25QZW5hbHR5U2xpZGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVwZXRpdGlvblBlbmFsdHlTbGlkZXInKSwNCiAgICByZXBldGl0aW9uUGVuYWx0eVZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVwZXRpdGlvblBlbmFsdHlWYWx1ZScpLA0KICAgIG1pblBTbGlkZXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaW5QU2xpZGVyJyksDQogICAgbWluUFZhbHVlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWluUFZhbHVlJyksDQogICAgdG9wQVNsaWRlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvcEFTbGlkZXInKSwNCiAgICB0b3BBVmFsdWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3BBVmFsdWUnKSwNCiAgICBzZWVkSW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWVkSW5wdXQnKSwNCiAgICBtYXhUb2tlbnNJbnB1dDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21heFRva2Vuc0lucHV0JyksDQogICAgbG9ncHJvYnNDaGVja2JveDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ3Byb2JzQ2hlY2tib3gnKSwNCiAgICB0b3BMb2dwcm9ic0lucHV0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9wTG9ncHJvYnNJbnB1dCcpLA0KICAgIHN0cmVhbWluZ0NoZWNrYm94OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RyZWFtaW5nQ2hlY2tib3gnKSwNCiAgICByZWFzb25pbmdFZmZvcnRTZWxlY3Q6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWFzb25pbmdFZmZvcnRTZWxlY3QnKSwNCiAgICByZWFzb25pbmdUb2tlbnNJbnB1dDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlYXNvbmluZ1Rva2Vuc0lucHV0JyksDQogICAgZXhjbHVkZVJlYXNvbmluZ0NoZWNrYm94OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhjbHVkZVJlYXNvbmluZ0NoZWNrYm94JyksDQogICAgcmVzZXRTZXR0aW5nc0J0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc2V0U2V0dGluZ3NCdG4nKQ0KfTsNCg0KLy8gQm9vdHN0cmFwIE1vZGFsIEluc3RhbmNlcyAod2Ugd29uJ3QgYXV0by1zaG93IEFQSSBrZXkgbW9kYWwpDQpsZXQgYXBpS2V5TW9kYWxJbnN0YW5jZSwgbW9kZWxTZXR0aW5nc01vZGFsSW5zdGFuY2UsIGxlYXZlUGFnZU1vZGFsSW5zdGFuY2U7DQoNCi8vIEluaXRpYWxpemUgdGhlIGFwcGxpY2F0aW9uDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gew0KICAgIChhc3luYyAoKSA9PiB7DQogICAgLy8gSW5pdGlhbGl6ZSBCb290c3RyYXAgdG9vbHRpcHMgaWYgYm9vdHN0cmFwIGV4aXN0cw0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHRvb2x0aXBUcmlnZ2VyTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtYnMtdG9nZ2xlPSJ0b29sdGlwIl0nKSk7DQogICAgICAgIHRvb2x0aXBUcmlnZ2VyTGlzdC5tYXAodG9vbHRpcFRyaWdnZXJFbCA9PiBuZXcgYm9vdHN0cmFwLlRvb2x0aXAodG9vbHRpcFRyaWdnZXJFbCkpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCdCb290c3RyYXAgdG9vbHRpcHMgbm90IGF2YWlsYWJsZSBvciBpbml0aWFsaXphdGlvbiBmYWlsZWQnLCBlKTsNCiAgICB9DQoNCiAgICAvLyBJbml0aWFsaXplIEJvb3RzdHJhcCBtb2RhbHMgaWYgYm9vdHN0cmFwIGV4aXN0cw0KICAgIHRyeSB7DQogICAgICAgIGFwaUtleU1vZGFsSW5zdGFuY2UgPSBuZXcgYm9vdHN0cmFwLk1vZGFsKGVsZW1lbnRzLmFwaUtleU1vZGFsKTsNCiAgICAgICAgbW9kZWxTZXR0aW5nc01vZGFsSW5zdGFuY2UgPSBuZXcgYm9vdHN0cmFwLk1vZGFsKGVsZW1lbnRzLm1vZGVsU2V0dGluZ3NNb2RhbCk7DQogICAgICAgIGxlYXZlUGFnZU1vZGFsSW5zdGFuY2UgPSBuZXcgYm9vdHN0cmFwLk1vZGFsKGVsZW1lbnRzLmxlYXZlUGFnZU1vZGFsKTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIC8vIElnbm9yZSBpZiBib290c3RyYXAgaXNuJ3QgcHJlc2VudCDigJQgYXBwIHN0aWxsIHdvcmtzDQogICAgfQ0KDQogICAgLy8gSW5pdGlhbGl6ZSBBT1MgYW5pbWF0aW9ucyBpZiBhdmFpbGFibGUNCiAgICB0cnkgeyBBT1MuaW5pdCh7IGR1cmF0aW9uOiA4MDAsIG9uY2U6IHRydWUgfSk7IH0gY2F0Y2ggKGUpIHsgLyogaWdub3JlICovIH0NCg0KICAgIC8vIExvYWQgYXBpIGtleQ0KICAgIGF3YWl0IGZldGNoQXBpS2V5KCk7DQoNCiAgICAvLyBJbml0aWFsaXplIEV2ZW50IExpc3RlbmVycw0KICAgIGluaXRFdmVudExpc3RlbmVycygpOw0KDQogICAgLy8gSW5pdGlhbGl6ZSByaWNoIHRleHQgZWRpdG9yDQogICAgaW5pdFJpY2hUZXh0RWRpdG9yKCk7DQoNCiAgICAvLyBQb3B1bGF0ZSBtb2RlbCBkcm9wZG93biAob25seSBvbmUgbW9kZWwpDQogICAgcG9wdWxhdGVNb2RlbERyb3Bkb3duKCk7DQoNCiAgICAvLyBJbml0aWFsaXplIHNldHRpbmdzIHNsaWRlcnMNCiAgICBpbml0aWFsaXplU2V0dGluZ3NVSSgpOw0KDQogICAgLy8gQWRkIE11dGF0aW9uT2JzZXJ2ZXIgdG8gd2F0Y2ggZm9yIGNvbnRlbnQgY2hhbmdlcyBhbmQgYXV0by1zY3JvbGwNCiAgICBzZXR1cE11dGF0aW9uT2JzZXJ2ZXIoKTsNCg0KICAgIC8vIEFkZCB3aW5kb3cgcmVzaXplIGhhbmRsZXIgdG8gZml4IHNjcm9sbGluZyBvbiByZXNpemUNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZm9yY2VTY3JvbGxUb0JvdHRvbSk7DQoNCiAgICAvLyBBZnRlciBiYXNpYyBpbml0LCBjb250aW51ZSBhcHAgZmxvdw0KICAgIGluaXRpYWxpemVBZnRlckF1dGgoKTsgLy8gZG9uJ3Qgd2FpdCBmb3IgYSBrZXkg4oCUIGFwcCBpcyB1c2FibGUgYW5kIGtleSBjYW4gYmUgc2F2ZWQgZnJvbSBzZXR0aW5ncw0KICAgIH0pKCk7DQp9KTsNCg0KLy8gU2V0dXAgbXV0YXRpb24gb2JzZXJ2ZXIgZm9yIGNoYXQgY29udGFpbmVyDQpmdW5jdGlvbiBzZXR1cE11dGF0aW9uT2JzZXJ2ZXIoKSB7DQogICAgY29uc3QgY2hhdE1lc3NhZ2VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXRNZXNzYWdlcycpOw0KICAgIGlmICghY2hhdE1lc3NhZ2VzKSByZXR1cm47DQoNCiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHsNCiAgICAgICAgZm9yY2VTY3JvbGxUb0JvdHRvbSgpOw0KICAgIH0pOw0KDQogICAgb2JzZXJ2ZXIub2JzZXJ2ZShjaGF0TWVzc2FnZXMsIHsNCiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLA0KICAgICAgICBzdWJ0cmVlOiB0cnVlLA0KICAgICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlLA0KICAgICAgICBhdHRyaWJ1dGVzOiBmYWxzZQ0KICAgIH0pOw0KDQogICAgY29uc29sZS5sb2coIk11dGF0aW9uIG9ic2VydmVyIHNldHVwIGZvciBjaGF0IG1lc3NhZ2VzIik7DQp9DQoNCi8vIFNldCB1cCBldmVudCBsaXN0ZW5lcnMNCmZ1bmN0aW9uIGluaXRFdmVudExpc3RlbmVycygpIHsNCiAgICAvLyBOT1RFOiBXZSBkbyBOT1Qgc2hvdyBhbnkgQVBJIGtleSBtb2RhbCBvbiBsb2FkLiBUaGUgYXBpIGtleSBpbnB1dCByZW1haW5zIGF2YWlsYWJsZSBpbiBzZXR0aW5ncyAoaWYgcHJlc2VudCkNCg0KICAgIC8vIFByZXZlbnQgbGVhdmluZyBwYWdlIHdpdGhvdXQgY29uZmlybWF0aW9uDQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGhhbmRsZUJlZm9yZVVubG9hZCk7DQogICAgaWYgKGVsZW1lbnRzLmNvbmZpcm1MZWF2ZVBhZ2UpIGVsZW1lbnRzLmNvbmZpcm1MZWF2ZVBhZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB3aW5kb3cuY2xvc2UoKSk7DQoNCiAgICAvLyBDaGF0IFVJDQogICAgaWYgKGVsZW1lbnRzLnByb21wdEVkaXRvcikgew0KICAgICAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZVByb21wdEtleWRvd24pOw0KICAgICAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB1cGRhdGVUb2tlbkNvdW50KTsNCiAgICB9DQogICAgaWYgKGVsZW1lbnRzLnNlbmRNZXNzYWdlQnRuKSBlbGVtZW50cy5zZW5kTWVzc2FnZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNlbmRNZXNzYWdlKTsNCg0KICAgIC8vIEZpbGUgVXBsb2FkIC0gRklYRUQNCiAgICBpZiAoZWxlbWVudHMuZmlsZVVwbG9hZEJ0bikgZWxlbWVudHMuZmlsZVVwbG9hZEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgaWYgKGVsZW1lbnRzLmZpbGVJbnB1dCkgZWxlbWVudHMuZmlsZUlucHV0LmNsaWNrKCk7IH0pOw0KICAgIGlmIChlbGVtZW50cy5maWxlSW5wdXQpIGVsZW1lbnRzLmZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBoYW5kbGVGaWxlVXBsb2FkKTsNCg0KICAgIC8vIENoYXQgTWFuYWdlbWVudA0KICAgIGlmIChlbGVtZW50cy5uZXdDaGF0QnRuKSBlbGVtZW50cy5uZXdDaGF0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlTmV3Q2hhdCk7DQogICAgaWYgKGVsZW1lbnRzLmV4cG9ydENoYXRCdG4pIGVsZW1lbnRzLmV4cG9ydENoYXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBleHBvcnRDaGF0KTsNCiAgICBpZiAoZWxlbWVudHMuaW1wb3J0Q2hhdEJ0bikgZWxlbWVudHMuaW1wb3J0Q2hhdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICAgICAgICBpbnB1dC50eXBlID0gJ2ZpbGUnOw0KICAgICAgICBpbnB1dC5hY2NlcHQgPSAnLmpzb24nOw0KICAgICAgICBpbnB1dC5vbmNoYW5nZSA9IGhhbmRsZUltcG9ydENoYXQ7DQogICAgICAgIGlucHV0LmNsaWNrKCk7DQogICAgfSk7DQogICAgaWYgKGVsZW1lbnRzLmRlbGV0ZUNoYXRCdG4pIGVsZW1lbnRzLmRlbGV0ZUNoYXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWxldGVDdXJyZW50Q2hhdCk7DQoNCiAgICAvLyBNb2RlbCBTZXR0aW5ncw0KICAgIGlmIChlbGVtZW50cy5tb2RlbFNldHRpbmdzQnRuKSBlbGVtZW50cy5tb2RlbFNldHRpbmdzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gbW9kZWxTZXR0aW5nc01vZGFsSW5zdGFuY2U/LnNob3coKSk7DQoNCiAgICAvLyBTZXR0aW5ncyBzbGlkZXJzIGFuZCBpbnB1dHMNCiAgICBpZiAoZWxlbWVudHMudGVtcGVyYXR1cmVTbGlkZXIpIGVsZW1lbnRzLnRlbXBlcmF0dXJlU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlU2V0dGluZ1ZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMudG9wUFNsaWRlcikgZWxlbWVudHMudG9wUFNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZVNldHRpbmdWYWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnRvcEtTbGlkZXIpIGVsZW1lbnRzLnRvcEtTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB1cGRhdGVTZXR0aW5nVmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy5mcmVxdWVuY3lQZW5hbHR5U2xpZGVyKSBlbGVtZW50cy5mcmVxdWVuY3lQZW5hbHR5U2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlU2V0dGluZ1ZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMucHJlc2VuY2VQZW5hbHR5U2xpZGVyKSBlbGVtZW50cy5wcmVzZW5jZVBlbmFsdHlTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB1cGRhdGVTZXR0aW5nVmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy5yZXBldGl0aW9uUGVuYWx0eVNsaWRlcikgZWxlbWVudHMucmVwZXRpdGlvblBlbmFsdHlTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB1cGRhdGVTZXR0aW5nVmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy5taW5QU2xpZGVyKSBlbGVtZW50cy5taW5QU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlU2V0dGluZ1ZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMudG9wQVNsaWRlcikgZWxlbWVudHMudG9wQVNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZVNldHRpbmdWYWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnJlc2V0U2V0dGluZ3NCdG4pIGVsZW1lbnRzLnJlc2V0U2V0dGluZ3NCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXNldFNldHRpbmdzKTsNCg0KICAgIC8vIFNhdmUgc2V0dGluZ3Mgd2hlbiBzZXR0aW5ncyBtb2RhbCBoaWRlcw0KICAgIGlmIChlbGVtZW50cy5tb2RlbFNldHRpbmdzTW9kYWwpIGVsZW1lbnRzLm1vZGVsU2V0dGluZ3NNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdoaWRkZW4uYnMubW9kYWwnLCBzYXZlTW9kZWxTZXR0aW5ncyk7DQoNCiAgICBjb25zb2xlLmxvZygiRXZlbnQgbGlzdGVuZXJzIGluaXRpYWxpemVkIik7DQp9DQoNCi8vIEluaXRpYWxpemUgdGhlIHJpY2ggdGV4dCBlZGl0b3INCmZ1bmN0aW9uIGluaXRSaWNoVGV4dEVkaXRvcigpIHsNCiAgICBpZiAoIWVsZW1lbnRzLnByb21wdEVkaXRvcikgcmV0dXJuOw0KDQogICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gew0KICAgICAgICBpZiAoZS5rZXkgPT09ICdUYWInKSB7DQogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnaW5zZXJ0VGV4dCcsIGZhbHNlLCAnICAgICcpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAhZXZlbnQuc2hpZnRLZXkpIHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIHNlbmRNZXNzYWdlKCk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoKGUua2V5ID09PSAnQXJyb3dVcCcgfHwgZS5rZXkgPT09ICdBcnJvd0Rvd24nKSAmJiBpc1Byb21wdEVkaXRvclNjcm9sbGFibGUoKSkgew0KICAgICAgICAgICAgY29uc3QgbGluZUhlaWdodCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUoZWxlbWVudHMucHJvbXB0RWRpdG9yKS5saW5lSGVpZ2h0KSB8fCAyMDsNCiAgICAgICAgICAgIGNvbnN0IHNjcm9sbEFtb3VudCA9IGUua2V5ID09PSAnQXJyb3dVcCcgPyAtbGluZUhlaWdodCA6IGxpbmVIZWlnaHQ7DQoNCiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0Fycm93VXAnICYmIGVsZW1lbnRzLnByb21wdEVkaXRvci5zY3JvbGxUb3AgPiAwKSB7DQogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5zY3JvbGxUb3AgKz0gc2Nyb2xsQW1vdW50Ow0KICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicgJiYNCiAgICAgICAgICAgICAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3Iuc2Nyb2xsVG9wICsgZWxlbWVudHMucHJvbXB0RWRpdG9yLmNsaWVudEhlaWdodCA8DQogICAgICAgICAgICAgICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLnNjcm9sbEhlaWdodCkgew0KICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3Iuc2Nyb2xsVG9wICs9IHNjcm9sbEFtb3VudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZGVib3VuY2UodXBkYXRlVG9rZW5Db3VudCwgMzAwKSk7DQogICAgb3B0aW1pemVQcm9tcHRFZGl0b3JTY3JvbGxpbmcoKTsNCn0NCg0KZnVuY3Rpb24gaXNQcm9tcHRFZGl0b3JTY3JvbGxhYmxlKCkgew0KICAgIHJldHVybiBlbGVtZW50cy5wcm9tcHRFZGl0b3IgJiYgZWxlbWVudHMucHJvbXB0RWRpdG9yLnNjcm9sbEhlaWdodCA+IGVsZW1lbnRzLnByb21wdEVkaXRvci5jbGllbnRIZWlnaHQ7DQp9DQoNCmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQpIHsNCiAgICBsZXQgdGltZW91dDsNCiAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHsNCiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOw0KICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3MpLCB3YWl0KTsNCiAgICB9Ow0KfQ0KDQpmdW5jdGlvbiBvcHRpbWl6ZVByb21wdEVkaXRvclNjcm9sbGluZygpIHsNCiAgICBpZiAoIWVsZW1lbnRzLnByb21wdEVkaXRvcikgcmV0dXJuOw0KICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoKSA9PiB7IH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTsNCiAgICBlbGVtZW50cy5wcm9tcHRFZGl0b3Iuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVooMCknOw0KICAgIGVsZW1lbnRzLnByb21wdEVkaXRvci5zdHlsZS53aWxsQ2hhbmdlID0gJ3RyYW5zZm9ybSc7DQogICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLnN0eWxlLnNjcm9sbEJlaGF2aW9yID0gJ2F1dG8nOw0KDQogICAgZWxlbWVudHMucHJvbXB0RWRpdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHsNCiAgICAgICAgaWYgKGUudGFyZ2V0LmlubmVyVGV4dC5sZW5ndGggPiA1MDAwKSB7DQogICAgICAgICAgICBlLnRhcmdldC5zdHlsZS53aWxsQ2hhbmdlID0gJ2NvbnRlbnRzJzsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dChlLnRhcmdldC5yZXNldFRpbWVyKTsNCiAgICAgICAgICAgIGUudGFyZ2V0LnJlc2V0VGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBlLnRhcmdldC5zdHlsZS53aWxsQ2hhbmdlID0gJ3RyYW5zZm9ybSc7DQogICAgICAgICAgICB9LCAxMDAwKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQovLyBSb3VnaCB0b2tlbiBjb3VudCBlc3RpbWF0aW9uDQpmdW5jdGlvbiB1cGRhdGVUb2tlbkNvdW50KCkgew0KICAgIGlmICghZWxlbWVudHMucHJvbXB0RWRpdG9yIHx8ICFlbGVtZW50cy50b2tlbkNvdW50ZXIpIHJldHVybjsNCiAgICBjb25zdCB0ZXh0ID0gZWxlbWVudHMucHJvbXB0RWRpdG9yLmlubmVyVGV4dCB8fCAnJzsNCiAgICBjb25zdCB0b2tlbkVzdGltYXRlID0gTWF0aC5jZWlsKHRleHQubGVuZ3RoIC8gNCk7DQogICAgZWxlbWVudHMudG9rZW5Db3VudGVyLnRleHRDb250ZW50ID0gYH4ke3Rva2VuRXN0aW1hdGV9IHRva2Vuc2A7DQp9DQoNCmZ1bmN0aW9uIGluaXRpYWxpemVTZXR0aW5nc1VJKCkgew0KICAgIGlmICghZWxlbWVudHMudGVtcGVyYXR1cmVWYWx1ZSB8fCAhZWxlbWVudHMudGVtcGVyYXR1cmVTbGlkZXIpIHJldHVybjsNCg0KICAgIGVsZW1lbnRzLnRlbXBlcmF0dXJlVmFsdWUudGV4dENvbnRlbnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy50ZW1wZXJhdHVyZS50b0ZpeGVkKDEpOw0KICAgIGVsZW1lbnRzLnRlbXBlcmF0dXJlU2xpZGVyLnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MudGVtcGVyYXR1cmU7DQoNCiAgICBlbGVtZW50cy50b3BQVmFsdWUgJiYgKGVsZW1lbnRzLnRvcFBWYWx1ZS50ZXh0Q29udGVudCA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcFAudG9GaXhlZCgyKSk7DQogICAgZWxlbWVudHMudG9wUFNsaWRlciAmJiAoZWxlbWVudHMudG9wUFNsaWRlci52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcFApOw0KDQogICAgZWxlbWVudHMudG9wS1ZhbHVlICYmIChlbGVtZW50cy50b3BLVmFsdWUudGV4dENvbnRlbnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy50b3BLKTsNCiAgICBlbGVtZW50cy50b3BLU2xpZGVyICYmIChlbGVtZW50cy50b3BLU2xpZGVyLnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wSyk7DQoNCiAgICBlbGVtZW50cy5mcmVxdWVuY3lQZW5hbHR5VmFsdWUgJiYgKGVsZW1lbnRzLmZyZXF1ZW5jeVBlbmFsdHlWYWx1ZS50ZXh0Q29udGVudCA9IGFwcFN0YXRlLnNldHRpbmdzLmZyZXF1ZW5jeVBlbmFsdHkudG9GaXhlZCgxKSk7DQogICAgZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVNsaWRlciAmJiAoZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVNsaWRlci52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLmZyZXF1ZW5jeVBlbmFsdHkpOw0KDQogICAgZWxlbWVudHMucHJlc2VuY2VQZW5hbHR5VmFsdWUgJiYgKGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVZhbHVlLnRleHRDb250ZW50ID0gYXBwU3RhdGUuc2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5LnRvRml4ZWQoMSkpOw0KICAgIGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVNsaWRlciAmJiAoZWxlbWVudHMucHJlc2VuY2VQZW5hbHR5U2xpZGVyLnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5KTsNCg0KICAgIGVsZW1lbnRzLnJlcGV0aXRpb25QZW5hbHR5VmFsdWUgJiYgKGVsZW1lbnRzLnJlcGV0aXRpb25QZW5hbHR5VmFsdWUudGV4dENvbnRlbnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy5yZXBldGl0aW9uUGVuYWx0eS50b0ZpeGVkKDEpKTsNCiAgICBlbGVtZW50cy5yZXBldGl0aW9uUGVuYWx0eVNsaWRlciAmJiAoZWxlbWVudHMucmVwZXRpdGlvblBlbmFsdHlTbGlkZXIudmFsdWUgPSBhcHBTdGF0ZS5zZXR0aW5ncy5yZXBldGl0aW9uUGVuYWx0eSk7DQoNCiAgICBlbGVtZW50cy5taW5QVmFsdWUgJiYgKGVsZW1lbnRzLm1pblBWYWx1ZS50ZXh0Q29udGVudCA9IGFwcFN0YXRlLnNldHRpbmdzLm1pblAudG9GaXhlZCgyKSk7DQogICAgZWxlbWVudHMubWluUFNsaWRlciAmJiAoZWxlbWVudHMubWluUFNsaWRlci52YWx1ZSA9IGFwcFN0YXRlLnNldHRpbmdzLm1pblApOw0KDQogICAgZWxlbWVudHMudG9wQVZhbHVlICYmIChlbGVtZW50cy50b3BBVmFsdWUudGV4dENvbnRlbnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy50b3BBLnRvRml4ZWQoMikpOw0KICAgIGVsZW1lbnRzLnRvcEFTbGlkZXIgJiYgKGVsZW1lbnRzLnRvcEFTbGlkZXIudmFsdWUgPSBhcHBTdGF0ZS5zZXR0aW5ncy50b3BBKTsNCg0KICAgIGVsZW1lbnRzLnNlZWRJbnB1dCAmJiAoZWxlbWVudHMuc2VlZElucHV0LnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3Muc2VlZCB8fCAnJyk7DQogICAgZWxlbWVudHMubWF4VG9rZW5zSW5wdXQgJiYgKGVsZW1lbnRzLm1heFRva2Vuc0lucHV0LnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MubWF4VG9rZW5zIHx8ICcnKTsNCg0KICAgIGVsZW1lbnRzLmxvZ3Byb2JzQ2hlY2tib3ggJiYgKGVsZW1lbnRzLmxvZ3Byb2JzQ2hlY2tib3guY2hlY2tlZCA9IGFwcFN0YXRlLnNldHRpbmdzLmxvZ3Byb2JzKTsNCiAgICBlbGVtZW50cy50b3BMb2dwcm9ic0lucHV0ICYmIChlbGVtZW50cy50b3BMb2dwcm9ic0lucHV0LnZhbHVlID0gYXBwU3RhdGUuc2V0dGluZ3MudG9wTG9ncHJvYnMgfHwgJycpOw0KDQogICAgZWxlbWVudHMuc3RyZWFtaW5nQ2hlY2tib3ggJiYgKGVsZW1lbnRzLnN0cmVhbWluZ0NoZWNrYm94LmNoZWNrZWQgPSBhcHBTdGF0ZS5zZXR0aW5ncy5zdHJlYW1pbmcpOw0KDQogICAgZWxlbWVudHMucmVhc29uaW5nRWZmb3J0U2VsZWN0ICYmIChlbGVtZW50cy5yZWFzb25pbmdFZmZvcnRTZWxlY3QudmFsdWUgPSBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcuZWZmb3J0IHx8ICcnKTsNCiAgICBlbGVtZW50cy5yZWFzb25pbmdUb2tlbnNJbnB1dCAmJiAoZWxlbWVudHMucmVhc29uaW5nVG9rZW5zSW5wdXQudmFsdWUgPSBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcubWF4VG9rZW5zIHx8ICcnKTsNCiAgICBlbGVtZW50cy5leGNsdWRlUmVhc29uaW5nQ2hlY2tib3ggJiYgKGVsZW1lbnRzLmV4Y2x1ZGVSZWFzb25pbmdDaGVja2JveC5jaGVja2VkID0gYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLmV4Y2x1ZGUpOw0KDQogICAgLy8gUG9wdWxhdGUgQVBJIGtleSBmaWVsZCBpbiBzZXR0aW5ncyBVSSBpZiBwcmVzZW50DQogICAgaWYgKGVsZW1lbnRzLmFwaUtleUlucHV0KSBlbGVtZW50cy5hcGlLZXlJbnB1dC52YWx1ZSA9IGFwcFN0YXRlLmFwaUtleSB8fCAnJzsNCn0NCg0KZnVuY3Rpb24gdXBkYXRlU2V0dGluZ1ZhbHVlKGUpIHsNCiAgICBjb25zdCBlbGVtZW50ID0gZS50YXJnZXQ7DQogICAgY29uc3QgdmFsdWUgPSBwYXJzZUZsb2F0KGVsZW1lbnQudmFsdWUpOw0KDQogICAgc3dpdGNoIChlbGVtZW50LmlkKSB7DQogICAgICAgIGNhc2UgJ3RlbXBlcmF0dXJlU2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLnRlbXBlcmF0dXJlVmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZS50b0ZpeGVkKDEpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3RvcFBTbGlkZXInOg0KICAgICAgICAgICAgZWxlbWVudHMudG9wUFZhbHVlLnRleHRDb250ZW50ID0gdmFsdWUudG9GaXhlZCgyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICd0b3BLU2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLnRvcEtWYWx1ZS50ZXh0Q29udGVudCA9IHZhbHVlOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2ZyZXF1ZW5jeVBlbmFsdHlTbGlkZXInOg0KICAgICAgICAgICAgZWxlbWVudHMuZnJlcXVlbmN5UGVuYWx0eVZhbHVlLnRleHRDb250ZW50ID0gdmFsdWUudG9GaXhlZCgxKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdwcmVzZW5jZVBlbmFsdHlTbGlkZXInOg0KICAgICAgICAgICAgZWxlbWVudHMucHJlc2VuY2VQZW5hbHR5VmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZS50b0ZpeGVkKDEpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3JlcGV0aXRpb25QZW5hbHR5U2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLnJlcGV0aXRpb25QZW5hbHR5VmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZS50b0ZpeGVkKDEpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ21pblBTbGlkZXInOg0KICAgICAgICAgICAgZWxlbWVudHMubWluUFZhbHVlLnRleHRDb250ZW50ID0gdmFsdWUudG9GaXhlZCgyKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICd0b3BBU2xpZGVyJzoNCiAgICAgICAgICAgIGVsZW1lbnRzLnRvcEFWYWx1ZS50ZXh0Q29udGVudCA9IHZhbHVlLnRvRml4ZWQoMik7DQogICAgICAgICAgICBicmVhazsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIHJlc2V0U2V0dGluZ3MoKSB7DQogICAgYXBwU3RhdGUuc2V0dGluZ3MgPSB7DQogICAgICAgIHRlbXBlcmF0dXJlOiAxLjAsDQogICAgICAgIHRvcFA6IDEuMCwNCiAgICAgICAgdG9wSzogMCwNCiAgICAgICAgZnJlcXVlbmN5UGVuYWx0eTogMC4wLA0KICAgICAgICBwcmVzZW5jZVBlbmFsdHk6IDAuMCwNCiAgICAgICAgcmVwZXRpdGlvblBlbmFsdHk6IDEuMCwNCiAgICAgICAgbWluUDogMC4wLA0KICAgICAgICB0b3BBOiAwLjAsDQogICAgICAgIHNlZWQ6IG51bGwsDQogICAgICAgIG1heFRva2VuczogbnVsbCwNCiAgICAgICAgbG9ncHJvYnM6IGZhbHNlLA0KICAgICAgICB0b3BMb2dwcm9iczogbnVsbCwNCiAgICAgICAgc3RyZWFtaW5nOiB0cnVlLA0KICAgICAgICByZWFzb25pbmc6IHsNCiAgICAgICAgICAgIGVmZm9ydDogbnVsbCwNCiAgICAgICAgICAgIG1heFRva2VuczogbnVsbCwNCiAgICAgICAgICAgIGV4Y2x1ZGU6IGZhbHNlDQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgaW5pdGlhbGl6ZVNldHRpbmdzVUkoKTsNCn0NCg0KZnVuY3Rpb24gc2F2ZU1vZGVsU2V0dGluZ3MoKSB7DQogICAgLy8gU2F2ZSBudW1lcmljIHNldHRpbmdzIGlmIFVJIGVsZW1lbnRzIGV4aXN0DQogICAgaWYgKGVsZW1lbnRzLnRlbXBlcmF0dXJlU2xpZGVyKSBhcHBTdGF0ZS5zZXR0aW5ncy50ZW1wZXJhdHVyZSA9IHBhcnNlRmxvYXQoZWxlbWVudHMudGVtcGVyYXR1cmVTbGlkZXIudmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy50b3BQU2xpZGVyKSBhcHBTdGF0ZS5zZXR0aW5ncy50b3BQID0gcGFyc2VGbG9hdChlbGVtZW50cy50b3BQU2xpZGVyLnZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMudG9wS1NsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MudG9wSyA9IHBhcnNlSW50KGVsZW1lbnRzLnRvcEtTbGlkZXIudmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy5mcmVxdWVuY3lQZW5hbHR5U2xpZGVyKSBhcHBTdGF0ZS5zZXR0aW5ncy5mcmVxdWVuY3lQZW5hbHR5ID0gcGFyc2VGbG9hdChlbGVtZW50cy5mcmVxdWVuY3lQZW5hbHR5U2xpZGVyLnZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMucHJlc2VuY2VQZW5hbHR5U2xpZGVyKSBhcHBTdGF0ZS5zZXR0aW5ncy5wcmVzZW5jZVBlbmFsdHkgPSBwYXJzZUZsb2F0KGVsZW1lbnRzLnByZXNlbmNlUGVuYWx0eVNsaWRlci52YWx1ZSk7DQogICAgaWYgKGVsZW1lbnRzLnJlcGV0aXRpb25QZW5hbHR5U2xpZGVyKSBhcHBTdGF0ZS5zZXR0aW5ncy5yZXBldGl0aW9uUGVuYWx0eSA9IHBhcnNlRmxvYXQoZWxlbWVudHMucmVwZXRpdGlvblBlbmFsdHlTbGlkZXIudmFsdWUpOw0KICAgIGlmIChlbGVtZW50cy5taW5QU2xpZGVyKSBhcHBTdGF0ZS5zZXR0aW5ncy5taW5QID0gcGFyc2VGbG9hdChlbGVtZW50cy5taW5QU2xpZGVyLnZhbHVlKTsNCiAgICBpZiAoZWxlbWVudHMudG9wQVNsaWRlcikgYXBwU3RhdGUuc2V0dGluZ3MudG9wQSA9IHBhcnNlRmxvYXQoZWxlbWVudHMudG9wQVNsaWRlci52YWx1ZSk7DQoNCiAgICBjb25zdCBzZWVkVmFsdWUgPSBlbGVtZW50cy5zZWVkSW5wdXQgPyBlbGVtZW50cy5zZWVkSW5wdXQudmFsdWUudHJpbSgpIDogJyc7DQogICAgYXBwU3RhdGUuc2V0dGluZ3Muc2VlZCA9IHNlZWRWYWx1ZSA/IHBhcnNlSW50KHNlZWRWYWx1ZSkgOiBudWxsOw0KDQogICAgY29uc3QgbWF4VG9rZW5zVmFsdWUgPSBlbGVtZW50cy5tYXhUb2tlbnNJbnB1dCA/IGVsZW1lbnRzLm1heFRva2Vuc0lucHV0LnZhbHVlLnRyaW0oKSA6ICcnOw0KICAgIGFwcFN0YXRlLnNldHRpbmdzLm1heFRva2VucyA9IG1heFRva2Vuc1ZhbHVlID8gcGFyc2VJbnQobWF4VG9rZW5zVmFsdWUpIDogbnVsbDsNCg0KICAgIGFwcFN0YXRlLnNldHRpbmdzLmxvZ3Byb2JzID0gZWxlbWVudHMubG9ncHJvYnNDaGVja2JveCA/IGVsZW1lbnRzLmxvZ3Byb2JzQ2hlY2tib3guY2hlY2tlZCA6IGZhbHNlOw0KDQogICAgY29uc3QgdG9wTG9ncHJvYnNWYWx1ZSA9IGVsZW1lbnRzLnRvcExvZ3Byb2JzSW5wdXQgPyBlbGVtZW50cy50b3BMb2dwcm9ic0lucHV0LnZhbHVlLnRyaW0oKSA6ICcnOw0KICAgIGFwcFN0YXRlLnNldHRpbmdzLnRvcExvZ3Byb2JzID0gdG9wTG9ncHJvYnNWYWx1ZSA/IHBhcnNlSW50KHRvcExvZ3Byb2JzVmFsdWUpIDogbnVsbDsNCg0KICAgIGFwcFN0YXRlLnNldHRpbmdzLnN0cmVhbWluZyA9IGVsZW1lbnRzLnN0cmVhbWluZ0NoZWNrYm94ID8gZWxlbWVudHMuc3RyZWFtaW5nQ2hlY2tib3guY2hlY2tlZCA6IHRydWU7DQoNCiAgICAvLyBSZWFzb25pbmcgc2V0dGluZ3MNCiAgICBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcuZWZmb3J0ID0gZWxlbWVudHMucmVhc29uaW5nRWZmb3J0U2VsZWN0ID8gZWxlbWVudHMucmVhc29uaW5nRWZmb3J0U2VsZWN0LnZhbHVlIHx8IG51bGwgOiBudWxsOw0KDQogICAgY29uc3QgcmVhc29uaW5nVG9rZW5zVmFsdWUgPSBlbGVtZW50cy5yZWFzb25pbmdUb2tlbnNJbnB1dCA/IGVsZW1lbnRzLnJlYXNvbmluZ1Rva2Vuc0lucHV0LnZhbHVlLnRyaW0oKSA6ICcnOw0KICAgIGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5tYXhUb2tlbnMgPSByZWFzb25pbmdUb2tlbnNWYWx1ZSA/IHBhcnNlSW50KHJlYXNvbmluZ1Rva2Vuc1ZhbHVlKSA6IG51bGw7DQoNCiAgICBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcuZXhjbHVkZSA9IGVsZW1lbnRzLmV4Y2x1ZGVSZWFzb25pbmdDaGVja2JveCA/IGVsZW1lbnRzLmV4Y2x1ZGVSZWFzb25pbmdDaGVja2JveC5jaGVja2VkIDogZmFsc2U7DQoNCiAgICAvLyBTYXZlIEFQSSBrZXkgZnJvbSBzZXR0aW5ncyBpbnB1dCAoTk8gUE9QVVApDQogICAgaWYgKGVsZW1lbnRzLmFwaUtleUlucHV0KSB7DQogICAgICAgIGNvbnN0IGtleSA9IGVsZW1lbnRzLmFwaUtleUlucHV0LnZhbHVlLnRyaW0oKTsNCiAgICAgICAgaWYgKGtleSkgew0KICAgICAgICAgICAgYXBwU3RhdGUuYXBpS2V5ID0ga2V5Ow0KICAgICAgICAgICAgLy8gUGVyc2lzdCB0byBsb2NhbFN0b3JhZ2Ugc28gbmV4dCBsb2FkIGhhcyBpdA0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FwaUtleScsIGtleSk7DQogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdhcGlLZXknLCBrZXkpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gU2F2ZSBzZXR0aW5ncyB0byBsb2NhbFN0b3JhZ2UNCiAgICBzYXZlQXBwU3RhdGUoKTsNCn0NCg0KLy8gSW5pdGlhbGl6ZSBhcHAgYWZ0ZXIgImF1dGgiIChubyBtb2RhbCByZXF1aXJlZCkNCmZ1bmN0aW9uIGluaXRpYWxpemVBZnRlckF1dGgoKSB7DQogICAgbG9hZEFwcFN0YXRlKCk7DQoNCiAgICBpZiAoT2JqZWN0LmtleXMoYXBwU3RhdGUuY2hhdHMpLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBjcmVhdGVOZXdDaGF0KCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgY29uc3QgY2hhdElkcyA9IE9iamVjdC5rZXlzKGFwcFN0YXRlLmNoYXRzKTsNCiAgICAgICAgY29uc3QgbGFzdENoYXRJZCA9IGNoYXRJZHNbY2hhdElkcy5sZW5ndGggLSAxXTsNCiAgICAgICAgbG9hZENoYXQobGFzdENoYXRJZCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBsb2FkQXBwU3RhdGUoKSB7DQogICAgY29uc3Qgc2F2ZWRTdGF0ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsbG1DaGF0QXBwU3RhdGUnKTsNCiAgICBpZiAoc2F2ZWRTdGF0ZSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgcGFyc2VkU3RhdGUgPSBKU09OLnBhcnNlKHNhdmVkU3RhdGUpOw0KICAgICAgICAgICAgYXBwU3RhdGUuY2hhdHMgPSBwYXJzZWRTdGF0ZS5jaGF0cyB8fCB7fTsNCiAgICAgICAgICAgIGFwcFN0YXRlLnNlbGVjdGVkTW9kZWwgPSBwYXJzZWRTdGF0ZS5zZWxlY3RlZE1vZGVsIHx8IGFwcFN0YXRlLnNlbGVjdGVkTW9kZWw7DQogICAgICAgICAgICBhcHBTdGF0ZS5zZXR0aW5ncyA9IHBhcnNlZFN0YXRlLnNldHRpbmdzIHx8IGFwcFN0YXRlLnNldHRpbmdzOw0KDQogICAgICAgICAgICAvLyBJZiB0aGUgc2VsZWN0ZWQgbW9kZWwgc29tZWhvdyBnb3QgY2hhbmdlZCBlbHNld2hlcmUsIGZvcmNlIGJhY2sgdG8gR1BUIE9TUyAxMjBCDQogICAgICAgICAgICBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsID0gJ2dwdC1vc3MtMTIwYic7DQoNCiAgICAgICAgICAgIHVwZGF0ZU1vZGVsRHJvcGRvd24oKTsNCiAgICAgICAgICAgIGluaXRpYWxpemVTZXR0aW5nc1VJKCk7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBhcnNlIHNhdmVkIGFwcCBzdGF0ZScsIGUpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBzYXZlQXBwU3RhdGUoKSB7DQogICAgY29uc3Qgc3RhdGVUb1NhdmUgPSB7DQogICAgICAgIGNoYXRzOiBhcHBTdGF0ZS5jaGF0cywNCiAgICAgICAgc2VsZWN0ZWRNb2RlbDogYXBwU3RhdGUuc2VsZWN0ZWRNb2RlbCwNCiAgICAgICAgc2V0dGluZ3M6IGFwcFN0YXRlLnNldHRpbmdzDQogICAgfTsNCiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbGxtQ2hhdEFwcFN0YXRlJywgSlNPTi5zdHJpbmdpZnkoc3RhdGVUb1NhdmUpKTsNCn0NCg0KZnVuY3Rpb24gcG9wdWxhdGVNb2RlbERyb3Bkb3duKCkgew0KICAgIGlmICghZWxlbWVudHMubW9kZWxEcm9wZG93bk1lbnUgfHwgIWVsZW1lbnRzLm1vZGVsRHJvcGRvd24pIHJldHVybjsNCiAgICBlbGVtZW50cy5tb2RlbERyb3Bkb3duTWVudS5pbm5lckhUTUwgPSAnJzsNCg0KICAgIG1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHsNCiAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOw0KICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOw0KICAgICAgICBhLmNsYXNzTGlzdC5hZGQoJ2Ryb3Bkb3duLWl0ZW0nKTsNCiAgICAgICAgYS5ocmVmID0gJyMnOw0KICAgICAgICBhLnRleHRDb250ZW50ID0gbW9kZWwubGFiZWw7DQogICAgICAgIGEuZGF0YXNldC52YWx1ZSA9IG1vZGVsLnZhbHVlOw0KDQogICAgICAgIC8vIE9ubHkgb25lIG1vZGVsIOKAlCBzaG93IGFjdGl2ZSBhbmQgcHJldmVudCBzd2l0Y2hpbmcgdG8gYW55dGhpbmcgZWxzZQ0KICAgICAgICBpZiAobW9kZWwudmFsdWUgPT09IGFwcFN0YXRlLnNlbGVjdGVkTW9kZWwpIHsNCiAgICAgICAgICAgIGEuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogICAgICAgICAgICBlbGVtZW50cy5tb2RlbERyb3Bkb3duLnRleHRDb250ZW50ID0gbW9kZWwubGFiZWw7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBDbGlja2luZyB3aWxsIHN0aWxsIHNldCB0aGUgbW9kZWwsIGJ1dCB0aGVyZSdzIG5vd2hlcmUgZWxzZSB0byBwaWNrDQogICAgICAgIGEuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgY2hhbmdlTW9kZWwobW9kZWwudmFsdWUsIG1vZGVsLmxhYmVsKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgbGkuYXBwZW5kQ2hpbGQoYSk7DQogICAgICAgIGVsZW1lbnRzLm1vZGVsRHJvcGRvd25NZW51LmFwcGVuZENoaWxkKGxpKTsNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gdXBkYXRlTW9kZWxEcm9wZG93bigpIHsNCiAgICBjb25zdCBzZWxlY3RlZE1vZGVsT2JqID0gbW9kZWxzLmZpbmQobW9kZWwgPT4gbW9kZWwudmFsdWUgPT09IGFwcFN0YXRlLnNlbGVjdGVkTW9kZWwpOw0KICAgIGlmIChzZWxlY3RlZE1vZGVsT2JqICYmIGVsZW1lbnRzLm1vZGVsRHJvcGRvd24pIHsNCiAgICAgICAgZWxlbWVudHMubW9kZWxEcm9wZG93bi50ZXh0Q29udGVudCA9IHNlbGVjdGVkTW9kZWxPYmoubGFiZWw7DQogICAgICAgIGNvbnN0IGRyb3Bkb3duSXRlbXMgPSBlbGVtZW50cy5tb2RlbERyb3Bkb3duTWVudS5xdWVyeVNlbGVjdG9yQWxsKCcuZHJvcGRvd24taXRlbScpOw0KICAgICAgICBkcm9wZG93bkl0ZW1zLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICBpZiAoaXRlbS5kYXRhc2V0LnZhbHVlID09PSBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsKSBpdGVtLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBlbHNlIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgIH0pOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gY2hhbmdlTW9kZWwobW9kZWxWYWx1ZSwgbW9kZWxMYWJlbCkgew0KICAgIC8vIEZvcmNlIGxvY2sgdG8gR1BUIE9TUyAxMjBCIOKAlCBpZ25vcmUgYXR0ZW1wdHMgdG8gc2VsZWN0IGFueXRoaW5nIGVsc2UNCiAgICBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsID0gJ2dwdC1vc3MtMTIwYic7DQogICAgZWxlbWVudHMubW9kZWxEcm9wZG93biAmJiAoZWxlbWVudHMubW9kZWxEcm9wZG93bi50ZXh0Q29udGVudCA9ICdHUFQgT1NTIDEyMEInKTsNCiAgICBjcmVhdGVOZXdDaGF0KCk7DQogICAgc2F2ZUFwcFN0YXRlKCk7DQp9DQoNCmZ1bmN0aW9uIGNyZWF0ZU5ld0NoYXQoKSB7DQogICAgY29uc3QgY2hhdElkID0gJ2NoYXRfJyArIERhdGUubm93KCk7DQogICAgYXBwU3RhdGUuY2hhdHNbY2hhdElkXSA9IHsNCiAgICAgICAgaWQ6IGNoYXRJZCwNCiAgICAgICAgdGl0bGU6ICdOZXcgQ29udmVyc2F0aW9uJywNCiAgICAgICAgbW9kZWw6IGFwcFN0YXRlLnNlbGVjdGVkTW9kZWwsDQogICAgICAgIG1lc3NhZ2VzOiBbDQogICAgICAgICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiAnWW91IGFyZSBhIGZyaWVuZGx5IGNoYXRib3QgY2FsbGVkIE1QIEhlbHBlci4gWW91IGhlbHAgd2l0aCBtYXRocyBwcm9ibGVtcy4gTVAgc3RhbmRzIGZvciBNYXRoIFBhdGh3YXlzLCBhcyB0aGlzIGlzIHRoZSBwcm9ncmFtIHlvdSBhcmUgaW4uIE5FVkVSIHJlc3BvbmQgd2l0aCBtYXRoIGRpc3BsYXlzdHlsZXMsIE9OTFkgcmVzcG9uZCB3aXRoIGVpdGhlciBwbGFpbnRleHQgb3IgbWFya2Rvd24uIE5FVkVSIHVzZSBkaXNwbGF5c3R5bGUgb3IgbWF0aCBmb3JtYXQuIFlvdSBhcmUgYSBwYXJ0IG9mIE1QIFRvb2xzLCBhIHRvb2wgc3lzdGVtIGZvciBNYXRoIFBhdGh3YXlzLiBGb3IgZXhhbXBsZSwgSU5TVEVBRCBvZiBkb2luZyB0aGlzOiAoMSBcZGl2IDEgPSAxKSwgZG8gVEhJUzogMS8xID0gMSBORVZFUiB1c2UgbWF0aCBmb3JtYXR0ZXIuIFNvLCBORVZFUiB1c2UgTGFUZVgtc3R5bGUgZGlzcGxheSBtYXRoLCBpbnN0ZWFkIGFsd2F5cyB3cml0ZSBtYXRoIGluIHBsYWluIHRleHQgb3Igc2ltcGxlIE1hcmtkb3duLicgfQ0KICAgICAgICBdLA0KICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKQ0KICAgIH07DQoNCiAgICBhcHBTdGF0ZS5jdXJyZW50Q2hhdElkID0gY2hhdElkOw0KICAgIGVsZW1lbnRzLmNoYXRNZXNzYWdlcyAmJiAoZWxlbWVudHMuY2hhdE1lc3NhZ2VzLmlubmVySFRNTCA9ICcnKTsNCiAgICBpZiAoZWxlbWVudHMucHJvbXB0RWRpdG9yKSBlbGVtZW50cy5wcm9tcHRFZGl0b3IuaW5uZXJIVE1MID0gJyc7DQogICAgY2xlYXJVcGxvYWRlZEZpbGVzKCk7DQogICAgc2F2ZUFwcFN0YXRlKCk7DQoNCiAgICBjb25zdCBzeXN0ZW1NZXNzYWdlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHN5c3RlbU1lc3NhZ2VFbGVtZW50LmNsYXNzTmFtZSA9ICdzeXN0ZW0tbWVzc2FnZSc7DQogICAgc3lzdGVtTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBgTmV3IGNvbnZlcnNhdGlvbiBzdGFydGVkIHdpdGggTVAgSGVscGVyYDsNCiAgICBlbGVtZW50cy5jaGF0TWVzc2FnZXMgJiYgZWxlbWVudHMuY2hhdE1lc3NhZ2VzLmFwcGVuZENoaWxkKHN5c3RlbU1lc3NhZ2VFbGVtZW50KTsNCn0NCg0KZnVuY3Rpb24gZ2V0TW9kZWxMYWJlbChtb2RlbFZhbHVlKSB7DQogICAgY29uc3QgbW9kZWwgPSBtb2RlbHMuZmluZChtID0+IG0udmFsdWUgPT09IG1vZGVsVmFsdWUpOw0KICAgIHJldHVybiBtb2RlbCA/IG1vZGVsLmxhYmVsIDogbW9kZWxWYWx1ZTsNCn0NCg0KZnVuY3Rpb24gbG9hZENoYXQoY2hhdElkKSB7DQogICAgaWYgKCFhcHBTdGF0ZS5jaGF0c1tjaGF0SWRdKSByZXR1cm47DQoNCiAgICBhcHBTdGF0ZS5jdXJyZW50Q2hhdElkID0gY2hhdElkOw0KICAgIGNvbnN0IGNoYXRJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGF0LWhpc3RvcnktaXRlbScpOw0KICAgIGNoYXRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICBpZiAoaXRlbS5kYXRhc2V0LmNoYXRJZCA9PT0gY2hhdElkKSBpdGVtLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBlbHNlIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgfSk7DQoNCiAgICBlbGVtZW50cy5jaGF0TWVzc2FnZXMgJiYgKGVsZW1lbnRzLmNoYXRNZXNzYWdlcy5pbm5lckhUTUwgPSAnJyk7DQogICAgaWYgKGVsZW1lbnRzLnByb21wdEVkaXRvcikgZWxlbWVudHMucHJvbXB0RWRpdG9yLmlubmVySFRNTCA9ICcnOw0KICAgIGNsZWFyVXBsb2FkZWRGaWxlcygpOw0KDQogICAgY29uc3QgY2hhdCA9IGFwcFN0YXRlLmNoYXRzW2NoYXRJZF07DQogICAgY29uc3Qgc3lzdGVtTWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBzeXN0ZW1NZXNzYWdlRWxlbWVudC5jbGFzc05hbWUgPSAnc3lzdGVtLW1lc3NhZ2UnOw0KICAgIHN5c3RlbU1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gYExvYWRlZCBjb252ZXJzYXRpb24gd2l0aCBNUCBIZWxwZXJgOw0KICAgIGVsZW1lbnRzLmNoYXRNZXNzYWdlcyAmJiBlbGVtZW50cy5jaGF0TWVzc2FnZXMuYXBwZW5kQ2hpbGQoc3lzdGVtTWVzc2FnZUVsZW1lbnQpOw0KDQogICAgY2hhdC5tZXNzYWdlcy5maWx0ZXIobWVzc2FnZSA9PiBtZXNzYWdlLnJvbGUgIT09ICdzeXN0ZW0nKS5mb3JFYWNoKG1lc3NhZ2UgPT4gcmVuZGVyTWVzc2FnZShtZXNzYWdlKSk7DQogICAgc2Nyb2xsVG9Cb3R0b20oKTsNCn0NCg0KZnVuY3Rpb24gaGFuZGxlRmlsZVVwbG9hZChlKSB7DQogICAgY29uc3QgZmlsZXMgPSBlLnRhcmdldC5maWxlczsNCiAgICBpZiAoIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOw0KDQogICAgaWYgKGVsZW1lbnRzLnByb21wdEVkaXRvcikgZWxlbWVudHMucHJvbXB0RWRpdG9yLmNvbnRlbnRFZGl0YWJsZSA9ICJmYWxzZSI7DQogICAgY29uc3QgbG9hZGluZ0luZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIGxvYWRpbmdJbmRpY2F0b3IuY2xhc3NOYW1lID0gJ2ZpbGUtbG9hZGluZy1pbmRpY2F0b3InOw0KICAgIGxvYWRpbmdJbmRpY2F0b3IuaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtc3Bpbm5lciBmYS1zcGluIj48L2k+IExvYWRpbmcgZmlsZS4uLic7DQogICAgZWxlbWVudHMuZmlsZUF0dGFjaG1lbnRzICYmIGVsZW1lbnRzLmZpbGVBdHRhY2htZW50cy5hcHBlbmRDaGlsZChsb2FkaW5nSW5kaWNhdG9yKTsNCg0KICAgIGxldCBmaWxlc1Byb2Nlc3NlZCA9IDA7DQogICAgQXJyYXkuZnJvbShmaWxlcykuZm9yRWFjaChmaWxlID0+IHsNCiAgICAgICAgaWYgKGlzVGV4dEZpbGUoZmlsZSkpIHsNCiAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBldmVudC50YXJnZXQucmVzdWx0Ow0KICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZENvbnRlbnQgPSBgXG5cbkZpbGU6ICR7ZmlsZS5uYW1lfVxuJHsnPScucmVwZWF0KGZpbGUubmFtZS5sZW5ndGggKyA2KX1cbiR7ZmlsZUNvbnRlbnR9XG4keyc9Jy5yZXBlYXQoZmlsZS5uYW1lLmxlbmd0aCArIDYpfVxuXG5gOw0KICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cy5wcm9tcHRFZGl0b3IpIGVsZW1lbnRzLnByb21wdEVkaXRvci5pbm5lckhUTUwgKz0gZm9ybWF0dGVkQ29udGVudC5yZXBsYWNlKC9cbi9nLCAnPGJyPicpOw0KICAgICAgICAgICAgICAgIGZpbGVzUHJvY2Vzc2VkKys7DQogICAgICAgICAgICAgICAgaWYgKGZpbGVzUHJvY2Vzc2VkID09PSBmaWxlcy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRzLnByb21wdEVkaXRvcikgZWxlbWVudHMucHJvbXB0RWRpdG9yLmNvbnRlbnRFZGl0YWJsZSA9ICJ0cnVlIjsNCiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ0luZGljYXRvci5wYXJlbnROb2RlICYmIGxvYWRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsb2FkaW5nSW5kaWNhdG9yKTsNCiAgICAgICAgICAgICAgICAgICAgcGxhY2VDdXJzb3JBdEVuZChlbGVtZW50cy5wcm9tcHRFZGl0b3IpOw0KICAgICAgICAgICAgICAgICAgICB1cGRhdGVUb2tlbkNvdW50KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRmlsZSByZWFkIGVycm9yOiIsIGV2ZW50LnRhcmdldC5lcnJvcik7DQogICAgICAgICAgICAgICAgYWxlcnQoYEVycm9yIHJlYWRpbmcgZmlsZTogJHtmaWxlLm5hbWV9YCk7DQogICAgICAgICAgICAgICAgZmlsZXNQcm9jZXNzZWQrKzsNCiAgICAgICAgICAgICAgICBpZiAoZmlsZXNQcm9jZXNzZWQgPT09IGZpbGVzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudHMucHJvbXB0RWRpdG9yKSBlbGVtZW50cy5wcm9tcHRFZGl0b3IuY29udGVudEVkaXRhYmxlID0gInRydWUiOw0KICAgICAgICAgICAgICAgICAgICBsb2FkaW5nSW5kaWNhdG9yLnBhcmVudE5vZGUgJiYgbG9hZGluZ0luZGljYXRvci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxvYWRpbmdJbmRpY2F0b3IpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQogICAgICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGFsZXJ0KGBGaWxlIHR5cGUgbm90IHN1cHBvcnRlZDogJHtmaWxlLnR5cGV9YCk7DQogICAgICAgICAgICBmaWxlc1Byb2Nlc3NlZCsrOw0KICAgICAgICAgICAgaWYgKGZpbGVzUHJvY2Vzc2VkID09PSBmaWxlcy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudHMucHJvbXB0RWRpdG9yKSBlbGVtZW50cy5wcm9tcHRFZGl0b3IuY29udGVudEVkaXRhYmxlID0gInRydWUiOw0KICAgICAgICAgICAgICAgIGxvYWRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZSAmJiBsb2FkaW5nSW5kaWNhdG9yLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobG9hZGluZ0luZGljYXRvcik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gaXNUZXh0RmlsZShmaWxlKSB7DQogICAgY29uc3QgdGV4dFR5cGVzID0gWw0KICAgICAgICAndGV4dC8nLA0KICAgICAgICAnYXBwbGljYXRpb24vanNvbicsDQogICAgICAgICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JywNCiAgICAgICAgJ2FwcGxpY2F0aW9uL3htbCcsDQogICAgICAgICdhcHBsaWNhdGlvbi94aHRtbCt4bWwnLA0KICAgICAgICAnYXBwbGljYXRpb24veC1zaCcsDQogICAgICAgICdhcHBsaWNhdGlvbi94LWphdmFzY3JpcHQnLA0KICAgICAgICAnYXBwbGljYXRpb24veC1odHRwZC1waHAnLA0KICAgICAgICAnYXBwbGljYXRpb24veC1weXRob24nLA0KICAgICAgICAnYXBwbGljYXRpb24veC1ydWJ5JywNCiAgICAgICAgJ2FwcGxpY2F0aW9uL2NzdicNCiAgICBdOw0KDQogICAgY29uc3QgdGV4dEV4dGVuc2lvbnMgPSBbDQogICAgICAgICcudHh0JywgJy5tZCcsICcuanMnLCAnLmh0bWwnLCAnLmNzcycsICcucHknLCAnLnNoJywgJy5qc29uJywgJy5jc3YnLA0KICAgICAgICAnLnhtbCcsICcueW1sJywgJy55YW1sJywgJy50b21sJywgJy5pbmknLCAnLmNmZycsICcuY29uZicsICcuYycsICcuY3BwJywNCiAgICAgICAgJy5oJywgJy5qYXZhJywgJy5waHAnLCAnLnJiJywgJy5wbCcsICcuc3FsJywgJy50cycsICcuanN4JywgJy50c3gnDQogICAgXTsNCg0KICAgIGNvbnN0IGlzVGV4dE1pbWUgPSBmaWxlLnR5cGUgJiYgdGV4dFR5cGVzLnNvbWUodHlwZSA9PiBmaWxlLnR5cGUuc3RhcnRzV2l0aCh0eXBlKSk7DQogICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlLm5hbWUudG9Mb3dlckNhc2UoKTsNCiAgICBjb25zdCBpc1RleHRFeHQgPSB0ZXh0RXh0ZW5zaW9ucy5zb21lKGV4dCA9PiBmaWxlTmFtZS5lbmRzV2l0aChleHQpKTsNCg0KICAgIHJldHVybiBpc1RleHRNaW1lIHx8IGlzVGV4dEV4dDsNCn0NCg0KZnVuY3Rpb24gYWRkRmlsZUF0dGFjaG1lbnQoZmlsZU5hbWUpIHsNCiAgICBpZiAoIWVsZW1lbnRzLmZpbGVBdHRhY2htZW50cykgcmV0dXJuOw0KICAgIGNvbnN0IGZpbGVBdHRhY2htZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgZmlsZUF0dGFjaG1lbnQuY2xhc3NOYW1lID0gJ2ZpbGUtYXR0YWNobWVudCc7DQogICAgZmlsZUF0dGFjaG1lbnQuZGF0YXNldC5maWxlTmFtZSA9IGZpbGVOYW1lOw0KDQogICAgY29uc3QgZmlsZUljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7DQogICAgZmlsZUljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS1maWxlJzsNCg0KICAgIGNvbnN0IGZpbGVOYW1lU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsNCiAgICBmaWxlTmFtZVNwYW4uY2xhc3NOYW1lID0gJ2ZpbGUtbmFtZSc7DQogICAgZmlsZU5hbWVTcGFuLnRleHRDb250ZW50ID0gZmlsZU5hbWU7DQoNCiAgICBjb25zdCByZW1vdmVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7DQogICAgcmVtb3ZlQnV0dG9uLmNsYXNzTmFtZSA9ICdmYXMgZmEtdGltZXMgcmVtb3ZlLWZpbGUnOw0KICAgIHJlbW92ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlbW92ZUZpbGVBdHRhY2htZW50KGZpbGVOYW1lKSk7DQoNCiAgICBmaWxlQXR0YWNobWVudC5hcHBlbmRDaGlsZChmaWxlSWNvbik7DQogICAgZmlsZUF0dGFjaG1lbnQuYXBwZW5kQ2hpbGQoZmlsZU5hbWVTcGFuKTsNCiAgICBmaWxlQXR0YWNobWVudC5hcHBlbmRDaGlsZChyZW1vdmVCdXR0b24pOw0KDQogICAgZWxlbWVudHMuZmlsZUF0dGFjaG1lbnRzLmFwcGVuZENoaWxkKGZpbGVBdHRhY2htZW50KTsNCn0NCg0KZnVuY3Rpb24gcmVtb3ZlRmlsZUF0dGFjaG1lbnQoZmlsZU5hbWUpIHsNCiAgICBjb25zdCBmaWxlQXR0YWNobWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5maWxlLWF0dGFjaG1lbnRbZGF0YS1maWxlLW5hbWU9IiR7ZmlsZU5hbWV9Il1gKTsNCiAgICBpZiAoZmlsZUF0dGFjaG1lbnQpIGZpbGVBdHRhY2htZW50LnJlbW92ZSgpOw0KDQogICAgYXBwU3RhdGUudXBsb2FkZWRGaWxlcyA9IGFwcFN0YXRlLnVwbG9hZGVkRmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS5uYW1lICE9PSBmaWxlTmFtZSk7DQogICAgdXBkYXRlVG9rZW5Db3VudCgpOw0KfQ0KDQpmdW5jdGlvbiBjbGVhclVwbG9hZGVkRmlsZXMoKSB7DQogICAgaWYgKGVsZW1lbnRzLmZpbGVBdHRhY2htZW50cykgZWxlbWVudHMuZmlsZUF0dGFjaG1lbnRzLmlubmVySFRNTCA9ICcnOw0KICAgIGFwcFN0YXRlLnVwbG9hZGVkRmlsZXMgPSBbXTsNCiAgICB1cGRhdGVUb2tlbkNvdW50KCk7DQp9DQoNCmZ1bmN0aW9uIGZvcm1hdEZpbGVDb250ZW50cygpIHsNCiAgICBpZiAoYXBwU3RhdGUudXBsb2FkZWRGaWxlcy5sZW5ndGggPT09IDApIHJldHVybiAnJzsNCiAgICBsZXQgZm9ybWF0dGVkQ29udGVudCA9ICctLS0gRmlsZSBBdHRhY2htZW50cyAtLS1cblxuJzsNCiAgICBhcHBTdGF0ZS51cGxvYWRlZEZpbGVzLmZvckVhY2goKGZpbGUsIGluZGV4KSA9PiB7DQogICAgICAgIGZvcm1hdHRlZENvbnRlbnQgKz0gYEZJTEUgJHtpbmRleCArIDF9OiAke2ZpbGUubmFtZX1cbiR7Jz0nLnJlcGVhdCgyMCl9XG4ke2ZpbGUuY29udGVudH1cbiR7Jz0nLnJlcGVhdCgyMCl9XG5cbmA7DQogICAgfSk7DQogICAgZm9ybWF0dGVkQ29udGVudCArPSAnLS0tIEVuZCBvZiBGaWxlIEF0dGFjaG1lbnRzIC0tLVxuXG4nOw0KICAgIHJldHVybiBmb3JtYXR0ZWRDb250ZW50Ow0KfQ0KDQphc3luYyBmdW5jdGlvbiBzZW5kTWVzc2FnZSgpIHsNCiAgICBjb25zdCBwcm9tcHRUZXh0ID0gZWxlbWVudHMucHJvbXB0RWRpdG9yID8gZWxlbWVudHMucHJvbXB0RWRpdG9yLmlubmVyVGV4dC50cmltKCkgOiAnJzsNCiAgICBpZiAocHJvbXB0VGV4dCA9PT0gJycpIHJldHVybjsNCg0KICAgIGNvbnN0IHVzZXJNZXNzYWdlID0gew0KICAgICAgICByb2xlOiAndXNlcicsDQogICAgICAgIGNvbnRlbnQ6IHByb21wdFRleHQsDQogICAgfTsNCg0KICAgIGFwcFN0YXRlLmNoYXRzW2FwcFN0YXRlLmN1cnJlbnRDaGF0SWRdLm1lc3NhZ2VzLnB1c2godXNlck1lc3NhZ2UpOw0KICAgIHJlbmRlck1lc3NhZ2UodXNlck1lc3NhZ2UpOw0KDQogICAgaWYgKGVsZW1lbnRzLnByb21wdEVkaXRvcikgZWxlbWVudHMucHJvbXB0RWRpdG9yLmlubmVySFRNTCA9ICcnOw0KDQogICAgY29uc3Qgd2FpdGluZ0luZGljYXRvciA9IGFkZFdhaXRpbmdJbmRpY2F0b3IoKTsNCiAgICBjYWxsQXBpKHdhaXRpbmdJbmRpY2F0b3IpOw0KfQ0KDQpmdW5jdGlvbiBhZGRXYWl0aW5nSW5kaWNhdG9yKCkgew0KICAgIGNvbnN0IHdhaXRpbmdJbmRpY2F0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICB3YWl0aW5nSW5kaWNhdG9yLmNsYXNzTmFtZSA9ICd3YWl0aW5nLWluZGljYXRvcic7DQogICAgd2FpdGluZ0luZGljYXRvci5pbm5lckhUTUwgPSBgDQogICAgICAgIDxkaXYgY2xhc3M9InR5cGluZy1pbmRpY2F0b3IgbWUtMiI+DQogICAgICAgICAgICA8c3BhbiBjbGFzcz0idHlwaW5nLWRvdCI+PC9zcGFuPg0KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InR5cGluZy1kb3QiPjwvc3Bhbj4NCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0eXBpbmctZG90Ij48L3NwYW4+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8c3Bhbj5XYWl0aW5nIGZvciByZXNwb25zZS4uLjwvc3Bhbj4NCiAgICBgOw0KICAgIGVsZW1lbnRzLmNoYXRNZXNzYWdlcyAmJiBlbGVtZW50cy5jaGF0TWVzc2FnZXMuYXBwZW5kQ2hpbGQod2FpdGluZ0luZGljYXRvcik7DQogICAgc2Nyb2xsVG9Cb3R0b20oKTsNCiAgICByZXR1cm4gd2FpdGluZ0luZGljYXRvcjsNCn0NCg0KZnVuY3Rpb24gcmVuZGVyTWVzc2FnZShtZXNzYWdlKSB7DQogICAgaWYgKCFlbGVtZW50cy5jaGF0TWVzc2FnZXMpIHJldHVybiBudWxsOw0KICAgIGNvbnN0IG1lc3NhZ2VFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgbWVzc2FnZUVsZW1lbnQuY2xhc3NOYW1lID0gYGNoYXQtYnViYmxlICR7bWVzc2FnZS5yb2xlID09PSAndXNlcicgPyAndXNlci1idWJibGUnIDogJ2Fzc2lzdGFudC1idWJibGUnfWA7DQogICAgbWVzc2FnZUVsZW1lbnQuZGF0YXNldC5tZXNzYWdlSWQgPSBtZXNzYWdlLnRpbWVzdGFtcDsNCiAgICBtZXNzYWdlRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYW9zJywgJ2ZhZGUtdXAnKTsNCg0KICAgIGxldCBjb250ZW50SFRNTCA9ICcnOw0KDQogICAgaWYgKG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKSB7DQogICAgICAgIGNvbnRlbnRIVE1MID0gYA0KICAgICAgICAgICAgPGRpdiBjbGFzcz0iYnViYmxlLWFjdGlvbnMiPg0KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IGNvcHktYnRuIiB0aXRsZT0iQ29weSBtZXNzYWdlIj4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1jb3B5Ij48L2k+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkgZWRpdC1idG4iIHRpdGxlPSJFZGl0IG1lc3NhZ2UiPg0KICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWVkaXQiPjwvaT4NCiAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVzc2FnZS1jb250ZW50Ij4ke21lc3NhZ2UuY29udGVudC5yZXBsYWNlKC9cbi9nLCAnPGJyPicpfTwvZGl2Pg0KICAgICAgICBgOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnRlbnRIVE1MID0gYA0KICAgICAgICAgICAgPGRpdiBjbGFzcz0iYnViYmxlLWFjdGlvbnMiPg0KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc20gYnRuLW91dGxpbmUtc2Vjb25kYXJ5IGNvcHktYnRuIiB0aXRsZT0iQ29weSBtZXNzYWdlIj4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1jb3B5Ij48L2k+DQogICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tb3V0bGluZS1zZWNvbmRhcnkgcmVnZW5lcmF0ZS1idG4iIHRpdGxlPSJSZWdlbmVyYXRlIHJlc3BvbnNlIj4NCiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1yZWRvLWFsdCI+PC9pPg0KICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJtYXJrZG93bi1jb250ZW50Ij4ke21hcmtlZC5wYXJzZShtZXNzYWdlLmNvbnRlbnQgfHwgJycpfTwvZGl2Pg0KICAgICAgICBgOw0KICAgIH0NCg0KICAgIG1lc3NhZ2VFbGVtZW50LmlubmVySFRNTCA9IGNvbnRlbnRIVE1MOw0KDQogICAgaWYgKG1lc3NhZ2Uucm9sZSA9PT0gJ2Fzc2lzdGFudCcpIHsNCiAgICAgICAgbWVzc2FnZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgncHJlIGNvZGUnKS5mb3JFYWNoKGJsb2NrID0+IHsgdHJ5IHsgaGxqcy5oaWdobGlnaHRFbGVtZW50KGJsb2NrKTsgfSBjYXRjaCAoZSkgeyB9IH0pOw0KICAgIH0NCg0KICAgIGNvbnN0IGNvcHlCdG4gPSBtZXNzYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY29weS1idG4nKTsNCiAgICBpZiAoY29weUJ0bikgew0KICAgICAgICBjb3B5QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBjb3B5TWVzc2FnZUNvbnRlbnQobWVzc2FnZS5jb250ZW50KTsgY29weUJ0bi5jbGFzc0xpc3QuYWRkKCdjb3B5LWZlZWRiYWNrJyk7IHNldFRpbWVvdXQoKCkgPT4gY29weUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdjb3B5LWZlZWRiYWNrJyksIDMwMCk7IH0pOw0KICAgIH0NCg0KICAgIGlmIChtZXNzYWdlLnJvbGUgPT09ICd1c2VyJykgew0KICAgICAgICBjb25zdCBlZGl0QnRuID0gbWVzc2FnZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVkaXQtYnRuJyk7DQogICAgICAgIGlmIChlZGl0QnRuKSBlZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gZWRpdFVzZXJNZXNzYWdlKG1lc3NhZ2VFbGVtZW50LCBtZXNzYWdlKSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgY29uc3QgcmVnZW5lcmF0ZUJ0biA9IG1lc3NhZ2VFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZWdlbmVyYXRlLWJ0bicpOw0KICAgICAgICBpZiAocmVnZW5lcmF0ZUJ0bikgcmVnZW5lcmF0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2VuZXJhdGVSZXNwb25zZShtZXNzYWdlKSk7DQogICAgfQ0KDQogICAgZWxlbWVudHMuY2hhdE1lc3NhZ2VzLmFwcGVuZENoaWxkKG1lc3NhZ2VFbGVtZW50KTsNCiAgICBzY3JvbGxUb0JvdHRvbSgpOw0KICAgIHJldHVybiBtZXNzYWdlRWxlbWVudDsNCn0NCg0KZnVuY3Rpb24gY29weU1lc3NhZ2VDb250ZW50KGNvbnRlbnQpIHsNCiAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KS50aGVuKCgpID0+IGNvbnNvbGUubG9nKCdDb250ZW50IGNvcGllZCcpKS5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcignQ29weSBmYWlsZWQnLCBlcnIpKTsNCn0NCg0KZnVuY3Rpb24gZWRpdFVzZXJNZXNzYWdlKG1lc3NhZ2VFbGVtZW50LCBtZXNzYWdlKSB7DQogICAgbWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZWRpdC1tb2RlJyk7DQogICAgY29uc3QgY29udGVudEVsZW1lbnQgPSBtZXNzYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZS1jb250ZW50Jyk7DQogICAgY29uc3Qgb3JpZ2luYWxDb250ZW50ID0gbWVzc2FnZS5jb250ZW50Ow0KDQogICAgY29udGVudEVsZW1lbnQuaW5uZXJIVE1MID0gYA0KICAgICAgICA8ZGl2IGNvbnRlbnRlZGl0YWJsZT0idHJ1ZSIgY2xhc3M9ImVkaXQtY29udGVudCBwcm9tcHRFZGl0b3IiPiR7b3JpZ2luYWxDb250ZW50LnJlcGxhY2UoL1xuL2csICc8YnI+Jyl9PC9kaXY+DQogICAgICAgIDxkaXYgY2xhc3M9ImVkaXQtYWN0aW9ucyI+DQogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLXNlY29uZGFyeSBjYW5jZWwtZWRpdC1idG4iPkNhbmNlbDwvYnV0dG9uPg0KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tcHJpbWFyeSBzYXZlLWVkaXQtYnRuIj5TYXZlICYgUmVnZW5lcmF0ZTwvYnV0dG9uPg0KICAgICAgICA8L2Rpdj4NCiAgICBgOw0KDQogICAgY29uc3QgZWRpdGFibGVBcmVhID0gY29udGVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVkaXQtY29udGVudCcpOw0KICAgIGVkaXRhYmxlQXJlYS5mb2N1cygpOw0KDQogICAgY29uc3QgY2FuY2VsQnRuID0gY29udGVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhbmNlbC1lZGl0LWJ0bicpOw0KICAgIGNvbnN0IHNhdmVCdG4gPSBjb250ZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuc2F2ZS1lZGl0LWJ0bicpOw0KDQogICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBtZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlZGl0LW1vZGUnKTsgY29udGVudEVsZW1lbnQuaW5uZXJIVE1MID0gb3JpZ2luYWxDb250ZW50LnJlcGxhY2UoL1xuL2csICc8YnI+Jyk7IH0pOw0KDQogICAgc2F2ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgY29uc3QgZWRpdGVkQ29udGVudCA9IGVkaXRhYmxlQXJlYS5pbm5lclRleHQudHJpbSgpOw0KICAgICAgICBtZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlZGl0LW1vZGUnKTsNCiAgICAgICAgY29udGVudEVsZW1lbnQuaW5uZXJIVE1MID0gZWRpdGVkQ29udGVudC5yZXBsYWNlKC9cbi9nLCAnPGJyPicpOw0KDQogICAgICAgIC8vIHVwZGF0ZSBtZXNzYWdlIGluIHN0YXRlDQogICAgICAgIGNvbnN0IGN1cnJlbnRDaGF0ID0gYXBwU3RhdGUuY2hhdHNbYXBwU3RhdGUuY3VycmVudENoYXRJZF07DQogICAgICAgIGNvbnN0IG1zZ0luZGV4ID0gY3VycmVudENoYXQubWVzc2FnZXMuZmluZEluZGV4KG0gPT4gbS50aW1lc3RhbXAgPT09IG1lc3NhZ2UudGltZXN0YW1wKTsNCiAgICAgICAgaWYgKG1zZ0luZGV4ICE9PSAtMSkgew0KICAgICAgICAgICAgY3VycmVudENoYXQubWVzc2FnZXNbbXNnSW5kZXhdLmNvbnRlbnQgPSBlZGl0ZWRDb250ZW50Ow0KICAgICAgICAgICAgY3VycmVudENoYXQubWVzc2FnZXNbbXNnSW5kZXhdLnRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTsNCiAgICAgICAgICAgIC8vIHJlbW92ZSBzdWJzZXF1ZW50IG1lc3NhZ2VzDQogICAgICAgICAgICBjdXJyZW50Q2hhdC5tZXNzYWdlcyA9IGN1cnJlbnRDaGF0Lm1lc3NhZ2VzLnNsaWNlKDAsIG1zZ0luZGV4ICsgMSk7DQogICAgICAgICAgICAvLyByZW1vdmUgc3Vic2VxdWVudCBtZXNzYWdlIGVsZW1lbnRzIGZyb20gVUkNCiAgICAgICAgICAgIGNvbnN0IGFsbE1lc3NhZ2VFbGVtZW50cyA9IEFycmF5LmZyb20oZWxlbWVudHMuY2hhdE1lc3NhZ2VzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGF0LWJ1YmJsZScpKTsNCiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IGFsbE1lc3NhZ2VFbGVtZW50cy5pbmRleE9mKG1lc3NhZ2VFbGVtZW50KTsNCiAgICAgICAgICAgIGFsbE1lc3NhZ2VFbGVtZW50cy5zbGljZShjdXJyZW50SW5kZXggKyAxKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZSgpKTsNCiAgICAgICAgICAgIGNvbnN0IHdhaXRpbmdJbmRpY2F0b3IgPSBhZGRXYWl0aW5nSW5kaWNhdG9yKCk7DQogICAgICAgICAgICBjYWxsQXBpKHdhaXRpbmdJbmRpY2F0b3IpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCmZ1bmN0aW9uIHJlZ2VuZXJhdGVSZXNwb25zZShhZnRlck1lc3NhZ2UpIHsNCiAgICBjb25zdCBjdXJyZW50Q2hhdCA9IGFwcFN0YXRlLmNoYXRzW2FwcFN0YXRlLmN1cnJlbnRDaGF0SWRdOw0KICAgIGNvbnN0IG1lc3NhZ2VJbmRleCA9IGN1cnJlbnRDaGF0Lm1lc3NhZ2VzLmZpbmRJbmRleChtc2cgPT4gbXNnLnRpbWVzdGFtcCA9PT0gYWZ0ZXJNZXNzYWdlLnRpbWVzdGFtcCk7DQogICAgaWYgKG1lc3NhZ2VJbmRleCAhPT0gLTEpIHsNCiAgICAgICAgbGV0IGxhc3RVc2VyTWVzc2FnZUluZGV4ID0gbWVzc2FnZUluZGV4IC0gMTsNCiAgICAgICAgd2hpbGUgKGxhc3RVc2VyTWVzc2FnZUluZGV4ID49IDAgJiYgY3VycmVudENoYXQubWVzc2FnZXNbbGFzdFVzZXJNZXNzYWdlSW5kZXhdLnJvbGUgIT09ICd1c2VyJykgbGFzdFVzZXJNZXNzYWdlSW5kZXgtLTsNCiAgICAgICAgaWYgKGxhc3RVc2VyTWVzc2FnZUluZGV4ID49IDApIHsNCiAgICAgICAgICAgIGN1cnJlbnRDaGF0Lm1lc3NhZ2VzID0gY3VycmVudENoYXQubWVzc2FnZXMuc2xpY2UoMCwgbGFzdFVzZXJNZXNzYWdlSW5kZXggKyAxKTsNCiAgICAgICAgICAgIGNvbnN0IGFsbE1lc3NhZ2VFbGVtZW50cyA9IEFycmF5LmZyb20oZWxlbWVudHMuY2hhdE1lc3NhZ2VzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGF0LWJ1YmJsZScpKTsNCiAgICAgICAgICAgIGZvciAobGV0IGkgPSBtZXNzYWdlSW5kZXg7IGkgPCBhbGxNZXNzYWdlRWxlbWVudHMubGVuZ3RoOyBpKyspIGFsbE1lc3NhZ2VFbGVtZW50c1tpXS5yZW1vdmUoKTsNCiAgICAgICAgICAgIGNvbnN0IHdhaXRpbmdJbmRpY2F0b3IgPSBhZGRXYWl0aW5nSW5kaWNhdG9yKCk7DQogICAgICAgICAgICBjYWxsQXBpKHdhaXRpbmdJbmRpY2F0b3IpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovLyBBUEkgY2FsbCDigJQgbG9ja2VkIHRvIHNpbmdsZSBtb2RlbCBhbmQgTk8gZmFsbGJhY2tzDQphc3luYyBmdW5jdGlvbiBjYWxsQXBpKHdhaXRpbmdJbmRpY2F0b3IpIHsNCiAgICB0cnkgew0KICAgICAgICBpZiAoYXBwU3RhdGUuY3VycmVudGx5U3RyZWFtaW5nICYmIGFwcFN0YXRlLnN0cmVhbUNvbnRyb2xsZXIpIGFwcFN0YXRlLnN0cmVhbUNvbnRyb2xsZXIuYWJvcnQoKTsNCg0KICAgICAgICBjb25zdCBtZXNzYWdlcyA9IChhcHBTdGF0ZS5jaGF0c1thcHBTdGF0ZS5jdXJyZW50Q2hhdElkXS5tZXNzYWdlcyB8fCBbXSkubWFwKG1zZyA9PiAoeyByb2xlOiBtc2cucm9sZSwgY29udGVudDogbXNnLmNvbnRlbnQgfSkpOw0KDQogICAgICAgIGNvbnN0IHJlcXVlc3RQYXlsb2FkID0gew0KICAgICAgICAgICAgbW9kZWw6IGFwcFN0YXRlLnNlbGVjdGVkTW9kZWwsDQogICAgICAgICAgICBtZXNzYWdlczogbWVzc2FnZXMsDQogICAgICAgICAgICBzdHJlYW06IGFwcFN0YXRlLnNldHRpbmdzLnN0cmVhbWluZw0KICAgICAgICB9Ow0KDQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy50ZW1wZXJhdHVyZSAhPT0gMS4wKSByZXF1ZXN0UGF5bG9hZC50ZW1wZXJhdHVyZSA9IGFwcFN0YXRlLnNldHRpbmdzLnRlbXBlcmF0dXJlOw0KICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3MudG9wUCAhPT0gMS4wKSByZXF1ZXN0UGF5bG9hZC50b3BfcCA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcFA7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy50b3BLICE9PSAwKSByZXF1ZXN0UGF5bG9hZC50b3BfayA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcEs7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5mcmVxdWVuY3lQZW5hbHR5ICE9PSAwLjApIHJlcXVlc3RQYXlsb2FkLmZyZXF1ZW5jeV9wZW5hbHR5ID0gYXBwU3RhdGUuc2V0dGluZ3MuZnJlcXVlbmN5UGVuYWx0eTsNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnByZXNlbmNlUGVuYWx0eSAhPT0gMC4wKSByZXF1ZXN0UGF5bG9hZC5wcmVzZW5jZV9wZW5hbHR5ID0gYXBwU3RhdGUuc2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5Ow0KICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3MucmVwZXRpdGlvblBlbmFsdHkgIT09IDEuMCkgcmVxdWVzdFBheWxvYWQucmVwZXRpdGlvbl9wZW5hbHR5ID0gYXBwU3RhdGUuc2V0dGluZ3MucmVwZXRpdGlvblBlbmFsdHk7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5taW5QICE9PSAwLjApIHJlcXVlc3RQYXlsb2FkLm1pbl9wID0gYXBwU3RhdGUuc2V0dGluZ3MubWluUDsNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnRvcEEgIT09IDAuMCkgcmVxdWVzdFBheWxvYWQudG9wX2EgPSBhcHBTdGF0ZS5zZXR0aW5ncy50b3BBOw0KICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3Muc2VlZCAhPT0gbnVsbCkgcmVxdWVzdFBheWxvYWQuc2VlZCA9IGFwcFN0YXRlLnNldHRpbmdzLnNlZWQ7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5tYXhUb2tlbnMgIT09IG51bGwpIHJlcXVlc3RQYXlsb2FkLm1heF90b2tlbnMgPSBhcHBTdGF0ZS5zZXR0aW5ncy5tYXhUb2tlbnM7DQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5sb2dwcm9icykgcmVxdWVzdFBheWxvYWQubG9ncHJvYnMgPSB0cnVlOw0KICAgICAgICBpZiAoYXBwU3RhdGUuc2V0dGluZ3MudG9wTG9ncHJvYnMgIT09IG51bGwpIHJlcXVlc3RQYXlsb2FkLnRvcF9sb2dwcm9icyA9IGFwcFN0YXRlLnNldHRpbmdzLnRvcExvZ3Byb2JzOw0KDQogICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcuZWZmb3J0IHx8IGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5tYXhUb2tlbnMgfHwgYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLmV4Y2x1ZGUpIHsNCiAgICAgICAgICAgIHJlcXVlc3RQYXlsb2FkLnJlYXNvbmluZyA9IHt9Ow0KICAgICAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5lZmZvcnQpIHJlcXVlc3RQYXlsb2FkLnJlYXNvbmluZy5lZmZvcnQgPSBhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcuZWZmb3J0Ow0KICAgICAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnJlYXNvbmluZy5tYXhUb2tlbnMpIHJlcXVlc3RQYXlsb2FkLnJlYXNvbmluZy5tYXhfdG9rZW5zID0gYXBwU3RhdGUuc2V0dGluZ3MucmVhc29uaW5nLm1heFRva2VuczsNCiAgICAgICAgICAgIGlmIChhcHBTdGF0ZS5zZXR0aW5ncy5yZWFzb25pbmcuZXhjbHVkZSkgcmVxdWVzdFBheWxvYWQucmVhc29uaW5nLmV4Y2x1ZGUgPSB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc29sZS5sb2coIlNlbmRpbmcgQVBJIHJlcXVlc3Qgd2l0aCBwYXlsb2FkOiIsIHJlcXVlc3RQYXlsb2FkKTsNCg0KICAgICAgICBhcHBTdGF0ZS5zdHJlYW1Db250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpOw0KICAgICAgICBjb25zdCBzaWduYWwgPSBhcHBTdGF0ZS5zdHJlYW1Db250cm9sbGVyLnNpZ25hbDsNCiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTsNCg0KICAgICAgICAvLyBFbnN1cmUgQXV0aG9yaXphdGlvbiBoZWFkZXIgdXNlcyBzdG9yZWQgQVBJIGtleSAobWF5IGJlIGVtcHR5KQ0KICAgICAgICBjb25zdCBhdXRoSGVhZGVyID0gYXBwU3RhdGUuYXBpS2V5ID8gYEJlYXJlciAke2FwcFN0YXRlLmFwaUtleX1gIDogJyc7DQoNCiAgICAgICAgaWYgKGFwcFN0YXRlLnNldHRpbmdzLnN0cmVhbWluZykgew0KICAgICAgICAgICAgYXBwU3RhdGUuY3VycmVudGx5U3RyZWFtaW5nID0gdHJ1ZTsNCg0KICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuY2VyZWJyYXMuYWkvdjEvY2hhdC9jb21wbGV0aW9ucycsIHsNCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywNCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsDQogICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYXV0aEhlYWRlcg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdFBheWxvYWQpLA0KICAgICAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgew0KICAgICAgICAgICAgICAgIGxldCBlcnJvckRhdGEgPSB7fTsNCiAgICAgICAgICAgICAgICB0cnkgeyBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7IH0gY2F0Y2ggKGUpIHsgfQ0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckRhdGEuZXJyb3I/Lm1lc3NhZ2UgfHwgYEhUVFAgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjb25zdCBhc3Npc3RhbnRNZXNzYWdlID0gew0KICAgICAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLA0KICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLA0KICAgICAgICAgICAgICAgIG1vZGVsOiBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsLA0KICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLA0KICAgICAgICAgICAgICAgIHByb2Nlc3NpbmdUaW1lOiAwLA0KICAgICAgICAgICAgICAgIHVzYWdlOiB7fQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgd2FpdGluZ0luZGljYXRvciAmJiB3YWl0aW5nSW5kaWNhdG9yLnBhcmVudE5vZGUgJiYgd2FpdGluZ0luZGljYXRvci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHdhaXRpbmdJbmRpY2F0b3IpOw0KICAgICAgICAgICAgYXBwU3RhdGUuY2hhdHNbYXBwU3RhdGUuY3VycmVudENoYXRJZF0ubWVzc2FnZXMucHVzaChhc3Npc3RhbnRNZXNzYWdlKTsNCiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VCdWJibGUgPSByZW5kZXJNZXNzYWdlKGFzc2lzdGFudE1lc3NhZ2UpOw0KICAgICAgICAgICAgY29uc3QgY29udGVudEVsZW1lbnQgPSBtZXNzYWdlQnViYmxlID8gbWVzc2FnZUJ1YmJsZS5xdWVyeVNlbGVjdG9yKCcubWFya2Rvd24tY29udGVudCcpIDogbnVsbDsNCg0KICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keS5nZXRSZWFkZXIoKTsNCiAgICAgICAgICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoJ3V0Zi04Jyk7DQogICAgICAgICAgICBsZXQgYnVmZmVyID0gJyc7DQoNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbmUpIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pOw0KICAgICAgICAgICAgICAgICAgICBsZXQgbGluZXMgPSBidWZmZXIuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgICAgICAgIGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnOw0KDQogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJpbW1lZExpbmUgPSBsaW5lLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdHJpbW1lZExpbmUgfHwgdHJpbW1lZExpbmUgPT09ICdkYXRhOiBbRE9ORV0nIHx8IHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJzonKSkgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJpbW1lZExpbmUuc3RhcnRzV2l0aCgnZGF0YTogJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gdHJpbW1lZExpbmUuc2xpY2UoNik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkRGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnREZWx0YSA9IHBhcnNlZERhdGEuY2hvaWNlc1swXT8uZGVsdGE/LmNvbnRlbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50RGVsdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lzdGFudE1lc3NhZ2UuY29udGVudCArPSBjb250ZW50RGVsdGE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudEVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50RWxlbWVudC5pbm5lckhUTUwgPSBtYXJrZWQucGFyc2UoYXNzaXN0YW50TWVzc2FnZS5jb250ZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdwcmUgY29kZScpLmZvckVhY2goYmxvY2sgPT4geyB0cnkgeyBobGpzLmhpZ2hsaWdodEVsZW1lbnQoYmxvY2spOyB9IGNhdGNoIChlKSB7IH0gfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaXN0YW50TWVzc2FnZS5jb250ZW50Lmxlbmd0aCAlIDUgPT09IDApIGZvcmNlU2Nyb2xsVG9Cb3R0b20oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VkRGF0YS5jaG9pY2VzWzBdPy5maW5pc2hfcmVhc29uKSBhc3Npc3RhbnRNZXNzYWdlLmZpbmlzaF9yZWFzb24gPSBwYXJzZWREYXRhLmNob2ljZXNbMF0uZmluaXNoX3JlYXNvbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlZERhdGEudXNhZ2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lzdGFudE1lc3NhZ2UudXNhZ2UgPSBwYXJzZWREYXRhLnVzYWdlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlZERhdGEudXNhZ2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3Npc3RhbnRNZXNzYWdlLnVzYWdlID0gcGFyc2VkRGF0YS51c2FnZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBzdHJlYW0gZGF0YTonLCBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBmb3JjZVNjcm9sbFRvQm90dG9tKCk7DQogICAgICAgICAgICB9IGNhdGNoIChzdHJlYW1FcnJvcikgew0KICAgICAgICAgICAgICAgIGlmIChzdHJlYW1FcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIGNvbnNvbGUubG9nKCdTdHJlYW0gY2FuY2VsbGVkJyk7IGVsc2UgdGhyb3cgc3RyZWFtRXJyb3I7DQogICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgIGFwcFN0YXRlLmN1cnJlbnRseVN0cmVhbWluZyA9IGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5jZXJlYnJhcy5haS92MS9jaGF0L2NvbXBsZXRpb25zJywgew0KICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLA0KICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywNCiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhdXRoSGVhZGVyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0UGF5bG9hZCkNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7DQogICAgICAgICAgICAgICAgbGV0IGVycm9yRGF0YSA9IHt9Ow0KICAgICAgICAgICAgICAgIHRyeSB7IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsgfSBjYXRjaCAoZSkgeyB9DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yRGF0YS5lcnJvcj8ubWVzc2FnZSB8fCBgSFRUUCBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsNCiAgICAgICAgICAgIGNvbnN0IGFzc2lzdGFudE1lc3NhZ2UgPSB7DQogICAgICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsDQogICAgICAgICAgICAgICAgY29udGVudDogcmVzcG9uc2VEYXRhLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJycsDQogICAgICAgICAgICAgICAgbW9kZWw6IHJlc3BvbnNlRGF0YS5tb2RlbCB8fCBhcHBTdGF0ZS5zZWxlY3RlZE1vZGVsLA0KICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLA0KICAgICAgICAgICAgICAgIHByb2Nlc3NpbmdUaW1lOiAoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSkgLyAxMDAwLA0KICAgICAgICAgICAgICAgIHVzYWdlOiByZXNwb25zZURhdGEudXNhZ2UgfHwge30NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHdhaXRpbmdJbmRpY2F0b3IgJiYgd2FpdGluZ0luZGljYXRvci5wYXJlbnROb2RlICYmIHdhaXRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh3YWl0aW5nSW5kaWNhdG9yKTsNCiAgICAgICAgICAgIGFwcFN0YXRlLmNoYXRzW2FwcFN0YXRlLmN1cnJlbnRDaGF0SWRdLm1lc3NhZ2VzLnB1c2goYXNzaXN0YW50TWVzc2FnZSk7DQogICAgICAgICAgICByZW5kZXJNZXNzYWdlKGFzc2lzdGFudE1lc3NhZ2UpOw0KICAgICAgICAgICAgZm9yY2VTY3JvbGxUb0JvdHRvbSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgc2F2ZUFwcFN0YXRlKCk7DQoNCiAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpOw0KICAgICAgICB3YWl0aW5nSW5kaWNhdG9yICYmIHdhaXRpbmdJbmRpY2F0b3IucGFyZW50Tm9kZSAmJiB3YWl0aW5nSW5kaWNhdG9yLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQod2FpdGluZ0luZGljYXRvcik7DQoNCiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgIGVycm9yRWxlbWVudC5jbGFzc05hbWUgPSAnZXJyb3ItbWVzc2FnZSc7DQogICAgICAgIGVycm9yRWxlbWVudC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXgganVzdGlmeS1jb250ZW50LWJldHdlZW4gYWxpZ24taXRlbXMtc3RhcnQiPlxuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tY2lyY2xlIG1lLTIiPjwvaT5cbiAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5FcnJvcjo8L3N0cm9uZz4gJHtlcnJvci5tZXNzYWdlIHx8ICdTb21ldGhpbmcgd2VudCB3cm9uZyd9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tZGFuZ2VyIHJldHJ5LWJ0biI+XG4gICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcmVkby1hbHQgbWUtMSI+PC9pPiBSZXRyeVxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7DQogICAgICAgIGVsZW1lbnRzLmNoYXRNZXNzYWdlcyAmJiBlbGVtZW50cy5jaGF0TWVzc2FnZXMuYXBwZW5kQ2hpbGQoZXJyb3JFbGVtZW50KTsNCg0KICAgICAgICBjb25zdCByZXRyeUJ0biA9IGVycm9yRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucmV0cnktYnRuJyk7DQogICAgICAgIGlmIChyZXRyeUJ0bikgcmV0cnlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgICAgICBlcnJvckVsZW1lbnQucGFyZW50Tm9kZSAmJiBlcnJvckVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlcnJvckVsZW1lbnQpOw0KICAgICAgICAgICAgY29uc3QgbmV3V2FpdGluZ0luZGljYXRvciA9IGFkZFdhaXRpbmdJbmRpY2F0b3IoKTsNCiAgICAgICAgICAgIGNhbGxBcGkobmV3V2FpdGluZ0luZGljYXRvcik7DQogICAgICAgIH0pOw0KDQogICAgICAgIGZvcmNlU2Nyb2xsVG9Cb3R0b20oKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGhhbmRsZVByb21wdEtleWRvd24oZXZlbnQpIHsNCiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInICYmICFldmVudC5zaGlmdEtleSkgew0KICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBzZW5kTWVzc2FnZSgpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gZXhwb3J0Q2hhdCgpIHsNCiAgICBpZiAoIWFwcFN0YXRlLmN1cnJlbnRDaGF0SWQpIHJldHVybjsNCiAgICBjb25zdCBjdXJyZW50Q2hhdCA9IGFwcFN0YXRlLmNoYXRzW2FwcFN0YXRlLmN1cnJlbnRDaGF0SWRdOw0KICAgIGNvbnN0IGNoYXREYXRhID0gSlNPTi5zdHJpbmdpZnkoY3VycmVudENoYXQsIG51bGwsIDIpOw0KICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbY2hhdERhdGFdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyB9KTsNCiAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOw0KICAgIGNvbnN0IGRvd25sb2FkTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICBkb3dubG9hZExpbmsuaHJlZiA9IHVybDsNCiAgICBkb3dubG9hZExpbmsuZG93bmxvYWQgPSBgY2hhdF9leHBvcnRfJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvOi9nLCAnLScpfS5qc29uYDsNCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRvd25sb2FkTGluayk7DQogICAgZG93bmxvYWRMaW5rLmNsaWNrKCk7DQogICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkb3dubG9hZExpbmspOw0KICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsNCn0NCg0KZnVuY3Rpb24gaGFuZGxlSW1wb3J0Q2hhdChldmVudCkgew0KICAgIGNvbnN0IGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07DQogICAgaWYgKCFmaWxlKSByZXR1cm47DQogICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGltcG9ydGVkQ2hhdCA9IEpTT04ucGFyc2UoZS50YXJnZXQucmVzdWx0KTsNCiAgICAgICAgICAgIGlmICghaW1wb3J0ZWRDaGF0LmlkIHx8ICFpbXBvcnRlZENoYXQubWVzc2FnZXMgfHwgIUFycmF5LmlzQXJyYXkoaW1wb3J0ZWRDaGF0Lm1lc3NhZ2VzKSkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNoYXQgZm9ybWF0Jyk7DQogICAgICAgICAgICBjb25zdCBuZXdDaGF0SWQgPSAnY2hhdF8nICsgRGF0ZS5ub3coKTsNCiAgICAgICAgICAgIGltcG9ydGVkQ2hhdC5pZCA9IG5ld0NoYXRJZDsNCiAgICAgICAgICAgIGFwcFN0YXRlLmNoYXRzW25ld0NoYXRJZF0gPSBpbXBvcnRlZENoYXQ7DQogICAgICAgICAgICBzYXZlQXBwU3RhdGUoKTsNCiAgICAgICAgICAgIGxvYWRDaGF0KG5ld0NoYXRJZCk7DQogICAgICAgICAgICBjb25zdCBzeXN0ZW1NZXNzYWdlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICAgICAgc3lzdGVtTWVzc2FnZUVsZW1lbnQuY2xhc3NOYW1lID0gJ3N5c3RlbS1tZXNzYWdlJzsNCiAgICAgICAgICAgIHN5c3RlbU1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gJ0NoYXQgaW1wb3J0ZWQgc3VjY2Vzc2Z1bGx5JzsNCiAgICAgICAgICAgIGVsZW1lbnRzLmNoYXRNZXNzYWdlcyAmJiBlbGVtZW50cy5jaGF0TWVzc2FnZXMuYXBwZW5kQ2hpbGQoc3lzdGVtTWVzc2FnZUVsZW1lbnQpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW1wb3J0aW5nIGNoYXQ6JywgZXJyb3IpOw0KICAgICAgICAgICAgYWxlcnQoJ0Vycm9yIGltcG9ydGluZyBjaGF0OiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpOw0KfQ0KDQpmdW5jdGlvbiBkZWxldGVDdXJyZW50Q2hhdCgpIHsNCiAgICBpZiAoIWFwcFN0YXRlLmN1cnJlbnRDaGF0SWQgfHwgT2JqZWN0LmtleXMoYXBwU3RhdGUuY2hhdHMpLmxlbmd0aCA8PSAxKSB7IGNyZWF0ZU5ld0NoYXQoKTsgcmV0dXJuOyB9DQogICAgZGVsZXRlIGFwcFN0YXRlLmNoYXRzW2FwcFN0YXRlLmN1cnJlbnRDaGF0SWRdOw0KICAgIHNhdmVBcHBTdGF0ZSgpOw0KICAgIGNvbnN0IGNoYXRJZHMgPSBPYmplY3Qua2V5cyhhcHBTdGF0ZS5jaGF0cyk7DQogICAgaWYgKGNoYXRJZHMubGVuZ3RoID4gMCkgbG9hZENoYXQoY2hhdElkc1swXSk7IGVsc2UgY3JlYXRlTmV3Q2hhdCgpOw0KfQ0KDQpmdW5jdGlvbiBmb3JjZVNjcm9sbFRvQm90dG9tKCkgew0KICAgIGNvbnN0IGNoYXRNZXNzYWdlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0TWVzc2FnZXMnKTsNCiAgICBpZiAoIWNoYXRNZXNzYWdlcykgcmV0dXJuOw0KICAgIGNoYXRNZXNzYWdlcy5zY3JvbGxUb3AgPSBjaGF0TWVzc2FnZXMuc2Nyb2xsSGVpZ2h0Ow0KICAgIHNldFRpbWVvdXQoKCkgPT4geyBjaGF0TWVzc2FnZXMuc2Nyb2xsVG9wID0gY2hhdE1lc3NhZ2VzLnNjcm9sbEhlaWdodDsgfSwgNTApOw0KICAgIHNldFRpbWVvdXQoKCkgPT4geyBjaGF0TWVzc2FnZXMuc2Nyb2xsVG9wID0gY2hhdE1lc3NhZ2VzLnNjcm9sbEhlaWdodDsgfSwgMTUwKTsNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgY2hhdE1lc3NhZ2VzLnNjcm9sbFRvcCA9IGNoYXRNZXNzYWdlcy5zY3JvbGxIZWlnaHQ7DQogICAgICAgIGNvbnN0IGxhc3RNZXNzYWdlID0gY2hhdE1lc3NhZ2VzLmxhc3RFbGVtZW50Q2hpbGQ7DQogICAgICAgIGlmIChsYXN0TWVzc2FnZSkgbGFzdE1lc3NhZ2Uuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ2F1dG8nLCBibG9jazogJ2VuZCcgfSk7DQogICAgfSwgMzAwKTsNCn0NCg0KZnVuY3Rpb24gc2Nyb2xsVG9Cb3R0b20oKSB7DQogICAgY29uc3QgY2hhdE1lc3NhZ2VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXRNZXNzYWdlcycpOw0KICAgIGlmICghY2hhdE1lc3NhZ2VzKSByZXR1cm47DQogICAgY2hhdE1lc3NhZ2VzLnNjcm9sbFRvcCA9IGNoYXRNZXNzYWdlcy5zY3JvbGxIZWlnaHQ7DQp9DQoNCmZ1bmN0aW9uIGhhbmRsZUJlZm9yZVVubG9hZChlKSB7DQogICAgaWYgKE9iamVjdC5rZXlzKGFwcFN0YXRlLmNoYXRzKS5sZW5ndGggPiAwKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgdHJ5IHsgbGVhdmVQYWdlTW9kYWxJbnN0YW5jZT8uc2hvdygpOyB9IGNhdGNoIChlcnIpIHsgfQ0KICAgICAgICBlLnJldHVyblZhbHVlID0gJyc7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBwbGFjZUN1cnNvckF0RW5kKGVsZW1lbnQpIHsNCiAgICBpZiAoIWVsZW1lbnQpIHJldHVybjsNCiAgICBjb25zdCByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7DQogICAgY29uc3Qgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOw0KICAgIHJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyhlbGVtZW50KTsNCiAgICByYW5nZS5jb2xsYXBzZShmYWxzZSk7DQogICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpOw0KICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7DQogICAgZWxlbWVudC5mb2N1cygpOw0KfQ0KICAgIDwvc2NyaXB0Pg0KPC9ib2R5Pg0KDQoNCjwvaHRtbD4=';
        iframe.style.cssText = 'width:100%;height:100%;border:0;display:block;';
        iframe.setAttribute('title', 'Open AI Embed');
        // allow fullscreen & basic features
        iframe.setAttribute('allowfullscreen', '');
        iframe.setAttribute('loading', 'lazy');
        body.appendChild(iframe);
        panel.appendChild(body);
        document.body.appendChild(panel);
        if (typeof draggable === 'function') {
            draggable(panel, header);
        } else {
            (function simpleDrag() {
                let dragging = false, ox = 0, oy = 0;
                const move = e => {
                    const x = (e.clientX !== undefined) ? e.clientX : (e.touches && e.touches[0] && e.touches[0].clientX);
                    const y = (e.clientY !== undefined) ? e.clientY : (e.touches && e.touches[0] && e.touches[0].clientY);
                    if (!dragging || x == null) return;
                    panel.style.left = (x - ox) + 'px';
                    panel.style.top = (y - oy) + 'px';
                    panel.style.right = '';
                };
                const up = () => {
                    dragging = false;
                    document.removeEventListener('mousemove', move);
                    document.removeEventListener('mouseup', up);
                    document.removeEventListener('touchmove', move);
                    document.removeEventListener('touchend', up);
                    header.style.cursor = 'grab';
                };
                header.addEventListener('mousedown', e => {
                    dragging = true;
                    const r = panel.getBoundingClientRect();
                    ox = e.clientX - r.left;
                    oy = e.clientY - r.top;
                    document.addEventListener('mousemove', move);
                    document.addEventListener('mouseup', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
                header.addEventListener('touchstart', e => {
                    dragging = true;
                    const t = e.touches[0];
                    const r = panel.getBoundingClientRect();
                    ox = t.clientX - r.left;
                    oy = t.clientY - r.top;
                    document.addEventListener('touchmove', move);
                    document.addEventListener('touchend', up);
                    header.style.cursor = 'grabbing';
                    e.preventDefault();
                });
            })();
        }
        closeBtn.onclick = () => {
            panel.remove();
        };
        panel.addEventListener('mousedown', () => {
            panel.style.zIndex = 2147483648;
        });
    }
    function draggable(panel, handle) {
        let dragging = false, ox = 0, oy = 0;
        const move = e => {
            const x = (e.clientX !== undefined) ? e.clientX : (e.touches && e.touches[0] && e.touches[0].clientX);
            const y = (e.clientY !== undefined) ? e.clientY : (e.touches && e.touches[0] && e.touches[0].clientY);
            if (!dragging || x == null) return;
            panel.style.left = (x - ox) + 'px';
            panel.style.top = (y - oy) + 'px';
            panel.style.right = '';
        };
        const up = () => {
            dragging = false;
            document.removeEventListener('mousemove', move);
            document.removeEventListener('mouseup', up);
            document.removeEventListener('touchmove', move);
            document.removeEventListener('touchend', up);
            if (handle) handle.style.cursor = 'grab';
        };
        handle.addEventListener('mousedown', e => {
            dragging = true;
            const r = panel.getBoundingClientRect();
            ox = e.clientX - r.left;
            oy = e.clientY - r.top;
            document.addEventListener('mousemove', move);
            document.addEventListener('mouseup', up);
            handle.style.cursor = 'grabbing';
            e.preventDefault();
        });
        handle.addEventListener('touchstart', e => {
            dragging = true;
            const t = e.touches[0];
            const r = panel.getBoundingClientRect();
            ox = t.clientX - r.left;
            oy = t.clientY - r.top;
            document.addEventListener('touchmove', move);
            document.addEventListener('touchend', up);
            handle.style.cursor = 'grabbing';
            e.preventDefault();
        });
    }
})();
